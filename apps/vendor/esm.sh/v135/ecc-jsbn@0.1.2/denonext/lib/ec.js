/* esm.sh - esbuild bundle(ecc-jsbn@0.1.2/lib/ec) denonext production */
import * as __0$ from "/v135/jsbn@0.1.1/denonext/jsbn.mjs";
var require=n=>{const e=m=>typeof m.default<"u"?m.default:m,c=m=>Object.assign({},m);switch(n){case"jsbn":return e(__0$);default:throw new Error("module \""+n+"\" not found");}};
var O=Object.create;var d=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty;var H=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(i,e)=>(typeof require<"u"?require:i)[e]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var T=(t,i)=>()=>(i||t((i={exports:{}}).exports,i),i.exports),Q=(t,i)=>{for(var e in i)d(t,e,{get:i[e],enumerable:!0})},m=(t,i,e,r)=>{if(i&&typeof i=="object"||typeof i=="function")for(let n of C(i))!S.call(t,n)&&n!==e&&d(t,n,{get:()=>i[n],enumerable:!(r=M(i,n))||r.enumerable});return t},y=(t,i,e)=>(m(t,i,"default"),e&&m(e,i,"default")),E=(t,i,e)=>(e=t!=null?O(N(t)):{},m(i||!t||!t.__esModule?d(e,"default",{value:t,enumerable:!0}):e,t));var B=T((I,b)=>{var h=H("jsbn").BigInteger,Z=h.prototype.Barrett;function l(t,i){this.x=i,this.q=t}function G(t){return t==this?!0:this.q.equals(t.q)&&this.x.equals(t.x)}function _(){return this.x}function A(){return new l(this.q,this.x.negate().mod(this.q))}function P(t){return new l(this.q,this.x.add(t.toBigInteger()).mod(this.q))}function D(t){return new l(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))}function X(t){return new l(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))}function Y(){return new l(this.q,this.x.square().mod(this.q))}function V(t){return new l(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))}l.prototype.equals=G;l.prototype.toBigInteger=_;l.prototype.negate=A;l.prototype.add=P;l.prototype.subtract=D;l.prototype.multiply=X;l.prototype.square=Y;l.prototype.divide=V;function f(t,i,e,r){this.curve=t,this.x=i,this.y=e,r==null?this.z=h.ONE:this.z=r,this.zinv=null}function U(){this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q));var t=this.x.toBigInteger().multiply(this.zinv);return this.curve.reduce(t),this.curve.fromBigInteger(t)}function W(){this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q));var t=this.y.toBigInteger().multiply(this.zinv);return this.curve.reduce(t),this.curve.fromBigInteger(t)}function J(t){if(t==this)return!0;if(this.isInfinity())return t.isInfinity();if(t.isInfinity())return this.isInfinity();var i,e;return i=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),i.equals(h.ZERO)?(e=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q),e.equals(h.ZERO)):!1}function K(){return this.x==null&&this.y==null?!0:this.z.equals(h.ZERO)&&!this.y.toBigInteger().equals(h.ZERO)}function $(){return new f(this.curve,this.x,this.y.negate(),this.z)}function j(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var i=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),e=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);if(h.ZERO.equals(e))return h.ZERO.equals(i)?this.twice():this.curve.getInfinity();var r=new h("3"),n=this.x.toBigInteger(),o=this.y.toBigInteger(),s=t.x.toBigInteger(),a=t.y.toBigInteger(),u=e.square(),p=u.multiply(e),g=n.multiply(u),w=i.square().multiply(this.z),R=w.subtract(g.shiftLeft(1)).multiply(t.z).subtract(p).multiply(e).mod(this.curve.q),z=g.multiply(r).multiply(i).subtract(o.multiply(p)).subtract(w.multiply(i)).multiply(t.z).add(i.multiply(p)).mod(this.curve.q),L=p.multiply(this.z).multiply(t.z).mod(this.curve.q);return new f(this.curve,this.curve.fromBigInteger(R),this.curve.fromBigInteger(z),L)}function k(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var t=new h("3"),i=this.x.toBigInteger(),e=this.y.toBigInteger(),r=e.multiply(this.z),n=r.multiply(e).mod(this.curve.q),o=this.curve.a.toBigInteger(),s=i.square().multiply(t);h.ZERO.equals(o)||(s=s.add(this.z.square().multiply(o))),s=s.mod(this.curve.q);var a=s.square().subtract(i.shiftLeft(3).multiply(n)).shiftLeft(1).multiply(r).mod(this.curve.q),u=s.multiply(t).multiply(i).subtract(n.shiftLeft(1)).shiftLeft(2).multiply(n).subtract(s.square().multiply(s)).mod(this.curve.q),p=r.square().multiply(r).shiftLeft(3).mod(this.curve.q);return new f(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(u),p)}function tt(t){if(this.isInfinity())return this;if(t.signum()==0)return this.curve.getInfinity();var i=t,e=i.multiply(new h("3")),r=this.negate(),n=this,o;for(o=e.bitLength()-2;o>0;--o){n=n.twice();var s=e.testBit(o),a=i.testBit(o);s!=a&&(n=n.add(s?this:r))}return n}function it(t,i,e){var r;t.bitLength()>e.bitLength()?r=t.bitLength()-1:r=e.bitLength()-1;for(var n=this.curve.getInfinity(),o=this.add(i);r>=0;)n=n.twice(),t.testBit(r)?e.testBit(r)?n=n.add(o):n=n.add(this):e.testBit(r)&&(n=n.add(i)),--r;return n}f.prototype.getX=U;f.prototype.getY=W;f.prototype.equals=J;f.prototype.isInfinity=K;f.prototype.negate=$;f.prototype.add=j;f.prototype.twice=k;f.prototype.multiply=tt;f.prototype.multiplyTwo=it;function c(t,i,e){this.q=t,this.a=this.fromBigInteger(i),this.b=this.fromBigInteger(e),this.infinity=new f(this,null,null),this.reducer=new Z(this.q)}function et(){return this.q}function rt(){return this.a}function nt(){return this.b}function st(t){return t==this?!0:this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)}function ut(){return this.infinity}function ot(t){return new l(this.q,t)}function ht(t){this.reducer.reduce(t)}function lt(t){if(t.isInfinity())return"00";var i=t.getX().toBigInteger().toString(16),e=t.getY().toBigInteger().toString(16),r=this.getQ().toString(16).length;for(r%2!=0&&r++;i.length<r;)i="0"+i;for(;e.length<r;)e="0"+e;return"04"+i+e}c.prototype.getQ=et;c.prototype.getA=rt;c.prototype.getB=nt;c.prototype.equals=st;c.prototype.getInfinity=ut;c.prototype.fromBigInteger=ot;c.prototype.reduce=ht;c.prototype.encodePointHex=lt;c.prototype.decodePointHex=function(t){var i;switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:i=!1;case 3:i==null&&(i=!0);var s=t.length-2,a=t.substr(2,s),e=this.fromBigInteger(new h(a,16)),r=e.multiply(e.square().add(this.getA())).add(this.getB()),n=r.sqrt();if(n==null)throw"Invalid point compression";var o=n.toBigInteger();return o.testBit(0)!=i&&(n=this.fromBigInteger(this.getQ().subtract(o))),new f(this,e,n);case 4:case 6:case 7:var s=(t.length-2)/2,a=t.substr(2,s),u=t.substr(s+2,s);return new f(this,this.fromBigInteger(new h(a,16)),this.fromBigInteger(new h(u,16)));default:return null}};c.prototype.encodeCompressedPointHex=function(t){if(t.isInfinity())return"00";var i=t.getX().toBigInteger().toString(16),e=this.getQ().toString(16).length;for(e%2!=0&&e++;i.length<e;)i="0"+i;var r;return t.getY().toBigInteger().isEven()?r="02":r="03",r+i};l.prototype.getR=function(){if(this.r!=null)return this.r;this.r=null;var t=this.q.bitLength();if(t>128){var i=this.q.shiftRight(t-64);i.intValue()==-1&&(this.r=h.ONE.shiftLeft(t).subtract(this.q))}return this.r};l.prototype.modMult=function(t,i){return this.modReduce(t.multiply(i))};l.prototype.modReduce=function(t){if(this.getR()!=null){for(var i=q.bitLength();t.bitLength()>i+1;){var e=t.shiftRight(i),r=t.subtract(e.shiftLeft(i));this.getR().equals(h.ONE)||(e=e.multiply(this.getR())),t=e.add(r)}for(;t.compareTo(q)>=0;)t=t.subtract(q)}else t=t.mod(q);return t};l.prototype.sqrt=function(){if(!this.q.testBit(0))throw"unsupported";if(this.q.testBit(1)){var t=new l(this.q,this.x.modPow(this.q.shiftRight(2).add(h.ONE),this.q));return t.square().equals(this)?t:null}var i=this.q.subtract(h.ONE),e=i.shiftRight(1);if(!this.x.modPow(e,this.q).equals(h.ONE))return null;var r=i.shiftRight(2),n=r.shiftLeft(1).add(h.ONE),o=this.x,s=modDouble(modDouble(o)),a,u;do{var p;do p=new h(this.q.bitLength(),new SecureRandom);while(p.compareTo(this.q)>=0||!p.multiply(p).subtract(s).modPow(e,this.q).equals(i));var g=this.lucasSequence(p,o,n);if(a=g[0],u=g[1],this.modMult(u,u).equals(s))return u.testBit(0)&&(u=u.add(q)),u=u.shiftRight(1),new l(q,u)}while(a.equals(h.ONE)||a.equals(i));return null};l.prototype.lucasSequence=function(t,i,e){for(var r=e.bitLength(),n=e.getLowestSetBit(),o=h.ONE,s=h.TWO,a=t,u=h.ONE,p=h.ONE,g=r-1;g>=n+1;--g)u=this.modMult(u,p),e.testBit(g)?(p=this.modMult(u,i),o=this.modMult(o,a),s=this.modReduce(a.multiply(s).subtract(t.multiply(u))),a=this.modReduce(a.multiply(a).subtract(p.shiftLeft(1)))):(p=u,o=this.modReduce(o.multiply(s).subtract(u)),a=this.modReduce(a.multiply(s).subtract(t.multiply(u))),s=this.modReduce(s.multiply(s).subtract(u.shiftLeft(1))));u=this.modMult(u,p),p=this.modMult(u,i),o=this.modReduce(o.multiply(s).subtract(u)),s=this.modReduce(a.multiply(s).subtract(t.multiply(u))),u=this.modMult(u,p);for(var g=1;g<=n;++g)o=this.modMult(o,s),s=this.modReduce(s.multiply(s).subtract(u.shiftLeft(1))),u=this.modMult(u,u);return[o,s]};var I={ECCurveFp:c,ECPointFp:f,ECFieldElementFp:l};b.exports=I});var v={};Q(v,{ECCurveFp:()=>at,ECFieldElementFp:()=>ft,ECPointFp:()=>pt,default:()=>ct});var x=E(B());y(v,E(B()));var{ECCurveFp:at,ECPointFp:pt,ECFieldElementFp:ft}=x,{default:F,...gt}=x,ct=F!==void 0?F:gt;export{at as ECCurveFp,ft as ECFieldElementFp,pt as ECPointFp,ct as default};
//# sourceMappingURL=ec.js.map