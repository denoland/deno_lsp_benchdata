/* esm.sh - esbuild bundle(sshpk@1.18.0) denonext production */
import { Buffer as __Buffer$ } from "node:buffer";
import * as __0$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __1$ from "node:util";
import * as __2$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __3$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __4$ from "node:crypto";
import * as __5$ from "node:util";
import * as __6$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __7$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __8$ from "/v135/tweetnacl@0.14.5/denonext/tweetnacl.mjs";
import * as __9$ from "node:crypto";
import * as __a$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __b$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __c$ from "node:crypto";
import * as __d$ from "node:util";
import * as __e$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __f$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __10$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __11$ from "node:crypto";
import * as __12$ from "node:crypto";
import * as __13$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __14$ from "/v135/asn1@0.2.6/denonext/asn1.mjs";
import * as __15$ from "/v135/asn1@0.2.6/denonext/asn1.mjs";
import * as __16$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __17$ from "node:crypto";
import * as __18$ from "node:util";
import * as __19$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __1a$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __1b$ from "node:crypto";
import * as __1c$ from "/v135/asn1@0.2.6/denonext/asn1.mjs";
import * as __1d$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __1e$ from "/v135/ecc-jsbn@0.1.2/denonext/lib/ec.js";
import * as __1f$ from "/v135/jsbn@0.1.1/denonext/jsbn.mjs";
import * as __20$ from "/v135/tweetnacl@0.14.5/denonext/tweetnacl.mjs";
import * as __21$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __22$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __23$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __24$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __25$ from "/v135/asn1@0.2.6/denonext/asn1.mjs";
import * as __26$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __27$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __28$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __29$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __2a$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __2b$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __2c$ from "/v135/tweetnacl@0.14.5/denonext/tweetnacl.mjs";
import * as __2d$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __2e$ from "node:stream";
import * as __2f$ from "node:crypto";
import * as __30$ from "node:util";
import * as __31$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __32$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __33$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __34$ from "/v135/tweetnacl@0.14.5/denonext/tweetnacl.mjs";
import * as __35$ from "/v135/ecc-jsbn@0.1.2/denonext/ecc-jsbn.mjs";
import * as __36$ from "/v135/ecc-jsbn@0.1.2/denonext/lib/ec.js";
import * as __37$ from "/v135/jsbn@0.1.1/denonext/jsbn.mjs";
import * as __38$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __39$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __3a$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __3b$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __3c$ from "node:crypto";
import * as __3d$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __3e$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __3f$ from "/v135/asn1@0.2.6/denonext/asn1.mjs";
import * as __40$ from "/v135/asn1@0.2.6/denonext/asn1.mjs";
import * as __41$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __42$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __43$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __44$ from "node:crypto";
import * as __45$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __46$ from "node:crypto";
import * as __47$ from "/v135/bcrypt-pbkdf@1.0.2/denonext/bcrypt-pbkdf.mjs";
import * as __48$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __49$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __4a$ from "/v135/asn1@0.2.6/denonext/asn1.mjs";
import * as __4b$ from "/v135/asn1@0.2.6/denonext/asn1.mjs";
import * as __4c$ from "node:crypto";
import * as __4d$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __4e$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __4f$ from "/v135/assert-plus@1.0.0/denonext/assert-plus.mjs";
import * as __50$ from "/v135/asn1@0.2.6/denonext/asn1.mjs";
import * as __51$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
var require=n=>{const e=m=>typeof m.default<"u"?m.default:m,c=m=>Object.assign({},m);switch(n){case"assert-plus":return e(__0$);case"util":return e(__1$);case"safer-buffer":return e(__3$);case"crypto":return e(__4$);case"tweetnacl":return e(__8$);case"asn1":return e(__14$);case"ecc-jsbn/lib/ec":return e(__1e$);case"jsbn":return e(__1f$);case"stream":return e(__2e$);case"ecc-jsbn":return e(__35$);case"bcrypt-pbkdf":return e(__47$);default:throw new Error("module \""+n+"\" not found");}};
var Ti=Object.create;var Jr=Object.defineProperty;var Ui=Object.getOwnPropertyDescriptor;var Ni=Object.getOwnPropertyNames;var zi=Object.getPrototypeOf,Hi=Object.prototype.hasOwnProperty;var h=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(r,t)=>(typeof require<"u"?require:r)[t]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var P=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),ji=(e,r)=>{for(var t in r)Jr(e,t,{get:r[t],enumerable:!0})},$r=(e,r,t,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of Ni(r))!Hi.call(e,i)&&i!==t&&Jr(e,i,{get:()=>r[i],enumerable:!(a=Ui(r,i))||a.enumerable});return e},Me=(e,r,t)=>($r(e,r,"default"),t&&$r(t,r,"default")),Vt=(e,r,t)=>(t=e!=null?Ti(zi(e)):{},$r(r||!e||!e.__esModule?Jr(t,"default",{value:e,enumerable:!0}):t,e));var R=P((xo,Zt)=>{var L=h("safer-buffer").Buffer,et={dsa:{parts:["p","q","g","y"],sizePart:"p"},rsa:{parts:["e","n"],sizePart:"n"},ecdsa:{parts:["curve","Q"],sizePart:"Q"},ed25519:{parts:["A"],sizePart:"A"}};et.curve25519=et.ed25519;var rt={dsa:{parts:["p","q","g","y","x"]},rsa:{parts:["n","e","d","iqmp","p","q"]},ecdsa:{parts:["curve","Q","d"]},ed25519:{parts:["A","k"]}};rt.curve25519=rt.ed25519;var Li={md5:!0,sha1:!0,sha256:!0,sha384:!0,sha512:!0},Ri={nistp256:{size:256,pkcs8oid:"1.2.840.10045.3.1.7",p:L.from("00ffffffff 00000001 00000000 0000000000000000 ffffffff ffffffff ffffffff".replace(/ /g,""),"hex"),a:L.from("00FFFFFFFF 00000001 00000000 0000000000000000 FFFFFFFF FFFFFFFF FFFFFFFC".replace(/ /g,""),"hex"),b:L.from("5ac635d8 aa3a93e7 b3ebbd55 769886bc651d06b0 cc53b0f6 3bce3c3e 27d2604b".replace(/ /g,""),"hex"),s:L.from("00c49d3608 86e70493 6a6678e1 139d26b7819f7e90".replace(/ /g,""),"hex"),n:L.from("00ffffffff 00000000 ffffffff ffffffffbce6faad a7179e84 f3b9cac2 fc632551".replace(/ /g,""),"hex"),G:L.from("046b17d1f2 e12c4247 f8bce6e5 63a440f277037d81 2deb33a0 f4a13945 d898c2964fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e162bce3357 6b315ece cbb64068 37bf51f5".replace(/ /g,""),"hex")},nistp384:{size:384,pkcs8oid:"1.3.132.0.34",p:L.from("00ffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff fffffffeffffffff 00000000 00000000 ffffffff".replace(/ /g,""),"hex"),a:L.from("00FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFEFFFFFFFF 00000000 00000000 FFFFFFFC".replace(/ /g,""),"hex"),b:L.from("b3312fa7 e23ee7e4 988e056b e3f82d19181d9c6e fe814112 0314088f 5013875ac656398d 8a2ed19d 2a85c8ed d3ec2aef".replace(/ /g,""),"hex"),s:L.from("00a335926a a319a27a 1d00896a 6773a4827acdac73".replace(/ /g,""),"hex"),n:L.from("00ffffffff ffffffff ffffffff ffffffffffffffff ffffffff c7634d81 f4372ddf581a0db2 48b0a77a ecec196a ccc52973".replace(/ /g,""),"hex"),G:L.from("04aa87ca22 be8b0537 8eb1c71e f320ad746e1d3b62 8ba79b98 59f741e0 82542a385502f25d bf55296c 3a545e38 72760ab73617de4a 96262c6f 5d9e98bf 9292dc29f8f41dbd 289a147c e9da3113 b5f0b8c00a60b1ce 1d7e819d 7a431d7c 90ea0e5f".replace(/ /g,""),"hex")},nistp521:{size:521,pkcs8oid:"1.3.132.0.35",p:L.from("01ffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffff".replace(/ /g,""),"hex"),a:L.from("01FFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFC".replace(/ /g,""),"hex"),b:L.from("51953eb961 8e1c9a1f 929a21a0 b68540eea2da725b 99b315f3 b8b48991 8ef109e156193951 ec7e937b 1652c0bd 3bb1bf073573df88 3d2c34f1 ef451fd4 6b503f00".replace(/ /g,""),"hex"),s:L.from("00d09e8800 291cb853 96cc6717 393284aaa0da64ba".replace(/ /g,""),"hex"),n:L.from("01ffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff fffffffa51868783 bf2f966b 7fcc0148 f709a5d03bb5c9b8 899c47ae bb6fb71e 91386409".replace(/ /g,""),"hex"),G:L.from("0400c6 858e06b7 0404e9cd 9e3ecb66 2395b4429c648139 053fb521 f828af60 6b4d3dbaa14b5e77 efe75928 fe1dc127 a2ffa8de3348b3c1 856a429b f97e7e31 c2e5bd660118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd998f54449 579b4468 17afbd17 273e662c97ee7299 5ef42640 c550b901 3fad0761353c7086 a272c240 88be9476 9fd16650".replace(/ /g,""),"hex")}};Zt.exports={info:et,privInfo:rt,hashAlgs:Li,curves:Ri}});var he=P((Ko,Wt)=>{var Do=h("assert-plus"),Je=h("util");function tt(e,r){Error.captureStackTrace&&Error.captureStackTrace(this,tt),this.name="FingerprintFormatError",this.fingerprint=e,this.format=r,this.message="Fingerprint format is not supported, or is invalid: ",e!==void 0&&(this.message+=" fingerprint = "+e),r!==void 0&&(this.message+=" format = "+r)}Je.inherits(tt,Error);function at(e){Error.captureStackTrace&&Error.captureStackTrace(this,at),this.name="InvalidAlgorithmError",this.algorithm=e,this.message='Algorithm "'+e+'" is not supported'}Je.inherits(at,Error);function it(e,r,t){Error.captureStackTrace&&Error.captureStackTrace(this,it),this.name="KeyParseError",this.format=r,this.keyName=e,this.innerErr=t,this.message="Failed to parse "+e+" as a valid "+r+" format key: "+t.message}Je.inherits(it,Error);function nt(e,r,t){Error.captureStackTrace&&Error.captureStackTrace(this,nt),this.name="SignatureParseError",this.type=e,this.format=r,this.innerErr=t,this.message="Failed to parse the given data as a "+e+" signature in "+r+" format: "+t.message}Je.inherits(nt,Error);function st(e,r,t){Error.captureStackTrace&&Error.captureStackTrace(this,st),this.name="CertificateParseError",this.format=r,this.certName=e,this.innerErr=t,this.message="Failed to parse "+e+" as a valid "+r+" format certificate: "+t.message}Je.inherits(st,Error);function ft(e,r){Error.captureStackTrace&&Error.captureStackTrace(this,ft),this.name="KeyEncryptedError",this.format=r,this.keyName=e,this.message="The "+r+" format key "+e+" is encrypted (password-protected), and no passphrase was provided in `options`"}Je.inherits(ft,Error);Wt.exports={FingerprintFormatError:tt,InvalidAlgorithmError:at,KeyParseError:it,SignatureParseError:nt,KeyEncryptedError:ft,CertificateParseError:st}});var N=P((Oo,ra)=>{ra.exports={bufferSplit:en,addRSAMissing:cn,calculateDSAPublic:fn,calculateED25519Public:on,calculateX25519Public:un,mpNormalize:ct,mpDenormalize:nn,ecNormalize:rn,countZeros:Ji,assertCompatible:ea,isCompatible:Vi,opensslKeyDeriv:Xi,opensshCipherInfo:pn,publicFromPrivateECDSA:hn,zeroPadToLength:sn,writeBitString:an,readBitString:tn,pbkdf2:$i};var E=h("assert-plus"),J=h("safer-buffer").Buffer,Mi=z(),Qi=H(),ot=h("crypto"),Yi=R(),Xt=h("asn1"),Gi=h("ecc-jsbn/lib/ec"),qe=h("jsbn").BigInteger,$t=h("tweetnacl"),Jt=3;function Vi(e,r,t){if(e===null||typeof e!="object")return!1;if(t===void 0&&(t=r.prototype._sshpkApiVersion),e instanceof r&&r.prototype._sshpkApiVersion[0]==t[0])return!0;for(var a=Object.getPrototypeOf(e),i=0;a.constructor.name!==r.name;)if(a=Object.getPrototypeOf(a),!a||++i>Jt)return!1;if(a.constructor.name!==r.name)return!1;var n=a._sshpkApiVersion;return n===void 0&&(n=r._oldVersionDetect(e)),!(n[0]!=t[0]||n[1]<t[1])}function ea(e,r,t,a){if(a===void 0&&(a="object"),E.ok(e,a+" must not be null"),E.object(e,a+" must be an object"),t===void 0&&(t=r.prototype._sshpkApiVersion),!(e instanceof r&&r.prototype._sshpkApiVersion[0]==t[0])){for(var i=Object.getPrototypeOf(e),n=0;i.constructor.name!==r.name;)i=Object.getPrototypeOf(i),E.ok(i&&++n<=Jt,a+" must be a "+r.name+" instance");E.strictEqual(i.constructor.name,r.name,a+" must be a "+r.name+" instance");var s=i._sshpkApiVersion;s===void 0&&(s=r._oldVersionDetect(e)),E.ok(s[0]==t[0]&&s[1]>=t[1],a+" must be compatible with "+r.name+" klass version "+t[0]+"."+t[1])}}var Zi={"des-ede3-cbc":{key:24,iv:8},"aes-128-cbc":{key:16,iv:16},"aes-256-cbc":{key:32,iv:16}},Wi=8;function Xi(e,r,t,a){E.buffer(r,"salt"),E.buffer(t,"passphrase"),E.number(a,"iteration count");var i=Zi[e];E.object(i,"supported cipher"),r=r.slice(0,Wi);for(var n,s,f,o=J.alloc(0);o.length<i.key+i.iv;){f=[],s&&f.push(s),f.push(t),f.push(r),n=J.concat(f);for(var u=0;u<a;++u)n=ot.createHash("md5").update(n).digest();o=J.concat([o,n]),s=n}return{key:o.slice(0,i.key),iv:o.slice(i.key,i.key+i.iv)}}function $i(e,r,t,a,i){var n=J.alloc(r.length+4);r.copy(n);for(var s=0,f=[],o=1;s<a;){var u=c(o++);s+=u.length,f.push(u)}return J.concat(f).slice(0,a);function c(l){n.writeUInt32BE(l,n.length-4);var g=ot.createHmac(e,i);g.update(n);for(var d=g.digest(),v=d,q=1;q++<t;){g=ot.createHmac(e,i),g.update(v),v=g.digest();for(var m=0;m<d.length;++m)d[m]^=v[m]}return d}}function Ji(e){for(var r=0,t=8;r<e.length;){var a=1<<t;if((e[r]&a)===a)break;t--,t<0&&(r++,t=8)}return r*8+(8-t)-1}function en(e,r){E.buffer(e),E.string(r);for(var t=[],a=0,i=0,n=0;n<e.length;++n)if(e[n]===r.charCodeAt(i)?++i:e[n]===r.charCodeAt(0)?i=1:i=0,i>=r.length){var s=n+1;t.push(e.slice(a,s-i)),a=s,i=0}return a<=e.length&&t.push(e.slice(a,e.length)),t}function rn(e,r){if(E.buffer(e),e[0]===0&&e[1]===4)return r?e:e.slice(1);if(e[0]===4){if(!r)return e}else{for(;e[0]===0;)e=e.slice(1);if(e[0]===2||e[0]===3)throw new Error("Compressed elliptic curve points are not supported");if(e[0]!==4)throw new Error("Not a valid elliptic curve point");if(!r)return e}var t=J.alloc(e.length+1);return t[0]=0,e.copy(t,1),t}function tn(e,r){r===void 0&&(r=Xt.Ber.BitString);var t=e.readString(r,!0);return E.strictEqual(t[0],0,"bit strings with unused bits are not supported (0x"+t[0].toString(16)+")"),t.slice(1)}function an(e,r,t){t===void 0&&(t=Xt.Ber.BitString);var a=J.alloc(r.length+1);a[0]=0,r.copy(a,1),e.writeBuffer(a,t)}function ct(e){for(E.buffer(e);e.length>1&&e[0]===0&&!(e[1]&128);)e=e.slice(1);if((e[0]&128)===128){var r=J.alloc(e.length+1);r[0]=0,e.copy(r,1),e=r}return e}function nn(e){for(E.buffer(e);e.length>1&&e[0]===0;)e=e.slice(1);return e}function sn(e,r){for(E.buffer(e),E.number(r);e.length>r;)E.equal(e[0],0),e=e.slice(1);for(;e.length<r;){var t=J.alloc(e.length+1);t[0]=0,e.copy(t,1),e=t}return e}function ut(e){var r=J.from(e.toByteArray());return r=ct(r),r}function fn(e,r,t){E.buffer(e),E.buffer(r),E.buffer(t),e=new qe(e),r=new qe(r),t=new qe(t);var a=e.modPow(t,r),i=ut(a);return i}function on(e){E.buffer(e);var r=$t.sign.keyPair.fromSeed(new Uint8Array(e));return J.from(r.publicKey)}function un(e){E.buffer(e);var r=$t.box.keyPair.fromSeed(new Uint8Array(e));return J.from(r.publicKey)}function cn(e){E.object(e),ea(e,Mi,[1,1]);var r=new qe(e.part.d.data),t;if(!e.part.dmodp){var a=new qe(e.part.p.data),i=r.mod(a.subtract(1));t=ut(i),e.part.dmodp={name:"dmodp",data:t},e.parts.push(e.part.dmodp)}if(!e.part.dmodq){var n=new qe(e.part.q.data),s=r.mod(n.subtract(1));t=ut(s),e.part.dmodq={name:"dmodq",data:t},e.parts.push(e.part.dmodq)}}function hn(e,r){E.string(e,"curveName"),E.buffer(r);var t=Yi.curves[e],a=new qe(t.p),i=new qe(t.a),n=new qe(t.b),s=new Gi.ECCurveFp(a,i,n),f=s.decodePointHex(t.G.toString("hex")),o=new qe(ct(r)),u=f.multiply(o);u=J.from(s.encodePointHex(u),"hex");var c=[];c.push({name:"curve",data:J.from(e)}),c.push({name:"Q",data:u});var l=new Qi({type:"ecdsa",curve:s,parts:c});return l}function pn(e){var r={};switch(e){case"3des-cbc":r.keySize=24,r.blockSize=8,r.opensslName="des-ede3-cbc";break;case"blowfish-cbc":r.keySize=16,r.blockSize=8,r.opensslName="bf-cbc";break;case"aes128-cbc":case"aes128-ctr":case"aes128-gcm@openssh.com":r.keySize=16,r.blockSize=16,r.opensslName="aes-128-"+e.slice(7,10);break;case"aes192-cbc":case"aes192-ctr":case"aes192-gcm@openssh.com":r.keySize=24,r.blockSize=16,r.opensslName="aes-192-"+e.slice(7,10);break;case"aes256-cbc":case"aes256-ctr":case"aes256-gcm@openssh.com":r.keySize=32,r.blockSize=16,r.opensslName="aes-256-"+e.slice(7,10);break;default:throw new Error('Unsupported openssl cipher "'+e+'"')}return r}});var Ye=P((To,ta)=>{ta.exports=x;var Qe=h("assert-plus"),ht=h("safer-buffer").Buffer;function x(e){Qe.object(e,"options"),e.buffer!==void 0&&Qe.buffer(e.buffer,"options.buffer"),this._size=e.buffer?e.buffer.length:1024,this._buffer=e.buffer||ht.alloc(this._size),this._offset=0}x.prototype.toBuffer=function(){return this._buffer.slice(0,this._offset)};x.prototype.atEnd=function(){return this._offset>=this._buffer.length};x.prototype.remainder=function(){return this._buffer.slice(this._offset)};x.prototype.skip=function(e){this._offset+=e};x.prototype.expand=function(){this._size*=2;var e=ht.alloc(this._size);this._buffer.copy(e,0),this._buffer=e};x.prototype.readPart=function(){return{data:this.readBuffer()}};x.prototype.readBuffer=function(){var e=this._buffer.readUInt32BE(this._offset);this._offset+=4,Qe.ok(this._offset+e<=this._buffer.length,"length out of bounds at +0x"+this._offset.toString(16)+" (data truncated?)");var r=this._buffer.slice(this._offset,this._offset+e);return this._offset+=e,r};x.prototype.readString=function(){return this.readBuffer().toString()};x.prototype.readCString=function(){for(var e=this._offset;e<this._buffer.length&&this._buffer[e]!==0;)e++;Qe.ok(e<this._buffer.length,"c string does not terminate");var r=this._buffer.slice(this._offset,e).toString();return this._offset=e+1,r};x.prototype.readInt=function(){var e=this._buffer.readUInt32BE(this._offset);return this._offset+=4,e};x.prototype.readInt64=function(){Qe.ok(this._offset+8<this._buffer.length,"buffer not long enough to read Int64");var e=this._buffer.slice(this._offset,this._offset+8);return this._offset+=8,e};x.prototype.readChar=function(){var e=this._buffer[this._offset++];return e};x.prototype.writeBuffer=function(e){for(;this._offset+4+e.length>this._size;)this.expand();this._buffer.writeUInt32BE(e.length,this._offset),this._offset+=4,e.copy(this._buffer,this._offset),this._offset+=e.length};x.prototype.writeString=function(e){this.writeBuffer(ht.from(e,"utf8"))};x.prototype.writeCString=function(e){for(;this._offset+1+e.length>this._size;)this.expand();this._buffer.write(e,this._offset),this._offset+=e.length,this._buffer[this._offset++]=0};x.prototype.writeInt=function(e){for(;this._offset+4>this._size;)this.expand();this._buffer.writeUInt32BE(e,this._offset),this._offset+=4};x.prototype.writeInt64=function(e){if(Qe.buffer(e,"value"),e.length>8){for(var r=e.slice(0,e.length-8),t=0;t<r.length;++t)Qe.strictEqual(r[t],0,"must fit in 64 bits of precision");e=e.slice(e.length-8,e.length)}for(;this._offset+8>this._size;)this.expand();e.copy(this._buffer,this._offset),this._offset+=8};x.prototype.writeChar=function(e){for(;this._offset+1>this._size;)this.expand();this._buffer[this._offset++]=e};x.prototype.writePart=function(e){this.writeBuffer(e.data)};x.prototype.write=function(e){for(;this._offset+e.length>this._size;)this.expand();e.copy(this._buffer,this._offset),this._offset+=e.length}});var Be=P((zo,fa)=>{fa.exports=te;var D=h("assert-plus"),na=h("safer-buffer").Buffer,Uo=R(),No=h("crypto"),sa=he(),mr=N(),er=h("asn1"),Ie=Ye(),aa=sa.InvalidAlgorithmError,ln=sa.SignatureParseError;function te(e){D.object(e,"options"),D.arrayOfObject(e.parts,"options.parts"),D.string(e.type,"options.type");for(var r={},t=0;t<e.parts.length;++t){var a=e.parts[t];r[a.name]=a}this.type=e.type,this.hashAlgorithm=e.hashAlgo,this.curve=e.curve,this.parts=e.parts,this.part=r}te.prototype.toBuffer=function(e){e===void 0&&(e="asn1"),D.string(e,"format");var r,t="ssh-"+this.type;switch(this.type){case"rsa":switch(this.hashAlgorithm){case"sha256":t="rsa-sha2-256";break;case"sha512":t="rsa-sha2-512";break;case"sha1":case void 0:break;default:throw new Error("SSH signature format does not support hash algorithm "+this.hashAlgorithm)}return e==="ssh"?(r=new Ie({}),r.writeString(t),r.writePart(this.part.sig),r.toBuffer()):this.part.sig.data;case"ed25519":return e==="ssh"?(r=new Ie({}),r.writeString(t),r.writePart(this.part.sig),r.toBuffer()):this.part.sig.data;case"dsa":case"ecdsa":var a,i;if(e==="asn1"){var n=new er.BerWriter;return n.startSequence(),a=mr.mpNormalize(this.part.r.data),i=mr.mpNormalize(this.part.s.data),n.writeBuffer(a,er.Ber.Integer),n.writeBuffer(i,er.Ber.Integer),n.endSequence(),n.buffer}else if(e==="ssh"&&this.type==="dsa"){if(r=new Ie({}),r.writeString("ssh-dss"),a=this.part.r.data,a.length>20&&a[0]===0&&(a=a.slice(1)),i=this.part.s.data,i.length>20&&i[0]===0&&(i=i.slice(1)),this.hashAlgorithm&&this.hashAlgorithm!=="sha1"||a.length+i.length!==40)throw new Error("OpenSSH only supports DSA signatures with SHA1 hash");return r.writeBuffer(na.concat([a,i])),r.toBuffer()}else if(e==="ssh"&&this.type==="ecdsa"){var s=new Ie({});a=this.part.r.data,s.writeBuffer(a),s.writePart(this.part.s),r=new Ie({});var f;a[0]===0&&(a=a.slice(1));var o=a.length*8;return o===256?f="nistp256":o===384?f="nistp384":o===528&&(f="nistp521"),r.writeString("ecdsa-sha2-"+f),r.writeBuffer(s.toBuffer()),r.toBuffer()}throw new Error("Invalid signature format");default:throw new Error("Invalid signature data")}};te.prototype.toString=function(e){return D.optionalString(e,"format"),this.toBuffer(e).toString("base64")};te.parse=function(e,r,t){typeof e=="string"&&(e=na.from(e,"base64")),D.buffer(e,"data"),D.string(t,"format"),D.string(r,"type");var a={};a.type=r.toLowerCase(),a.parts=[];try{switch(D.ok(e.length>0,"signature must not be empty"),a.type){case"rsa":return ia(e,r,t,a);case"ed25519":return ia(e,r,t,a);case"dsa":case"ecdsa":return t==="asn1"?vn(e,r,t,a):a.type==="dsa"?dn(e,r,t,a):gn(e,r,t,a);default:throw new aa(r)}}catch(i){throw i instanceof aa?i:new ln(r,t,i)}};function ia(e,r,t,a){if(t==="ssh"){try{var i=new Ie({buffer:e}),n=i.readString()}catch{}if(i!==void 0){var s="SSH signature does not match expected type (expected "+r+", got "+n+")";switch(n){case"ssh-rsa":D.strictEqual(r,"rsa",s),a.hashAlgo="sha1";break;case"rsa-sha2-256":D.strictEqual(r,"rsa",s),a.hashAlgo="sha256";break;case"rsa-sha2-512":D.strictEqual(r,"rsa",s),a.hashAlgo="sha512";break;case"ssh-ed25519":D.strictEqual(r,"ed25519",s),a.hashAlgo="sha512";break;default:throw new Error("Unknown SSH signature type: "+n)}var f=i.readPart();return D.ok(i.atEnd(),"extra trailing bytes"),f.name="sig",a.parts.push(f),new te(a)}}return a.parts.push({name:"sig",data:e}),new te(a)}function vn(e,r,t,a){var i=new er.BerReader(e);i.readSequence();var n=i.readString(er.Ber.Integer,!0),s=i.readString(er.Ber.Integer,!0);return a.parts.push({name:"r",data:mr.mpNormalize(n)}),a.parts.push({name:"s",data:mr.mpNormalize(s)}),new te(a)}function dn(e,r,t,a){if(e.length!=40){var i=new Ie({buffer:e}),n=i.readBuffer();n.toString("ascii")==="ssh-dss"&&(n=i.readBuffer()),D.ok(i.atEnd(),"extra trailing bytes"),D.strictEqual(n.length,40,"invalid inner length"),e=n}return a.parts.push({name:"r",data:e.slice(0,20)}),a.parts.push({name:"s",data:e.slice(20,40)}),new te(a)}function gn(e,r,t,a){var i=new Ie({buffer:e}),n,s,f=i.readBuffer(),o=f.toString("ascii");if(o.slice(0,6)==="ecdsa-"){var u=o.split("-");switch(D.strictEqual(u[0],"ecdsa"),D.strictEqual(u[1],"sha2"),a.curve=u[2],a.curve){case"nistp256":a.hashAlgo="sha256";break;case"nistp384":a.hashAlgo="sha384";break;case"nistp521":a.hashAlgo="sha512";break;default:throw new Error("Unsupported ECDSA curve: "+a.curve)}f=i.readBuffer(),D.ok(i.atEnd(),"extra trailing bytes on outer"),i=new Ie({buffer:f}),n=i.readPart()}else n={data:f};return s=i.readPart(),D.ok(i.atEnd(),"extra trailing bytes"),n.name="r",s.name="s",a.parts.push(n),a.parts.push(s),new te(a)}te.isSignature=function(e,r){return mr.isCompatible(e,te,r)};te.prototype._sshpkApiVersion=[2,1];te._oldVersionDetect=function(e){return D.func(e.toBuffer),e.hasOwnProperty("hashAlgorithm")?[2,0]:[1,0]}});var Dr=P((jo,ca)=>{ca.exports={DiffieHellman:ee,generateECDSA:Sn,generateED25519:yn};var pe=h("assert-plus"),rr=h("crypto"),$=h("safer-buffer").Buffer,mn=R(),wr=N(),pt=h("tweetnacl"),oa=H(),be=z(),Ge=rr.createECDH!==void 0,Ho=h("ecc-jsbn"),wn=h("ecc-jsbn/lib/ec"),se=h("jsbn").BigInteger;function ee(e){if(wr.assertCompatible(e,oa,[1,4],"key"),this._isPriv=be.isPrivateKey(e,[1,3]),this._algo=e.type,this._curve=e.curve,this._key=e,e.type==="dsa"){if(!Ge)throw new Error("Due to bugs in the node 0.10 crypto API, node 0.12.x or later is required to use DH");this._dh=rr.createDiffieHellman(e.part.p.data,void 0,e.part.g.data,void 0),this._p=e.part.p,this._g=e.part.g,this._isPriv&&this._dh.setPrivateKey(e.part.x.data),this._dh.setPublicKey(e.part.y.data)}else if(e.type==="ecdsa"){if(!Ge){this._ecParams=new tr(this._curve),this._isPriv&&(this._priv=new xr(this._ecParams,e.part.d.data));return}var r={nistp256:"prime256v1",nistp384:"secp384r1",nistp521:"secp521r1"}[e.curve];if(this._dh=rr.createECDH(r),typeof this._dh!="object"||typeof this._dh.setPrivateKey!="function"){Ge=!1,ee.call(this,e);return}this._isPriv&&this._dh.setPrivateKey(e.part.d.data),this._dh.setPublicKey(e.part.Q.data)}else if(e.type==="curve25519")this._isPriv&&(wr.assertCompatible(e,be,[1,5],"key"),this._priv=e.part.k.data);else throw new Error("DH not supported for "+e.type+" keys")}ee.prototype.getPublicKey=function(){return this._isPriv?this._key.toPublic():this._key};ee.prototype.getPrivateKey=function(){if(this._isPriv)return this._key};ee.prototype.getKey=ee.prototype.getPrivateKey;ee.prototype._keyCheck=function(e,r){if(pe.object(e,"key"),r||wr.assertCompatible(e,be,[1,3],"key"),wr.assertCompatible(e,oa,[1,4],"key"),e.type!==this._algo)throw new Error("A "+e.type+" key cannot be used in "+this._algo+" Diffie-Hellman");if(e.curve!==this._curve)throw new Error("A key from the "+e.curve+" curve cannot be used with a "+this._curve+" Diffie-Hellman");e.type==="dsa"&&(pe.deepEqual(e.part.p,this._p,"DSA key prime does not match"),pe.deepEqual(e.part.g,this._g,"DSA key generator does not match"))};ee.prototype.setKey=function(e){if(this._keyCheck(e),e.type==="dsa")this._dh.setPrivateKey(e.part.x.data),this._dh.setPublicKey(e.part.y.data);else if(e.type==="ecdsa")Ge?(this._dh.setPrivateKey(e.part.d.data),this._dh.setPublicKey(e.part.Q.data)):this._priv=new xr(this._ecParams,e.part.d.data);else if(e.type==="curve25519"){var r=e.part.k;e.part.k||(r=e.part.r),this._priv=r.data,this._priv[0]===0&&(this._priv=this._priv.slice(1)),this._priv=this._priv.slice(0,32)}this._key=e,this._isPriv=!0};ee.prototype.setPrivateKey=ee.prototype.setKey;ee.prototype.computeSecret=function(e){if(this._keyCheck(e,!0),!this._isPriv)throw new Error("DH exchange has not been initialized with a private key yet");var r;if(this._algo==="dsa")return this._dh.computeSecret(e.part.y.data);if(this._algo==="ecdsa")return Ge?this._dh.computeSecret(e.part.Q.data):(r=new ua(this._ecParams,e.part.Q.data),this._priv.deriveSharedSecret(r));if(this._algo==="curve25519"){for(r=e.part.A.data;r[0]===0&&r.length>32;)r=r.slice(1);var t=this._priv;pe.strictEqual(r.length,32),pe.strictEqual(t.length,32);var a=pt.box.before(new Uint8Array(r),new Uint8Array(t));return $.from(a)}throw new Error("Invalid algorithm: "+this._algo)};ee.prototype.generateKey=function(){var e=[],r,t;if(this._algo==="dsa")return this._dh.generateKeys(),e.push({name:"p",data:this._p.data}),e.push({name:"q",data:this._key.part.q.data}),e.push({name:"g",data:this._g.data}),e.push({name:"y",data:this._dh.getPublicKey()}),e.push({name:"x",data:this._dh.getPrivateKey()}),this._key=new be({type:"dsa",parts:e}),this._isPriv=!0,this._key;if(this._algo==="ecdsa"){if(Ge)return this._dh.generateKeys(),e.push({name:"curve",data:$.from(this._curve)}),e.push({name:"Q",data:this._dh.getPublicKey()}),e.push({name:"d",data:this._dh.getPrivateKey()}),this._key=new be({type:"ecdsa",curve:this._curve,parts:e}),this._isPriv=!0,this._key;var a=this._ecParams.getN(),i=new se(rr.randomBytes(a.bitLength())),n=a.subtract(se.ONE);return r=i.mod(n).add(se.ONE),t=this._ecParams.getG().multiply(r),r=$.from(r.toByteArray()),t=$.from(this._ecParams.getCurve().encodePointHex(t),"hex"),this._priv=new xr(this._ecParams,r),e.push({name:"curve",data:$.from(this._curve)}),e.push({name:"Q",data:t}),e.push({name:"d",data:r}),this._key=new be({type:"ecdsa",curve:this._curve,parts:e}),this._isPriv=!0,this._key}else if(this._algo==="curve25519"){var s=pt.box.keyPair();return r=$.from(s.secretKey),t=$.from(s.publicKey),r=$.concat([r,t]),pe.strictEqual(r.length,64),pe.strictEqual(t.length,32),e.push({name:"A",data:t}),e.push({name:"k",data:r}),this._key=new be({type:"curve25519",parts:e}),this._isPriv=!0,this._key}throw new Error("Invalid algorithm: "+this._algo)};ee.prototype.generateKeys=ee.prototype.generateKey;function tr(e){var r=mn.curves[e];pe.object(r);var t=new se(r.p),a=new se(r.a),i=new se(r.b),n=new se(r.n),s=se.ONE,f=new wn.ECCurveFp(t,a,i),o=f.decodePointHex(r.G.toString("hex"));this.curve=f,this.g=o,this.n=n,this.h=s}tr.prototype.getCurve=function(){return this.curve};tr.prototype.getG=function(){return this.g};tr.prototype.getN=function(){return this.n};tr.prototype.getH=function(){return this.h};function ua(e,r){this._params=e,r[0]===0&&(r=r.slice(1)),this._pub=e.getCurve().decodePointHex(r.toString("hex"))}function xr(e,r){this._params=e,this._priv=new se(wr.mpNormalize(r))}xr.prototype.deriveSharedSecret=function(e){pe.ok(e instanceof ua);var r=e._pub.multiply(this._priv);return $.from(r.getX().toBigInteger().toByteArray())};function yn(){var e=pt.sign.keyPair(),r=$.from(e.secretKey),t=$.from(e.publicKey);pe.strictEqual(r.length,64),pe.strictEqual(t.length,32);var a=[];a.push({name:"A",data:t}),a.push({name:"k",data:r.slice(0,32)});var i=new be({type:"ed25519",parts:a});return i}function Sn(e){var r=[],t;if(Ge){var a={nistp256:"prime256v1",nistp384:"secp384r1",nistp521:"secp521r1"}[e],i=rr.createECDH(a);return i.generateKeys(),r.push({name:"curve",data:$.from(e)}),r.push({name:"Q",data:i.getPublicKey()}),r.push({name:"d",data:i.getPrivateKey()}),t=new be({type:"ecdsa",curve:e,parts:r}),t}else{var n=new tr(e),s=n.getN(),f=Math.ceil((s.bitLength()+64)/8),o=new se(rr.randomBytes(f)),u=s.subtract(se.ONE),c=o.mod(u).add(se.ONE),l=n.getG().multiply(c);return c=$.from(c.toByteArray()),l=$.from(n.getCurve().encodePointHex(l),"hex"),r.push({name:"curve",data:$.from(e)}),r.push({name:"Q",data:l}),r.push({name:"d",data:c}),t=new be({type:"ecdsa",curve:e,parts:r}),t}}});var vt=P((Lo,la)=>{la.exports={Verifier:yr,Signer:Sr};var ha=h("tweetnacl"),Kr=h("stream"),pa=h("util"),qn=h("assert-plus"),Ve=h("safer-buffer").Buffer,lt=Be();function yr(e,r){if(r.toLowerCase()!=="sha512")throw new Error("ED25519 only supports the use of SHA-512 hashes");this.key=e,this.chunks=[],Kr.Writable.call(this,{})}pa.inherits(yr,Kr.Writable);yr.prototype._write=function(e,r,t){this.chunks.push(e),t()};yr.prototype.update=function(e){typeof e=="string"&&(e=Ve.from(e,"binary")),this.chunks.push(e)};yr.prototype.verify=function(e,r){var t;if(lt.isSignature(e,[2,0])){if(e.type!=="ed25519")return!1;t=e.toBuffer("raw")}else if(typeof e=="string")t=Ve.from(e,"base64");else if(lt.isSignature(e,[1,0]))throw new Error("signature was created by too old a version of sshpk and cannot be verified");return qn.buffer(t),ha.sign.detached.verify(new Uint8Array(Ve.concat(this.chunks)),new Uint8Array(t),new Uint8Array(this.key.part.A.data))};function Sr(e,r){if(r.toLowerCase()!=="sha512")throw new Error("ED25519 only supports the use of SHA-512 hashes");this.key=e,this.chunks=[],Kr.Writable.call(this,{})}pa.inherits(Sr,Kr.Writable);Sr.prototype._write=function(e,r,t){this.chunks.push(e),t()};Sr.prototype.update=function(e){typeof e=="string"&&(e=Ve.from(e,"binary")),this.chunks.push(e)};Sr.prototype.sign=function(){var e=ha.sign.detached(new Uint8Array(Ve.concat(this.chunks)),new Uint8Array(Ve.concat([this.key.part.k.data,this.key.part.A.data]))),r=Ve.from(e),t=lt.parse(r,"ed25519","raw");return t.hashAlgorithm="sha512",t}});var ar=P((Ro,ga)=>{ga.exports={read:Bn,readPkcs8:En,write:bn,writePkcs8:da,pkcs8ToBuffer:On,readECDSACurve:dt,writeECDSACurve:gt};var Pe=h("assert-plus"),p=h("asn1"),Te=h("safer-buffer").Buffer,qr=R(),B=N(),Br=H(),Ee=z(),va=Ce();function Bn(e,r){return va.read(e,r,"pkcs8")}function bn(e,r){return va.write(e,r,"pkcs8")}function O(e,r){return Pe.strictEqual(e.peek(),p.Ber.Integer,r+" is not an Integer"),B.mpNormalize(e.readString(p.Ber.Integer,!0))}function En(e,r,t){t.peek()===p.Ber.Integer&&(Pe.strictEqual(r,"private","unexpected Integer at start of public key"),t.readString(p.Ber.Integer,!0)),t.readSequence();var a=t.offset+t.length,i=t.readOID();switch(i){case"1.2.840.113549.1.1.1":return t._offset=a,r==="public"?Pn(t):Fn(t);case"1.2.840.10040.4.1":return r==="public"?An(t):kn(t);case"1.2.840.10045.2.1":return r==="public"?Cn(t):In(t);case"1.3.101.112":return r==="public"?_n(t):Dn(t);case"1.3.101.110":return r==="public"?xn(t):Kn(t);default:throw new Error("Unknown key type OID "+i)}}function Pn(e){e.readSequence(p.Ber.BitString),e.readByte(),e.readSequence();var r=O(e,"modulus"),t=O(e,"exponent"),a={type:"rsa",source:e.originalInput,parts:[{name:"e",data:t},{name:"n",data:r}]};return new Br(a)}function Fn(e){e.readSequence(p.Ber.OctetString),e.readSequence();var r=O(e,"version");Pe.equal(r[0],0,"unknown RSA private key version");var t=O(e,"modulus"),a=O(e,"public exponent"),i=O(e,"private exponent"),n=O(e,"prime1"),s=O(e,"prime2"),f=O(e,"exponent1"),o=O(e,"exponent2"),u=O(e,"iqmp"),c={type:"rsa",parts:[{name:"n",data:t},{name:"e",data:a},{name:"d",data:i},{name:"iqmp",data:u},{name:"p",data:n},{name:"q",data:s},{name:"dmodp",data:f},{name:"dmodq",data:o}]};return new Ee(c)}function An(e){e.readSequence();var r=O(e,"p"),t=O(e,"q"),a=O(e,"g");e.readSequence(p.Ber.BitString),e.readByte();var i=O(e,"y"),n={type:"dsa",parts:[{name:"p",data:r},{name:"q",data:t},{name:"g",data:a},{name:"y",data:i}]};return new Br(n)}function kn(e){e.readSequence();var r=O(e,"p"),t=O(e,"q"),a=O(e,"g");e.readSequence(p.Ber.OctetString);var i=O(e,"x"),n=B.calculateDSAPublic(a,r,i),s={type:"dsa",parts:[{name:"p",data:r},{name:"q",data:t},{name:"g",data:a},{name:"y",data:n},{name:"x",data:i}]};return new Ee(s)}function dt(e){var r,t,a,i,n;if(e.peek()===p.Ber.OID){var s=e.readOID();for(t=Object.keys(qr.curves),a=0;a<t.length;++a)if(i=t[a],n=qr.curves[i],n.pkcs8oid===s){r=i;break}}else{e.readSequence();var f=e.readString(p.Ber.Integer,!0);Pe.strictEqual(f[0],1,"ECDSA key not version 1");var o={};e.readSequence();var u=e.readOID();Pe.strictEqual(u,"1.2.840.10045.1.1","ECDSA key is not from a prime-field");var c=o.p=B.mpNormalize(e.readString(p.Ber.Integer,!0));o.size=c.length*8-B.countZeros(c),e.readSequence(),o.a=B.mpNormalize(e.readString(p.Ber.OctetString,!0)),o.b=B.mpNormalize(e.readString(p.Ber.OctetString,!0)),e.peek()===p.Ber.BitString&&(o.s=e.readString(p.Ber.BitString,!0)),o.G=e.readString(p.Ber.OctetString,!0),Pe.strictEqual(o.G[0],4,"uncompressed G is required"),o.n=B.mpNormalize(e.readString(p.Ber.Integer,!0)),o.h=B.mpNormalize(e.readString(p.Ber.Integer,!0)),Pe.strictEqual(o.h[0],1,"a cofactor=1 curve is required"),t=Object.keys(qr.curves);var l=Object.keys(o);for(a=0;a<t.length;++a){i=t[a],n=qr.curves[i];for(var g=!0,d=0;d<l.length;++d){var v=l[d];if(n[v]!==void 0){if(typeof n[v]=="object"&&n[v].equals!==void 0){if(!n[v].equals(o[v])){g=!1;break}}else if(Te.isBuffer(n[v])){if(n[v].toString("binary")!==o[v].toString("binary")){g=!1;break}}else if(n[v]!==o[v]){g=!1;break}}}if(g){r=i;break}}}return r}function In(e){var r=dt(e);Pe.string(r,"a known elliptic curve"),e.readSequence(p.Ber.OctetString),e.readSequence();var t=O(e,"version");Pe.equal(t[0],1,"unknown version of ECDSA key");var a=e.readString(p.Ber.OctetString,!0),i;if(e.peek()==160&&(e.readSequence(160),e._offset+=e.length),e.peek()==161&&(e.readSequence(161),i=e.readString(p.Ber.BitString,!0),i=B.ecNormalize(i)),i===void 0){var n=B.publicFromPrivateECDSA(r,a);i=n.part.Q.data}var s={type:"ecdsa",parts:[{name:"curve",data:Te.from(r)},{name:"Q",data:i},{name:"d",data:a}]};return new Ee(s)}function Cn(e){var r=dt(e);Pe.string(r,"a known elliptic curve");var t=e.readString(p.Ber.BitString,!0);t=B.ecNormalize(t);var a={type:"ecdsa",parts:[{name:"curve",data:Te.from(r)},{name:"Q",data:t}]};return new Br(a)}function _n(e){e.peek()===0&&e.readByte();var r=B.readBitString(e),t={type:"ed25519",parts:[{name:"A",data:B.zeroPadToLength(r,32)}]};return new Br(t)}function xn(e){var r=B.readBitString(e),t={type:"curve25519",parts:[{name:"A",data:B.zeroPadToLength(r,32)}]};return new Br(t)}function Dn(e){e.peek()===0&&e.readByte(),e.readSequence(p.Ber.OctetString);var r=e.readString(p.Ber.OctetString,!0);r=B.zeroPadToLength(r,32);for(var t,a;(a=e.peek())!==null;)a===(p.Ber.Context|1)?t=B.readBitString(e,a):(e.readSequence(a),e._offset+=e.length);t===void 0&&(t=B.calculateED25519Public(r));var i={type:"ed25519",parts:[{name:"A",data:B.zeroPadToLength(t,32)},{name:"k",data:B.zeroPadToLength(r,32)}]};return new Ee(i)}function Kn(e){e.peek()===0&&e.readByte(),e.readSequence(p.Ber.OctetString);var r=e.readString(p.Ber.OctetString,!0);r=B.zeroPadToLength(r,32);var t=B.calculateX25519Public(r),a={type:"curve25519",parts:[{name:"A",data:B.zeroPadToLength(t,32)},{name:"k",data:B.zeroPadToLength(r,32)}]};return new Ee(a)}function On(e){var r=new p.BerWriter;return da(r,e),r.buffer}function da(e,r){if(e.startSequence(),Ee.isPrivateKey(r)){var t=0;r.type==="ed25519"&&(t=1);var a=Te.from([t]);e.writeBuffer(a,p.Ber.Integer)}switch(e.startSequence(),r.type){case"rsa":e.writeOID("1.2.840.113549.1.1.1"),Ee.isPrivateKey(r)?Tn(r,e):Un(r,e);break;case"dsa":e.writeOID("1.2.840.10040.4.1"),Ee.isPrivateKey(r)?Nn(r,e):zn(r,e);break;case"ecdsa":e.writeOID("1.2.840.10045.2.1"),Ee.isPrivateKey(r)?jn(r,e):Hn(r,e);break;case"ed25519":e.writeOID("1.3.101.112"),Ee.isPrivateKey(r)?Rn(r,e):Ln(r,e);break;default:throw new Error("Unsupported key type: "+r.type)}e.endSequence()}function Tn(e,r){r.writeNull(),r.endSequence(),r.startSequence(p.Ber.OctetString),r.startSequence();var t=Te.from([0]);r.writeBuffer(t,p.Ber.Integer),r.writeBuffer(e.part.n.data,p.Ber.Integer),r.writeBuffer(e.part.e.data,p.Ber.Integer),r.writeBuffer(e.part.d.data,p.Ber.Integer),r.writeBuffer(e.part.p.data,p.Ber.Integer),r.writeBuffer(e.part.q.data,p.Ber.Integer),(!e.part.dmodp||!e.part.dmodq)&&B.addRSAMissing(e),r.writeBuffer(e.part.dmodp.data,p.Ber.Integer),r.writeBuffer(e.part.dmodq.data,p.Ber.Integer),r.writeBuffer(e.part.iqmp.data,p.Ber.Integer),r.endSequence(),r.endSequence()}function Un(e,r){r.writeNull(),r.endSequence(),r.startSequence(p.Ber.BitString),r.writeByte(0),r.startSequence(),r.writeBuffer(e.part.n.data,p.Ber.Integer),r.writeBuffer(e.part.e.data,p.Ber.Integer),r.endSequence(),r.endSequence()}function Nn(e,r){r.startSequence(),r.writeBuffer(e.part.p.data,p.Ber.Integer),r.writeBuffer(e.part.q.data,p.Ber.Integer),r.writeBuffer(e.part.g.data,p.Ber.Integer),r.endSequence(),r.endSequence(),r.startSequence(p.Ber.OctetString),r.writeBuffer(e.part.x.data,p.Ber.Integer),r.endSequence()}function zn(e,r){r.startSequence(),r.writeBuffer(e.part.p.data,p.Ber.Integer),r.writeBuffer(e.part.q.data,p.Ber.Integer),r.writeBuffer(e.part.g.data,p.Ber.Integer),r.endSequence(),r.endSequence(),r.startSequence(p.Ber.BitString),r.writeByte(0),r.writeBuffer(e.part.y.data,p.Ber.Integer),r.endSequence()}function gt(e,r){var t=qr.curves[e.curve];if(t.pkcs8oid)r.writeOID(t.pkcs8oid);else{r.startSequence();var a=Te.from([1]);r.writeBuffer(a,p.Ber.Integer),r.startSequence(),r.writeOID("1.2.840.10045.1.1"),r.writeBuffer(t.p,p.Ber.Integer),r.endSequence(),r.startSequence();var i=t.p;i[0]===0&&(i=i.slice(1)),r.writeBuffer(i,p.Ber.OctetString),r.writeBuffer(t.b,p.Ber.OctetString),r.writeBuffer(t.s,p.Ber.BitString),r.endSequence(),r.writeBuffer(t.G,p.Ber.OctetString),r.writeBuffer(t.n,p.Ber.Integer);var n=t.h;n||(n=Te.from([1])),r.writeBuffer(n,p.Ber.Integer),r.endSequence()}}function Hn(e,r){gt(e,r),r.endSequence();var t=B.ecNormalize(e.part.Q.data,!0);r.writeBuffer(t,p.Ber.BitString)}function jn(e,r){gt(e,r),r.endSequence(),r.startSequence(p.Ber.OctetString),r.startSequence();var t=Te.from([1]);r.writeBuffer(t,p.Ber.Integer),r.writeBuffer(e.part.d.data,p.Ber.OctetString),r.startSequence(161);var a=B.ecNormalize(e.part.Q.data,!0);r.writeBuffer(a,p.Ber.BitString),r.endSequence(),r.endSequence(),r.endSequence()}function Ln(e,r){r.endSequence(),B.writeBitString(r,e.part.A.data)}function Rn(e,r){r.endSequence(),r.startSequence(p.Ber.OctetString);for(var t=B.mpNormalize(e.part.k.data);t.length>32&&t[0]===0;)t=t.slice(1);r.writeBuffer(t,p.Ber.OctetString),r.endSequence(),B.writeBitString(r,e.part.A.data,p.Ber.Context|1)}});var Tr=P((Mo,wa)=>{wa.exports={read:Yn,readPkcs1:Vn,write:Gn,writePkcs1:ts};var le=h("assert-plus"),S=h("asn1"),ir=h("safer-buffer").Buffer,Or=R(),_e=N(),mt=H(),Ue=z(),ma=Ce(),Mn=ar(),Qn=Mn.readECDSACurve;function Yn(e,r){return ma.read(e,r,"pkcs1")}function Gn(e,r){return ma.write(e,r,"pkcs1")}function A(e,r){return le.strictEqual(e.peek(),S.Ber.Integer,r+" is not an Integer"),_e.mpNormalize(e.readString(S.Ber.Integer,!0))}function Vn(e,r,t){switch(e){case"RSA":if(r==="public")return Zn(t);if(r==="private")return Wn(t);throw new Error("Unknown key type: "+r);case"DSA":if(r==="public")return Jn(t);if(r==="private")return Xn(t);throw new Error("Unknown key type: "+r);case"EC":case"ECDSA":if(r==="private")return rs(t);if(r==="public")return es(t);throw new Error("Unknown key type: "+r);case"EDDSA":case"EdDSA":if(r==="private")return $n(t);throw new Error(r+" keys not supported with EdDSA");default:throw new Error("Unknown key algo: "+e)}}function Zn(e){var r=A(e,"modulus"),t=A(e,"exponent"),a={type:"rsa",parts:[{name:"e",data:t},{name:"n",data:r}]};return new mt(a)}function Wn(e){var r=A(e,"version");le.strictEqual(r[0],0);var t=A(e,"modulus"),a=A(e,"public exponent"),i=A(e,"private exponent"),n=A(e,"prime1"),s=A(e,"prime2"),f=A(e,"exponent1"),o=A(e,"exponent2"),u=A(e,"iqmp"),c={type:"rsa",parts:[{name:"n",data:t},{name:"e",data:a},{name:"d",data:i},{name:"iqmp",data:u},{name:"p",data:n},{name:"q",data:s},{name:"dmodp",data:f},{name:"dmodq",data:o}]};return new Ue(c)}function Xn(e){var r=A(e,"version");le.strictEqual(r.readUInt8(0),0);var t=A(e,"p"),a=A(e,"q"),i=A(e,"g"),n=A(e,"y"),s=A(e,"x"),f={type:"dsa",parts:[{name:"p",data:t},{name:"q",data:a},{name:"g",data:i},{name:"y",data:n},{name:"x",data:s}]};return new Ue(f)}function $n(e){var r=A(e,"version");le.strictEqual(r.readUInt8(0),1);var t=e.readString(S.Ber.OctetString,!0);e.readSequence(160);var a=e.readOID();le.strictEqual(a,"1.3.101.112","the ed25519 curve identifier"),e.readSequence(161);var i=_e.readBitString(e),n={type:"ed25519",parts:[{name:"A",data:_e.zeroPadToLength(i,32)},{name:"k",data:t}]};return new Ue(n)}function Jn(e){var r=A(e,"y"),t=A(e,"p"),a=A(e,"q"),i=A(e,"g"),n={type:"dsa",parts:[{name:"y",data:r},{name:"p",data:t},{name:"q",data:a},{name:"g",data:i}]};return new mt(n)}function es(e){e.readSequence();var r=e.readOID();le.strictEqual(r,"1.2.840.10045.2.1","must be ecPublicKey");for(var t=e.readOID(),a,i=Object.keys(Or.curves),n=0;n<i.length;++n){var s=i[n],f=Or.curves[s];if(f.pkcs8oid===t){a=s;break}}le.string(a,"a known ECDSA named curve");var o=e.readString(S.Ber.BitString,!0);o=_e.ecNormalize(o);var u={type:"ecdsa",parts:[{name:"curve",data:ir.from(a)},{name:"Q",data:o}]};return new mt(u)}function rs(e){var r=A(e,"version");le.strictEqual(r.readUInt8(0),1);var t=e.readString(S.Ber.OctetString,!0);e.readSequence(160);var a=Qn(e);le.string(a,"a known elliptic curve"),e.readSequence(161);var i=e.readString(S.Ber.BitString,!0);i=_e.ecNormalize(i);var n={type:"ecdsa",parts:[{name:"curve",data:ir.from(a)},{name:"Q",data:i},{name:"d",data:t}]};return new Ue(n)}function ts(e,r){switch(e.startSequence(),r.type){case"rsa":Ue.isPrivateKey(r)?is(e,r):as(e,r);break;case"dsa":Ue.isPrivateKey(r)?ns(e,r):ss(e,r);break;case"ecdsa":Ue.isPrivateKey(r)?os(e,r):fs(e,r);break;case"ed25519":Ue.isPrivateKey(r)?us(e,r):cs(e,r);break;default:throw new Error("Unknown key algo: "+r.type)}e.endSequence()}function as(e,r){e.writeBuffer(r.part.n.data,S.Ber.Integer),e.writeBuffer(r.part.e.data,S.Ber.Integer)}function is(e,r){var t=ir.from([0]);e.writeBuffer(t,S.Ber.Integer),e.writeBuffer(r.part.n.data,S.Ber.Integer),e.writeBuffer(r.part.e.data,S.Ber.Integer),e.writeBuffer(r.part.d.data,S.Ber.Integer),e.writeBuffer(r.part.p.data,S.Ber.Integer),e.writeBuffer(r.part.q.data,S.Ber.Integer),(!r.part.dmodp||!r.part.dmodq)&&_e.addRSAMissing(r),e.writeBuffer(r.part.dmodp.data,S.Ber.Integer),e.writeBuffer(r.part.dmodq.data,S.Ber.Integer),e.writeBuffer(r.part.iqmp.data,S.Ber.Integer)}function ns(e,r){var t=ir.from([0]);e.writeBuffer(t,S.Ber.Integer),e.writeBuffer(r.part.p.data,S.Ber.Integer),e.writeBuffer(r.part.q.data,S.Ber.Integer),e.writeBuffer(r.part.g.data,S.Ber.Integer),e.writeBuffer(r.part.y.data,S.Ber.Integer),e.writeBuffer(r.part.x.data,S.Ber.Integer)}function ss(e,r){e.writeBuffer(r.part.y.data,S.Ber.Integer),e.writeBuffer(r.part.p.data,S.Ber.Integer),e.writeBuffer(r.part.q.data,S.Ber.Integer),e.writeBuffer(r.part.g.data,S.Ber.Integer)}function fs(e,r){e.startSequence(),e.writeOID("1.2.840.10045.2.1");var t=r.part.curve.data.toString(),a=Or.curves[t].pkcs8oid;le.string(a,"a known ECDSA named curve"),e.writeOID(a),e.endSequence();var i=_e.ecNormalize(r.part.Q.data,!0);e.writeBuffer(i,S.Ber.BitString)}function os(e,r){var t=ir.from([1]);e.writeBuffer(t,S.Ber.Integer),e.writeBuffer(r.part.d.data,S.Ber.OctetString),e.startSequence(160);var a=r.part.curve.data.toString(),i=Or.curves[a].pkcs8oid;le.string(i,"a known ECDSA named curve"),e.writeOID(i),e.endSequence(),e.startSequence(161);var n=_e.ecNormalize(r.part.Q.data,!0);e.writeBuffer(n,S.Ber.BitString),e.endSequence()}function us(e,r){var t=ir.from([1]);e.writeBuffer(t,S.Ber.Integer),e.writeBuffer(r.part.k.data,S.Ber.OctetString),e.startSequence(160),e.writeOID("1.3.101.112"),e.endSequence(),e.startSequence(161),_e.writeBitString(e,r.part.A.data),e.endSequence()}function cs(e,r){throw new Error("Public keys are not supported for EdDSA PKCS#1")}});var xe=P((Qo,Ea)=>{Ea.exports={read:Ur.bind(void 0,!1,void 0),readType:Ur.bind(void 0,!1),write:ps,readPartial:Ur.bind(void 0,!0),readInternal:Ur,keyTypeToAlg:ba,algToKeyType:Ba};var Fe=h("assert-plus"),ya=h("safer-buffer").Buffer,nr=R(),Nr=N(),hs=H(),Sa=z(),qa=Ye();function Ba(e){if(Fe.string(e),e==="ssh-dss")return"dsa";if(e==="ssh-rsa")return"rsa";if(e==="ssh-ed25519")return"ed25519";if(e==="ssh-curve25519")return"curve25519";if(e.match(/^ecdsa-sha2-/))return"ecdsa";throw new Error("Unknown algorithm "+e)}function ba(e){if(Fe.object(e),e.type==="dsa")return"ssh-dss";if(e.type==="rsa")return"ssh-rsa";if(e.type==="ed25519")return"ssh-ed25519";if(e.type==="curve25519")return"ssh-curve25519";if(e.type==="ecdsa")return"ecdsa-sha2-"+e.part.curve.data.toString();throw new Error("Unknown key type "+e.type)}function Ur(e,r,t,a){typeof t=="string"&&(t=ya.from(t)),Fe.buffer(t,"buf");var i={},n=i.parts=[],s=new qa({buffer:t}),f=s.readString();Fe.ok(!s.atEnd(),"key must have at least one part"),i.type=Ba(f);var o=nr.info[i.type].parts.length;for(r&&r==="private"&&(o=nr.privInfo[i.type].parts.length);!s.atEnd()&&n.length<o;)n.push(s.readPart());for(;!e&&!s.atEnd();)n.push(s.readPart());Fe.ok(n.length>=1,"key must have at least one part"),Fe.ok(e||s.atEnd(),"leftover bytes at end of key");var u=hs,c=nr.info[i.type];if((r==="private"||c.parts.length!==n.length)&&(c=nr.privInfo[i.type],u=Sa),Fe.strictEqual(c.parts.length,n.length),i.type==="ecdsa"){var l=/^ecdsa-sha2-(.+)$/.exec(f);Fe.ok(l!==null),Fe.strictEqual(l[1],n[0].data.toString())}for(var g=!0,d=0;d<c.parts.length;++d){var v=n[d];if(v.name=c.parts[d],i.type==="ed25519"&&v.name==="k"&&(v.data=v.data.slice(0,32)),v.name!=="curve"&&c.normalize!==!1){var q;i.type==="ed25519"?q=Nr.zeroPadToLength(v.data,32):q=Nr.mpNormalize(v.data),q.toString("binary")!==v.data.toString("binary")&&(v.data=q,g=!1)}}return g&&(i._rfc4253Cache=s.toBuffer()),e&&typeof e=="object"&&(e.remainder=s.remainder(),e.consumed=s._offset),new u(i)}function ps(e,r){Fe.object(e);var t=ba(e),a,i=nr.info[e.type];Sa.isPrivateKey(e)&&(i=nr.privInfo[e.type]);var n=i.parts,s=new qa({});for(s.writeString(t),a=0;a<n.length;++a){var f=e.part[n[a]].data;i.normalize!==!1&&(e.type==="ed25519"?f=Nr.zeroPadToLength(f,32):f=Nr.mpNormalize(f)),e.type==="ed25519"&&n[a]==="k"&&(f=ya.concat([f,e.part.A.data])),s.writeBuffer(f)}return s.toBuffer()}});var Er=P((Zo,ka)=>{ka.exports={read:ds,readSSHPrivate:gs,write:ms};var br=h("assert-plus"),Yo=h("asn1"),De=h("safer-buffer").Buffer,Go=R(),Fa=N(),zr=h("crypto"),Vo=H(),wt=z(),ls=Ce(),Pa=xe(),sr=Ye(),vs=he(),fr;function ds(e,r){return ls.read(e,r)}var Aa="openssh-key-v1";function gs(e,r,t){r=new sr({buffer:r});var a=r.readCString();br.strictEqual(a,Aa,"bad magic string");var i=r.readString(),n=r.readString(),s=r.readBuffer(),f=r.readInt();if(f!==1)throw new Error("OpenSSH-format key file contains multiple keys: this is unsupported.");var o=r.readBuffer();if(e==="public")return br.ok(r.atEnd(),"excess bytes left after key"),Pa.read(o);var u=r.readBuffer();br.ok(r.atEnd(),"excess bytes left after key");var c=new sr({buffer:s});switch(n){case"none":if(i!=="none")throw new Error('OpenSSH-format key uses KDF "none" but specifies a cipher other than "none"');break;case"bcrypt":var l=c.readBuffer(),g=c.readInt(),d=Fa.opensshCipherInfo(i);if(fr===void 0&&(fr=h("bcrypt-pbkdf")),typeof t.passphrase=="string"&&(t.passphrase=De.from(t.passphrase,"utf-8")),!De.isBuffer(t.passphrase))throw new vs.KeyEncryptedError(t.filename,"OpenSSH");var v=new Uint8Array(t.passphrase),q=new Uint8Array(l),m=new Uint8Array(d.keySize+d.blockSize),Y=fr.pbkdf(v,v.length,q,q.length,m,m.length,g);if(Y!==0)throw new Error("bcrypt_pbkdf function returned failure, parameters invalid");m=De.from(m);var w=m.slice(0,d.keySize),_=m.slice(d.keySize,d.keySize+d.blockSize),G=zr.createDecipheriv(d.opensslName,w,_);G.setAutoPadding(!1);var ke,we=[];for(G.once("error",function(Se){throw Se.toString().indexOf("bad decrypt")!==-1?new Error("Incorrect passphrase supplied, could not decrypt key"):Se}),G.write(u),G.end();(ke=G.read())!==null;)we.push(ke);u=De.concat(we);break;default:throw new Error('OpenSSH-format key uses unknown KDF "'+n+'"')}r=new sr({buffer:u});var I=r.readInt(),ye=r.readInt();if(I!==ye)throw new Error("Incorrect passphrase supplied, could not decrypt key");var ne={},Le=Pa.readInternal(ne,"private",r.remainder());r.skip(ne.consumed);var X=r.readString();return Le.comment=X,Le}function ms(e,r){var t;wt.isPrivateKey(e)?t=e.toPublic():t=e;var a="none",i="none",n=De.alloc(0),s={blockSize:8},f;r!==void 0&&(f=r.passphrase,typeof f=="string"&&(f=De.from(f,"utf-8")),f!==void 0&&(br.buffer(f,"options.passphrase"),br.optionalString(r.cipher,"options.cipher"),a=r.cipher,a===void 0&&(a="aes128-ctr"),s=Fa.opensshCipherInfo(a),i="bcrypt"));var o;if(wt.isPrivateKey(e)){o=new sr({});var u=zr.randomBytes(4).readUInt32BE(0);o.writeInt(u),o.writeInt(u),o.write(e.toBuffer("rfc4253")),o.writeString(e.comment||"");for(var c=1;o._offset%s.blockSize!==0;)o.writeChar(c++);o=o.toBuffer()}switch(i){case"none":break;case"bcrypt":var l=zr.randomBytes(16),g=16,d=new sr({});d.writeBuffer(l),d.writeInt(g),n=d.toBuffer(),fr===void 0&&(fr=h("bcrypt-pbkdf"));var v=new Uint8Array(f),q=new Uint8Array(l),m=new Uint8Array(s.keySize+s.blockSize),Y=fr.pbkdf(v,v.length,q,q.length,m,m.length,g);if(Y!==0)throw new Error("bcrypt_pbkdf function returned failure, parameters invalid");m=De.from(m);var w=m.slice(0,s.keySize),_=m.slice(s.keySize,s.keySize+s.blockSize),G=zr.createCipheriv(s.opensslName,w,_);G.setAutoPadding(!1);var ke,we=[];for(G.once("error",function($e){throw $e}),G.write(o),G.end();(ke=G.read())!==null;)we.push(ke);o=De.concat(we);break;default:throw new Error("Unsupported kdf "+i)}var I=new sr({});I.writeCString(Aa),I.writeString(a),I.writeString(i),I.writeBuffer(n),I.writeInt(1),I.writeBuffer(t.toBuffer("rfc4253")),o&&I.writeBuffer(o),I=I.toBuffer();var ye;wt.isPrivateKey(e)?ye="OPENSSH PRIVATE KEY":ye="OPENSSH PUBLIC KEY";var ne=I.toString("base64"),Le=ne.length+ne.length/70+18+16+ye.length*2+10;I=De.alloc(Le);var X=0;X+=I.write("-----BEGIN "+ye+`-----
`,X);for(var Se=0;Se<ne.length;){var Re=Se+70;Re>ne.length&&(Re=ne.length),X+=I.write(ne.slice(Se,Re),X),I[X++]=10,Se=Re}return X+=I.write("-----END "+ye+`-----
`,X),I.slice(0,X)}});var Ce=P((Xo,Ca)=>{Ca.exports={read:As,write:ks};var ve=h("assert-plus"),or=h("asn1"),ws=h("crypto"),Ne=h("safer-buffer").Buffer,Wo=R(),yt=N(),ys=H(),Ss=z(),St=Tr(),qt=ar(),qs=Er(),Bs=xe(),Ia=he(),bs="1.2.840.113549.1.5.13",Es="1.2.840.113549.1.5.12",Bt={"1.2.840.113549.3.7":"3des-cbc","2.16.840.1.101.3.4.1.2":"aes128-cbc","2.16.840.1.101.3.4.1.42":"aes256-cbc"},Ps={};Object.keys(Bt).forEach(function(e){Ps[Bt[e]]=e});var bt={"1.2.840.113549.2.7":"sha1","1.2.840.113549.2.9":"sha256","1.2.840.113549.2.11":"sha512"},Fs={};Object.keys(bt).forEach(function(e){Fs[bt[e]]=e});function As(e,r,t){var a=e;typeof e!="string"&&(ve.buffer(e,"buf"),e=e.toString("ascii"));for(var i=e.trim().split(/[\r\n]+/g),n,s=-1;!n&&s<i.length;)n=i[++s].match(/[-]+[ ]*BEGIN ([A-Z0-9][A-Za-z0-9]+ )?(PUBLIC|PRIVATE) KEY[ ]*[-]+/);ve.ok(n,"invalid PEM header");for(var f,o=i.length;!f&&o>0;)f=i[--o].match(/[-]+[ ]*END ([A-Z0-9][A-Za-z0-9]+ )?(PUBLIC|PRIVATE) KEY[ ]*[-]+/);ve.ok(f,"invalid PEM footer"),ve.equal(n[2],f[2]);var u=n[2].toLowerCase(),c;n[1]&&(ve.equal(n[1],f[1],"PEM header and footer mismatch"),c=n[1].trim()),i=i.slice(s,o+1);for(var l={};i=i.slice(1),n=i[0].match(/^([A-Za-z0-9-]+): (.+)$/),!!n;)l[n[1].toLowerCase()]=n[2];i=i.slice(0,-1).join(""),e=Ne.from(i,"base64");var g,d,v;if(l["proc-type"]){var q=l["proc-type"].split(",");if(q[0]==="4"&&q[1]==="ENCRYPTED")if(typeof r.passphrase=="string"&&(r.passphrase=Ne.from(r.passphrase,"utf-8")),Ne.isBuffer(r.passphrase))q=l["dek-info"].split(","),ve.ok(q.length===2),g=q[0].toLowerCase(),v=Ne.from(q[1],"hex"),d=yt.opensslKeyDeriv(g,v,r.passphrase,1).key;else throw new Ia.KeyEncryptedError(r.filename,"PEM")}if(c&&c.toLowerCase()==="encrypted"){var m=new or.BerReader(e),Y;m.readSequence(),m.readSequence(),Y=m.offset+m.length;var w=m.readOID();if(w!==bs)throw new Error("Unsupported PEM/PKCS8 encryption scheme: "+w);m.readSequence(),m.readSequence();var _=m.offset+m.length,G=m.readOID();if(G!==Es)throw new Error("Unsupported PBES2 KDF: "+G);m.readSequence();var ke=m.readString(or.Ber.OctetString,!0),we=m.readInt(),I="sha1";if(m.offset<_){m.readSequence();var ye=m.readOID();if(I=bt[ye],I===void 0)throw new Error("Unsupported PBKDF2 hash: "+ye)}m._offset=_,m.readSequence();var ne=m.readOID();if(g=Bt[ne],g===void 0)throw new Error("Unsupported PBES2 cipher: "+ne);if(v=m.readString(or.Ber.OctetString,!0),m._offset=Y,e=m.readString(or.Ber.OctetString,!0),typeof r.passphrase=="string"&&(r.passphrase=Ne.from(r.passphrase,"utf-8")),!Ne.isBuffer(r.passphrase))throw new Ia.KeyEncryptedError(r.filename,"PEM");var Le=yt.opensshCipherInfo(g);g=Le.opensslName,d=yt.pbkdf2(I,ke,we,Le.keySize,r.passphrase),c=void 0}if(g&&d&&v){var X=ws.createDecipheriv(g,d,v),Se,Re=[];for(X.once("error",function(Gt){throw Gt.toString().indexOf("bad decrypt")!==-1?new Error("Incorrect passphrase supplied, could not decrypt key"):Gt}),X.write(e),X.end();(Se=X.read())!==null;)Re.push(Se);e=Ne.concat(Re)}if(c&&c.toLowerCase()==="openssh")return qs.readSSHPrivate(u,e,r);if(c&&c.toLowerCase()==="ssh2")return Bs.readType(u,e,r);var $e=new or.BerReader(e);return $e.originalInput=a,$e.readSequence(),c?(t&&ve.strictEqual(t,"pkcs1"),St.readPkcs1(c,u,$e)):(t&&ve.strictEqual(t,"pkcs8"),qt.readPkcs8(c,u,$e))}function ks(e,r,t){ve.object(e);var a={ecdsa:"EC",rsa:"RSA",dsa:"DSA",ed25519:"EdDSA"}[e.type],i,n=new or.BerWriter;if(Ss.isPrivateKey(e))t&&t==="pkcs8"?(i="PRIVATE KEY",qt.writePkcs8(n,e)):(t&&ve.strictEqual(t,"pkcs1"),i=a+" PRIVATE KEY",St.writePkcs1(n,e));else if(ys.isKey(e))t&&t==="pkcs1"?(i=a+" PUBLIC KEY",St.writePkcs1(n,e)):(t&&ve.strictEqual(t,"pkcs8"),i="PUBLIC KEY",qt.writePkcs8(n,e));else throw new Error("key is not a Key or PrivateKey");var s=n.buffer.toString("base64"),f=s.length+s.length/64+18+16+i.length*2+10,o=Ne.alloc(f),u=0;u+=o.write("-----BEGIN "+i+`-----
`,u);for(var c=0;c<s.length;){var l=c+64;l>s.length&&(l=s.length),u+=o.write(s.slice(c,l),u),o[u++]=10,c=l}return u+=o.write("-----END "+i+`-----
`,u),o.slice(0,u)}});var Pt=P((ru,xa)=>{xa.exports={read:_s,write:xs};var Pr=h("assert-plus"),Et=h("safer-buffer").Buffer,ur=xe(),$o=N(),Is=H(),Jo=z(),eu=Er(),Cs=/^([a-z0-9-]+)[ \t]+([a-zA-Z0-9+\/]+[=]*)([ \t]+([^ \t][^\n]*[\n]*)?)?$/,_a=/^([a-z0-9-]+)[ \t\n]+([a-zA-Z0-9+\/][a-zA-Z0-9+\/ \t\n=]*)([^a-zA-Z0-9+\/ \t\n=].*)?$/;function _s(e,r){typeof e!="string"&&(Pr.buffer(e,"buf"),e=e.toString("ascii"));var t=e.trim().replace(/[\\\r]/g,""),a=t.match(Cs);a||(a=t.match(_a)),Pr.ok(a,"key must match regex");var i=ur.algToKeyType(a[1]),n=Et.from(a[2],"base64"),s,f={};if(a[4])try{s=ur.read(n)}catch{a=t.match(_a),Pr.ok(a,"key must match regex"),n=Et.from(a[2],"base64"),s=ur.readInternal(f,"public",n)}else s=ur.readInternal(f,"public",n);if(Pr.strictEqual(i,s.type),a[4]&&a[4].length>0)s.comment=a[4];else if(f.consumed){var o=a[2]+(a[3]?a[3]:""),u=Math.ceil(f.consumed/3)*4;o=o.slice(0,u-2).replace(/[^a-zA-Z0-9+\/=]/g,"")+o.slice(u-2);var c=f.consumed%3;for(c>0&&o.slice(u-1,u)!=="="&&u--;o.slice(u,u+1)==="=";)u++;var l=o.slice(u);l=l.replace(/[\r\n]/g," ").replace(/^\s+/,""),l.match(/^[a-zA-Z0-9]/)&&(s.comment=l)}return s}function xs(e,r){if(Pr.object(e),!Is.isKey(e))throw new Error("Must be a public key");var t=[],a=ur.keyTypeToAlg(e);t.push(a);var i=ur.write(e);return t.push(i.toString("base64")),e.comment&&t.push(e.comment),Et.from(t.join(" "))}});var Hr=P((iu,Ka)=>{Ka.exports={read:Ks,write:js};var Ds=h("assert-plus"),Ze=h("safer-buffer").Buffer,Ft=H(),At=z(),K=N(),tu=Ye(),au=Dr(),Da={"rsa-sha1":5,"rsa-sha256":8,"rsa-sha512":10,"ecdsa-p256-sha256":13,"ecdsa-p384-sha384":14},ae={};Object.keys(Da).forEach(function(e){ae[Da[e]]=e.toUpperCase()});function Ks(e,r){typeof e!="string"&&(Ds.buffer(e,"buf"),e=e.toString("ascii"));var t=e.split(`
`);if(t[0].match(/^Private-key-format\: v1/)){var a=t[1].split(" "),i=parseInt(a[1],10),n=a[2];if(!ae[i])throw new Error("Unsupported algorithm: "+n);return Us(i,t.slice(2))}for(var s=0;t[s].match(/^\;/);)s++;if((t[s].match(/\. IN KEY /)||t[s].match(/\. IN DNSKEY /))&&t[s+1].length===0)return Os(t[s]);throw new Error("Cannot parse dnssec key")}function Os(e){var r=e.split(" "),t=parseInt(r[5],10);if(!ae[t])throw new Error("Unsupported algorithm: "+t);var a=r.slice(6,r.length).join(),i=Ze.from(a,"base64");if(ae[t].match(/^RSA-/)){var n=i.readUInt8(0);if(n!=3&&n!=1)throw new Error("Cannot parse dnssec key: unsupported exponent length");var s=i.slice(1,n+1);s=K.mpNormalize(s);var f=i.slice(1+n);f=K.mpNormalize(f);var o={type:"rsa",parts:[]};return o.parts.push({name:"e",data:s}),o.parts.push({name:"n",data:f}),new Ft(o)}if(ae[t]==="ECDSA-P384-SHA384"||ae[t]==="ECDSA-P256-SHA256"){var u="nistp384",c=384;ae[t].match(/^ECDSA-P256-SHA256/)&&(u="nistp256",c=256);var l={type:"ecdsa",curve:u,size:c,parts:[{name:"curve",data:Ze.from(u)},{name:"Q",data:K.ecNormalize(i)}]};return new Ft(l)}throw new Error("Unsupported algorithm: "+ae[t])}function ze(e){return Ze.from(e.split(" ")[1],"base64")}function Ts(e){var r={};e.forEach(function(a){a.split(" ")[0]==="Modulus:"?r.n=ze(a):a.split(" ")[0]==="PublicExponent:"?r.e=ze(a):a.split(" ")[0]==="PrivateExponent:"?r.d=ze(a):a.split(" ")[0]==="Prime1:"?r.p=ze(a):a.split(" ")[0]==="Prime2:"?r.q=ze(a):a.split(" ")[0]==="Exponent1:"?r.dmodp=ze(a):a.split(" ")[0]==="Exponent2:"?r.dmodq=ze(a):a.split(" ")[0]==="Coefficient:"&&(r.iqmp=ze(a))});var t={type:"rsa",parts:[{name:"e",data:K.mpNormalize(r.e)},{name:"n",data:K.mpNormalize(r.n)},{name:"d",data:K.mpNormalize(r.d)},{name:"p",data:K.mpNormalize(r.p)},{name:"q",data:K.mpNormalize(r.q)},{name:"dmodp",data:K.mpNormalize(r.dmodp)},{name:"dmodq",data:K.mpNormalize(r.dmodq)},{name:"iqmp",data:K.mpNormalize(r.iqmp)}]};return new At(t)}function Us(e,r){if(ae[e].match(/^RSA-/))return Ts(r);if(ae[e]==="ECDSA-P384-SHA384"||ae[e]==="ECDSA-P256-SHA256"){var t=Ze.from(r[0].split(" ")[1],"base64"),a="nistp384",i=384;ae[e]==="ECDSA-P256-SHA256"&&(a="nistp256",i=256);var n=K.publicFromPrivateECDSA(a,t),s=n.part.Q.data,f={type:"ecdsa",curve:a,size:i,parts:[{name:"curve",data:Ze.from(a)},{name:"d",data:t},{name:"Q",data:s}]};return new At(f)}throw new Error("Unsupported algorithm: "+ae[e])}function cr(e){var r=e.getFullYear()+"",t=e.getMonth()+1,a=r+t+e.getUTCDate();return a+=""+e.getUTCHours()+e.getUTCMinutes(),a+=e.getUTCSeconds(),a}function Ns(e){if(!e||!e.hashAlgo||e.hashAlgo==="sha1")return"5 (RSASHA1)";if(e.hashAlgo==="sha256")return"8 (RSASHA256)";if(e.hashAlgo==="sha512")return"10 (RSASHA512)";throw new Error("Unknown or unsupported hash: "+e.hashAlgo)}function zs(e,r){(!e.part.dmodp||!e.part.dmodq)&&K.addRSAMissing(e);var t="";t+=`Private-key-format: v1.3
`,t+="Algorithm: "+Ns(r)+`
`;var a=K.mpDenormalize(e.part.n.data);t+="Modulus: "+a.toString("base64")+`
`;var i=K.mpDenormalize(e.part.e.data);t+="PublicExponent: "+i.toString("base64")+`
`;var n=K.mpDenormalize(e.part.d.data);t+="PrivateExponent: "+n.toString("base64")+`
`;var s=K.mpDenormalize(e.part.p.data);t+="Prime1: "+s.toString("base64")+`
`;var f=K.mpDenormalize(e.part.q.data);t+="Prime2: "+f.toString("base64")+`
`;var o=K.mpDenormalize(e.part.dmodp.data);t+="Exponent1: "+o.toString("base64")+`
`;var u=K.mpDenormalize(e.part.dmodq.data);t+="Exponent2: "+u.toString("base64")+`
`;var c=K.mpDenormalize(e.part.iqmp.data);t+="Coefficient: "+c.toString("base64")+`
`;var l=new Date;return t+="Created: "+cr(l)+`
`,t+="Publish: "+cr(l)+`
`,t+="Activate: "+cr(l)+`
`,Ze.from(t,"ascii")}function Hs(e,r){var t="";if(t+=`Private-key-format: v1.3
`,e.curve==="nistp256")t+=`Algorithm: 13 (ECDSAP256SHA256)
`;else if(e.curve==="nistp384")t+=`Algorithm: 14 (ECDSAP384SHA384)
`;else throw new Error("Unsupported curve");var a=e.part.d.data.toString("base64");t+="PrivateKey: "+a+`
`;var i=new Date;return t+="Created: "+cr(i)+`
`,t+="Publish: "+cr(i)+`
`,t+="Activate: "+cr(i)+`
`,Ze.from(t,"ascii")}function js(e,r){if(At.isPrivateKey(e)){if(e.type==="rsa")return zs(e,r);if(e.type==="ecdsa")return Hs(e,r);throw new Error("Unsupported algorithm: "+e.type)}else throw Ft.isKey(e)?new Error('Format "dnssec" only supports writing private keys'):new Error("key is not a Key or PrivateKey")}});var Lr=P((nu,Ta)=>{Ta.exports={read:Qs,write:Gs};var Ar=h("assert-plus"),fe=h("safer-buffer").Buffer,jr=xe(),Ls=H(),Rs=Ye(),kt=h("crypto"),Oa=z(),Ms=he();function Qs(e,r){for(var t=e.toString("ascii").split(/[\r\n]+/),a=!1,i,n=0,s;n<t.length;)if(i=Fr(t[n++]),i&&(s={"putty-user-key-file-2":2,"putty-user-key-file-3":3}[i[0].toLowerCase()],s)){a=!0;break}if(!a)throw new Error("No PuTTY format first line found");var f=i[1];i=Fr(t[n++]),Ar.equal(i[0].toLowerCase(),"encryption");var o=i[1];i=Fr(t[n++]),Ar.equal(i[0].toLowerCase(),"comment");var u=i[1];i=Fr(t[n++]),Ar.equal(i[0].toLowerCase(),"public-lines");var c=parseInt(i[1],10);if(!isFinite(c)||c<0||c>t.length)throw new Error("Invalid public-lines count");var l=fe.from(t.slice(n,n+c).join(""),"base64"),g=jr.algToKeyType(f),d=jr.read(l);if(d.type!==g)throw new Error("Outer key algorithm mismatch");if(n+=c,t[n]){i=Fr(t[n++]),Ar.equal(i[0].toLowerCase(),"private-lines");var v=parseInt(i[1],10);if(!isFinite(v)||v<0||v>t.length)throw new Error("Invalid private-lines count");var q=fe.from(t.slice(n,n+v).join(""),"base64");if(o!=="none"&&s===3)throw new Error("Encrypted keys arenot supported for PuTTY format version 3");if(o==="aes256-cbc"){if(!r.passphrase)throw new Ms.KeyEncryptedError(r.filename,"PEM");var m=fe.alloc(16,0),Y=kt.createDecipheriv("aes-256-cbc",Ys(r.passphrase),m);Y.setAutoPadding(!1),q=fe.concat([Y.update(q),Y.final()])}if(d=new Oa(d),d.type!==g)throw new Error("Outer key algorithm mismatch");var w=new Rs({buffer:q}),_;if(f==="ssh-dss")_=[{name:"x",data:w.readBuffer()}];else if(f==="ssh-rsa")_=[{name:"d",data:w.readBuffer()},{name:"p",data:w.readBuffer()},{name:"q",data:w.readBuffer()},{name:"iqmp",data:w.readBuffer()}];else if(f.match(/^ecdsa-sha2-nistp/))_=[{name:"d",data:w.readBuffer()}];else if(f==="ssh-ed25519")_=[{name:"k",data:w.readBuffer()}];else throw new Error("Unsupported PPK key type: "+f);d=new Oa({type:d.type,parts:d.parts.concat(_)})}return d.comment=u,d}function Ys(e){var r=kt.createHash("sha1").update(fe.concat([fe.from([0,0,0,0]),fe.from(e)])).digest(),t=kt.createHash("sha1").update(fe.concat([fe.from([0,0,0,1]),fe.from(e)])).digest();return fe.concat([r,t]).slice(0,32)}function Fr(e){var r=e.indexOf(":");if(r===-1)return null;var t=e.slice(0,r);for(++r;e[r]===" ";)++r;var a=e.slice(r);return[t,a]}function Gs(e,r){if(Ar.object(e),!Ls.isKey(e))throw new Error("Must be a public key");var t=jr.keyTypeToAlg(e),a=jr.write(e),i=e.comment||"",n=a.toString("base64"),s=Vs(n,64);return s.unshift("Public-Lines: "+s.length),s.unshift("Comment: "+i),s.unshift("Encryption: none"),s.unshift("PuTTY-User-Key-File-2: "+t),fe.from(s.join(`
`)+`
`)}function Vs(e,r){for(var t=[],a=0;a<e.length;)t.push(e.slice(a,a+64)),a+=64;return t}});var _t=P((uu,ja)=>{ja.exports={read:$s,write:tf};var Zs=h("assert-plus"),Ws=h("safer-buffer").Buffer,su=N(),fu=H(),ou=z(),Ua=Ce(),It=Pt(),Xs=xe(),Na=Hr(),za=Lr(),Ct="Private-key-format: v1";function $s(e,r){if(typeof e=="string"){if(e.trim().match(/^[-]+[ ]*BEGIN/))return Ua.read(e,r);if(e.match(/^\s*ssh-[a-z]/)||e.match(/^\s*ecdsa-/))return It.read(e,r);if(e.match(/^putty-user-key-file-2:/i))return za.read(e,r);if(Ha(e))return Na.read(e,r);e=Ws.from(e,"binary")}else{if(Zs.buffer(e),rf(e))return Ua.read(e,r);if(ef(e))return It.read(e,r);if(Js(e))return za.read(e,r);if(Ha(e))return Na.read(e,r)}if(e.readUInt32BE(0)<e.length)return Xs.read(e,r);throw new Error("Failed to auto-detect format of key")}function Js(e){for(var r=0;r<e.length&&(e[r]===32||e[r]===10||e[r]===9);)++r;return r+22<=e.length&&e.slice(r,r+22).toString("ascii").toLowerCase()==="putty-user-key-file-2:"}function ef(e){for(var r=0;r<e.length&&(e[r]===32||e[r]===10||e[r]===9);)++r;return r+4<=e.length&&e.slice(r,r+4).toString("ascii")==="ssh-"||r+6<=e.length&&e.slice(r,r+6).toString("ascii")==="ecdsa-"}function rf(e){for(var r=0;r<e.length&&(e[r]===32||e[r]===10);)++r;if(e[r]!==45)return!1;for(;r<e.length&&e[r]===45;)++r;for(;r<e.length&&e[r]===32;)++r;return!(r+5>e.length||e.slice(r,r+5).toString("ascii")!=="BEGIN")}function Ha(e){if(e.length<=Ct.length)return!1;var r=e.slice(0,Ct.length);if(r.toString("ascii")===Ct)return!0;typeof e!="string"&&(e=e.toString("ascii"));for(var t=e.split(`
`),a=0;t[a].match(/^\;/);)a++;return!!(t[a].toString("ascii").match(/\. IN KEY /)||t[a].toString("ascii").match(/\. IN DNSKEY /))}function tf(e,r){throw new Error('"auto" format cannot be used for writing')}});var z=P((lu,Ya)=>{Ya.exports=j;var M=h("assert-plus"),xt=h("safer-buffer").Buffer,af=R(),La=h("crypto"),cu=hr(),nf=Be(),Dt=he(),sf=h("util"),kr=N(),Qa=Dr(),ff=Qa.generateECDSA,of=Qa.generateED25519,Ra=vt(),Ma=h("tweetnacl"),Kt=H(),hu=Dt.InvalidAlgorithmError,uf=Dt.KeyParseError,pu=Dt.KeyEncryptedError,Q={};Q.auto=_t();Q.pem=Ce();Q.pkcs1=Tr();Q.pkcs8=ar();Q.rfc4253=xe();Q["ssh-private"]=Er();Q.openssh=Q["ssh-private"];Q.ssh=Q["ssh-private"];Q.dnssec=Hr();Q.putty=Lr();function j(e){M.object(e,"options"),Kt.call(this,e),this._pubCache=void 0}sf.inherits(j,Kt);j.formats=Q;j.prototype.toBuffer=function(e,r){return e===void 0&&(e="pkcs1"),M.string(e,"format"),M.object(Q[e],"formats[format]"),M.optionalObject(r,"options"),Q[e].write(this,r)};j.prototype.hash=function(e,r){return this.toPublic().hash(e,r)};j.prototype.fingerprint=function(e,r){return this.toPublic().fingerprint(e,r)};j.prototype.toPublic=function(){if(this._pubCache)return this._pubCache;for(var e=af.info[this.type],r=[],t=0;t<e.parts.length;++t){var a=e.parts[t];r.push(this.part[a])}return this._pubCache=new Kt({type:this.type,source:this,parts:r}),this.comment&&(this._pubCache.comment=this.comment),this._pubCache};j.prototype.derive=function(e){M.string(e,"type");var r,t,a;if(this.type==="ed25519"&&e==="curve25519")return r=this.part.k.data,r[0]===0&&(r=r.slice(1)),a=Ma.box.keyPair.fromSecretKey(new Uint8Array(r)),t=xt.from(a.publicKey),new j({type:"curve25519",parts:[{name:"A",data:kr.mpNormalize(t)},{name:"k",data:kr.mpNormalize(r)}]});if(this.type==="curve25519"&&e==="ed25519")return r=this.part.k.data,r[0]===0&&(r=r.slice(1)),a=Ma.sign.keyPair.fromSeed(new Uint8Array(r)),t=xt.from(a.publicKey),new j({type:"ed25519",parts:[{name:"A",data:kr.mpNormalize(t)},{name:"k",data:kr.mpNormalize(r)}]});throw new Error("Key derivation not supported from "+this.type+" to "+e)};j.prototype.createVerify=function(e){return this.toPublic().createVerify(e)};j.prototype.createSign=function(e){if(e===void 0&&(e=this.defaultHashAlgorithm()),M.string(e,"hash algorithm"),this.type==="ed25519"&&Ra!==void 0)return new Ra.Signer(this,e);if(this.type==="curve25519")throw new Error("Curve25519 keys are not suitable for signing or verification");var r,t,a;try{t=e.toUpperCase(),r=La.createSign(t)}catch(o){a=o}(r===void 0||a instanceof Error&&a.message.match(/Unknown message digest/))&&(t="RSA-",t+=e.toUpperCase(),r=La.createSign(t)),M.ok(r,"failed to create verifier");var i=r.sign.bind(r),n=this.toBuffer("pkcs1"),s=this.type,f=this.curve;return r.sign=function(){var o=i(n);return typeof o=="string"&&(o=xt.from(o,"binary")),o=nf.parse(o,s,"asn1"),o.hashAlgorithm=e,o.curve=f,o},r};j.parse=function(e,r,t){typeof e!="string"&&M.buffer(e,"data"),r===void 0&&(r="auto"),M.string(r,"format"),typeof t=="string"&&(t={filename:t}),M.optionalObject(t,"options"),t===void 0&&(t={}),M.optionalString(t.filename,"options.filename"),t.filename===void 0&&(t.filename="(unnamed)"),M.object(Q[r],"formats[format]");try{var a=Q[r].read(e,t);return M.ok(a instanceof j,"key is not a private key"),a.comment||(a.comment=t.filename),a}catch(i){throw i.name==="KeyEncryptedError"?i:new uf(t.filename,r,i)}};j.isPrivateKey=function(e,r){return kr.isCompatible(e,j,r)};j.generate=function(e,r){switch(r===void 0&&(r={}),M.object(r,"options"),e){case"ecdsa":return r.curve===void 0&&(r.curve="nistp256"),M.string(r.curve,"options.curve"),ff(r.curve);case"ed25519":return of();default:throw new Error('Key generation not supported with key type "'+e+'"')}};j.prototype._sshpkApiVersion=[1,6];j._oldVersionDetect=function(e){return M.func(e.toPublic),M.func(e.createSign),e.derive?[1,3]:e.defaultHashAlgorithm?[1,2]:e.formats.auto?[1,1]:[1,0]}});var pr=P((Su,Wa)=>{Wa.exports=k;var de=h("assert-plus"),vu=R(),du=h("crypto"),gu=hr(),mu=Be(),wu=he(),yu=h("util"),cf=N(),V=h("asn1"),Va=h("safer-buffer").Buffer,Ga=/^([*]|[a-z0-9][a-z0-9\-]{0,62})(?:\.([*]|[a-z0-9][a-z0-9\-]{0,62}))*$/i,F={};F.cn="2.5.4.3";F.o="2.5.4.10";F.ou="2.5.4.11";F.l="2.5.4.7";F.s="2.5.4.8";F.c="2.5.4.6";F.sn="2.5.4.4";F.postalCode="2.5.4.17";F.serialNumber="2.5.4.5";F.street="2.5.4.9";F.x500UniqueIdentifier="2.5.4.45";F.role="2.5.4.72";F.telephoneNumber="2.5.4.20";F.description="2.5.4.13";F.dc="0.9.2342.19200300.100.1.25";F.uid="0.9.2342.19200300.100.1.1";F.mail="0.9.2342.19200300.100.1.3";F.title="2.5.4.12";F.gn="2.5.4.42";F.initials="2.5.4.43";F.pseudonym="2.5.4.65";F.emailAddress="1.2.840.113549.1.9.1";var Za={};Object.keys(F).forEach(function(e){Za[F[e]]=e});function k(e){var r=this;if(de.object(e,"options"),de.arrayOfObject(e.components,"options.components"),this.components=e.components,this.componentLookup={},this.components.forEach(function(t){t.name&&!t.oid&&(t.oid=F[t.name]),t.oid&&!t.name&&(t.name=Za[t.oid]),r.componentLookup[t.name]===void 0&&(r.componentLookup[t.name]=[]),r.componentLookup[t.name].push(t)}),this.componentLookup.cn&&this.componentLookup.cn.length>0&&(this.cn=this.componentLookup.cn[0].value),de.optionalString(e.type,"options.type"),e.type===void 0)this.components.length===1&&this.componentLookup.cn&&this.componentLookup.cn.length===1&&this.componentLookup.cn[0].value.match(Ga)?(this.type="host",this.hostname=this.componentLookup.cn[0].value):this.componentLookup.dc&&this.components.length===this.componentLookup.dc.length?(this.type="host",this.hostname=this.componentLookup.dc.map(function(t){return t.value}).join(".")):this.componentLookup.uid&&this.components.length===this.componentLookup.uid.length?(this.type="user",this.uid=this.componentLookup.uid[0].value):this.componentLookup.cn&&this.componentLookup.cn.length===1&&this.componentLookup.cn[0].value.match(Ga)?(this.type="host",this.hostname=this.componentLookup.cn[0].value):this.componentLookup.uid&&this.componentLookup.uid.length===1?(this.type="user",this.uid=this.componentLookup.uid[0].value):this.componentLookup.mail&&this.componentLookup.mail.length===1?(this.type="email",this.email=this.componentLookup.mail[0].value):this.componentLookup.cn&&this.componentLookup.cn.length===1?(this.type="user",this.uid=this.componentLookup.cn[0].value):this.type="unknown";else if(this.type=e.type,this.type==="host")this.hostname=e.hostname;else if(this.type==="user")this.uid=e.uid;else if(this.type==="email")this.email=e.email;else throw new Error("Unknown type "+this.type)}k.prototype.toString=function(){return this.components.map(function(e){var r=e.name.toUpperCase();r=r.replace(/=/g,"\\=");var t=e.value;return t=t.replace(/,/g,"\\,"),r+"="+t}).join(", ")};k.prototype.get=function(e,r){de.string(e,"name");var t=this.componentLookup[e];if(!(t===void 0||t.length===0)){if(!r&&t.length>1)throw new Error("Multiple values for attribute "+e);return r?t.map(function(a){return a.value}):t[0].value}};k.prototype.toArray=function(e){return this.components.map(function(r){return{name:r.name,value:r.value}})};var hf=/[^a-zA-Z0-9 '(),+.\/:=?-]/,pf=/[^\x00-\x7f]/;k.prototype.toAsn1=function(e,r){e.startSequence(r),this.components.forEach(function(t){if(e.startSequence(V.Ber.Constructor|V.Ber.Set),e.startSequence(),e.writeOID(t.oid),t.asn1type===V.Ber.Utf8String||t.value.match(pf)){var a=Va.from(t.value,"utf8");e.writeBuffer(a,V.Ber.Utf8String)}else if(t.asn1type===V.Ber.IA5String||t.value.match(hf))e.writeString(t.value,V.Ber.IA5String);else{var i=V.Ber.PrintableString;t.asn1type!==void 0&&(i=t.asn1type),e.writeString(t.value,i)}e.endSequence(),e.endSequence()}),e.endSequence()};function lf(e,r){if(e==="**"||r==="**")return!0;var t=e.split("."),a=r.split(".");if(t.length!==a.length)return!1;for(var i=0;i<t.length;++i)if(!(t[i]==="*"||a[i]==="*")&&t[i]!==a[i])return!1;return!0}k.prototype.equals=function(e){if(!k.isIdentity(e,[1,0])||e.components.length!==this.components.length)return!1;for(var r=0;r<this.components.length;++r)if(this.components[r].oid!==e.components[r].oid||!lf(this.components[r].value,e.components[r].value))return!1;return!0};k.forHost=function(e){return de.string(e,"hostname"),new k({type:"host",hostname:e,components:[{name:"cn",value:e}]})};k.forUser=function(e){return de.string(e,"uid"),new k({type:"user",uid:e,components:[{name:"uid",value:e}]})};k.forEmail=function(e){return de.string(e,"email"),new k({type:"email",email:e,components:[{name:"mail",value:e}]})};k.parseDN=function(e){de.string(e,"dn");for(var r=[""],t=0,a=e;a.length>0;){var i;if((i=/^,/.exec(a))!==null)r[++t]="",a=a.slice(i[0].length);else if((i=/^\\,/.exec(a))!==null)r[t]+=",",a=a.slice(i[0].length);else if((i=/^\\./.exec(a))!==null)r[t]+=i[0],a=a.slice(i[0].length);else if((i=/^[^\\,]+/.exec(a))!==null)r[t]+=i[0],a=a.slice(i[0].length);else throw new Error("Failed to parse DN")}var n=r.map(function(s){s=s.trim();for(var f=s.indexOf("=");f>0&&s.charAt(f-1)==="\\";)f=s.indexOf("=",f+1);if(f===-1)throw new Error("Failed to parse DN");var o=s.slice(0,f).toLowerCase().replace(/\\=/g,"="),u=s.slice(f+1);return{name:o,value:u}});return new k({components:n})};k.fromArray=function(e){return de.arrayOfObject(e,"components"),e.forEach(function(r){if(de.object(r,"component"),de.string(r.name,"component.name"),!Va.isBuffer(r.value)&&typeof r.value!="string")throw new Error("Invalid component value")}),new k({components:e})};k.parseAsn1=function(e,r){var t=[];e.readSequence(r);for(var a=e.offset+e.length;e.offset<a;){e.readSequence(V.Ber.Constructor|V.Ber.Set);var i=e.offset+e.length;e.readSequence();var n=e.readOID(),s=e.peek(),f;switch(s){case V.Ber.PrintableString:case V.Ber.IA5String:case V.Ber.OctetString:case V.Ber.T61String:f=e.readString(s);break;case V.Ber.Utf8String:f=e.readString(s,!0),f=f.toString("utf8");break;case V.Ber.CharacterString:case V.Ber.BMPString:f=e.readString(s,!0),f=f.toString("utf16le");break;default:throw new Error("Unknown asn1 type "+s)}t.push({oid:n,asn1type:s,value:f}),e._offset=i}return e._offset=a,new k({components:t})};k.isIdentity=function(e,r){return cf.isCompatible(e,k,r)};k.prototype._sshpkApiVersion=[1,0];k._oldVersionDetect=function(e){return[1,0]}});var ii=P((Bu,ai)=>{ai.exports={read:Sf,verify:yf,sign:qf,signAsync:Bf,write:bf,fromBuffer:ri,toBuffer:Mr};var We=h("assert-plus"),He=Ye(),vf=h("crypto"),Rr=h("safer-buffer").Buffer,Tt=R(),df=H(),qu=z(),Ot=pr(),Ja=xe(),gf=Be(),mf=N(),wf=lr();function yf(e,r){return!1}var Xe={user:1,host:2};Object.keys(Xe).forEach(function(e){Xe[Xe[e]]=e});var ei=/^ecdsa-sha2-([^@-]+)-cert-v01@openssh.com$/;function Sf(e,r){Rr.isBuffer(e)&&(e=e.toString("ascii"));var t=e.trim().split(/[ \t\n]+/g);if(t.length<2||t.length>3)throw new Error("Not a valid SSH certificate line");var a=t[0],i=t[1];return i=Rr.from(i,"base64"),ri(i,a)}function ri(e,r,t){var a=new He({buffer:e}),i=a.readString();if(r!==void 0&&i!==r)throw new Error("SSH certificate algorithm mismatch");r===void 0&&(r=i);var n={};n.signatures={},n.signatures.openssh={},n.signatures.openssh.nonce=a.readBuffer();var s={},f=s.parts=[];s.type=Ef(r);for(var o=Tt.info[s.type].parts.length;f.length<o;)f.push(a.readPart());We.ok(f.length>=1,"key must have at least one part");var u=Tt.info[s.type];if(s.type==="ecdsa"){var c=ei.exec(r);We.ok(c!==null),We.strictEqual(c[1],f[0].data.toString())}for(var l=0;l<u.parts.length;++l)if(f[l].name=u.parts[l],f[l].name!=="curve"&&u.normalize!==!1){var g=f[l];g.data=mf.mpNormalize(g.data)}n.subjectKey=new df(s),n.serial=a.readInt64();var d=Xe[a.readInt()];We.string(d,"valid cert type"),n.signatures.openssh.keyId=a.readString();for(var v=[],q=a.readBuffer(),m=new He({buffer:q});!m.atEnd();)v.push(m.readString());v.length===0&&(v=["*"]),n.subjects=v.map(function(we){if(d==="user")return Ot.forUser(we);if(d==="host")return Ot.forHost(we);throw new Error("Unknown identity type "+d)}),n.validFrom=Xa(a.readInt64()),n.validUntil=Xa(a.readInt64());for(var Y=[],w=new He({buffer:a.readBuffer()}),_;!w.atEnd();)_={critical:!0},_.name=w.readString(),_.data=w.readBuffer(),Y.push(_);for(w=new He({buffer:a.readBuffer()});!w.atEnd();)_={critical:!1},_.name=w.readString(),_.data=w.readBuffer(),Y.push(_);n.signatures.openssh.exts=Y,a.readBuffer();var G=a.readBuffer();n.issuerKey=Ja.read(G),n.issuer=Ot.forHost("**");var ke=a.readBuffer();return n.signatures.openssh.signature=gf.parse(ke,n.issuerKey.type,"ssh"),t!==void 0&&(t.remainder=a.remainder(),t.consumed=a._offset),new wf(n)}function Xa(e){var r=e.readUInt32BE(0)*4294967296;r+=e.readUInt32BE(4);var t=new Date;return t.setTime(r*1e3),t.sourceInt64=e,t}function $a(e){if(e.sourceInt64!==void 0)return e.sourceInt64;var r=Math.round(e.getTime()/1e3),t=Math.floor(r/4294967296),a=Math.floor(r%4294967296),i=Rr.alloc(8);return i.writeUInt32BE(t,0),i.writeUInt32BE(a,4),i}function qf(e,r){e.signatures.openssh===void 0&&(e.signatures.openssh={});try{var t=Mr(e,!0)}catch{return delete e.signatures.openssh,!1}var a=e.signatures.openssh,i=void 0;(r.type==="rsa"||r.type==="dsa")&&(i="sha1");var n=r.createSign(i);return n.write(t),a.signature=n.sign(),!0}function Bf(e,r,t){e.signatures.openssh===void 0&&(e.signatures.openssh={});try{var a=Mr(e,!0)}catch(n){delete e.signatures.openssh,t(n);return}var i=e.signatures.openssh;r(a,function(n,s){if(n){t(n);return}try{s.toBuffer("ssh")}catch(f){t(f);return}i.signature=s,t()})}function bf(e,r){r===void 0&&(r={});var t=Mr(e),a=ti(e.subjectKey)+" "+t.toString("base64");return r.comment&&(a=a+" "+r.comment),a}function Mr(e,r){We.object(e.signatures.openssh,"signature for openssh format");var t=e.signatures.openssh;t.nonce===void 0&&(t.nonce=vf.randomBytes(16));var a=new He({});a.writeString(ti(e.subjectKey)),a.writeBuffer(t.nonce);var i=e.subjectKey,n=Tt.info[i.type];n.parts.forEach(function(c){a.writePart(i.part[c])}),a.writeInt64(e.serial);var s=e.subjects[0].type;We.notStrictEqual(s,"unknown"),e.subjects.forEach(function(c){We.strictEqual(c.type,s)}),s=Xe[s],a.writeInt(s),t.keyId===void 0&&(t.keyId=e.subjects[0].type+"_"+(e.subjects[0].uid||e.subjects[0].hostname)),a.writeString(t.keyId);var f=new He({});e.subjects.forEach(function(c){s===Xe.host?f.writeString(c.hostname):s===Xe.user&&f.writeString(c.uid)}),a.writeBuffer(f.toBuffer()),a.writeInt64($a(e.validFrom)),a.writeInt64($a(e.validUntil));var o=t.exts;o===void 0&&(o=[]);var u=new He({});return o.forEach(function(c){c.critical===!0&&(u.writeString(c.name),u.writeBuffer(c.data))}),a.writeBuffer(u.toBuffer()),u=new He({}),o.forEach(function(c){c.critical!==!0&&(u.writeString(c.name),u.writeBuffer(c.data))}),a.writeBuffer(u.toBuffer()),a.writeBuffer(Rr.alloc(0)),f=Ja.write(e.issuerKey),a.writeBuffer(f),r||a.writeBuffer(t.signature.toBuffer("ssh")),a.toBuffer()}function Ef(e){if(e==="ssh-rsa-cert-v01@openssh.com")return"rsa";if(e==="ssh-dss-cert-v01@openssh.com")return"dsa";if(e.match(ei))return"ecdsa";if(e==="ssh-ed25519-cert-v01@openssh.com")return"ed25519";throw new Error("Unsupported cert type "+e)}function ti(e){if(e.type==="rsa")return"ssh-rsa-cert-v01@openssh.com";if(e.type==="dsa")return"ssh-dss-cert-v01@openssh.com";if(e.type==="ecdsa")return"ecdsa-sha2-"+e.curve+"-cert-v01@openssh.com";if(e.type==="ed25519")return"ssh-ed25519-cert-v01@openssh.com";throw new Error("Unsupported key type "+e.type)}});var zt=P((Au,ci)=>{ci.exports={read:If,verify:kf,sign:Uf,signAsync:Nf,write:zf};var Ae=h("assert-plus"),y=h("asn1"),Nt=h("safer-buffer").Buffer,bu=R(),fi=N(),Eu=H(),Pu=z(),Fu=Ce(),Ir=pr(),Pf=Be(),Ff=lr(),oi=ar();function Af(e,r){return Ae.strictEqual(e.peek(),y.Ber.Integer,r+" is not an Integer"),fi.mpNormalize(e.readString(y.Ber.Integer,!0))}function kf(e,r){var t=e.signatures.x509;Ae.object(t,"x509 signature");var a=t.algo.split("-");if(a[0]!==r.type)return!1;var i=t.cache;if(i===void 0){var n=new y.BerWriter;Yr(e,n),i=n.buffer}var s=r.createVerify(a[1]);return s.write(i),s.verify(t.signature)}function Z(e){return y.Ber.Context|y.Ber.Constructor|e}function vr(e){return y.Ber.Context|e}var ge={"rsa-md5":"1.2.840.113549.1.1.4","rsa-sha1":"1.2.840.113549.1.1.5","rsa-sha256":"1.2.840.113549.1.1.11","rsa-sha384":"1.2.840.113549.1.1.12","rsa-sha512":"1.2.840.113549.1.1.13","dsa-sha1":"1.2.840.10040.4.3","dsa-sha256":"2.16.840.1.101.3.4.3.2","ecdsa-sha1":"1.2.840.10045.4.1","ecdsa-sha256":"1.2.840.10045.4.3.2","ecdsa-sha384":"1.2.840.10045.4.3.3","ecdsa-sha512":"1.2.840.10045.4.3.4","ed25519-sha512":"1.3.101.112"};Object.keys(ge).forEach(function(e){ge[ge[e]]=e});ge["1.3.14.3.2.3"]="rsa-md5";ge["1.3.14.3.2.29"]="rsa-sha1";var oe={issuerKeyId:"2.5.29.35",altName:"2.5.29.17",basicConstraints:"2.5.29.19",keyUsage:"2.5.29.15",extKeyUsage:"2.5.29.37"};function If(e,r){typeof e=="string"&&(e=Nt.from(e,"binary")),Ae.buffer(e,"buf");var t=new y.BerReader(e);if(t.readSequence(),Math.abs(t.length-t.remain)>1)throw new Error("DER sequence does not contain whole byte stream");var a=t.offset;t.readSequence();var i=t.offset+t.length,n=i;if(t.peek()===Z(0)){t.readSequence(Z(0));var s=t.readInt();Ae.ok(s<=3,"only x.509 versions up to v3 supported")}var f={};f.signatures={};var o=f.signatures.x509={};o.extras={},f.serial=Af(t,"serial"),t.readSequence();var u=t.offset+t.length,c=t.readOID(),l=ge[c];if(l===void 0)throw new Error("unknown signature algorithm "+c);if(t._offset=u,f.issuer=Ir.parseAsn1(t),t.readSequence(),f.validFrom=ni(t),f.validUntil=ni(t),f.subjects=[Ir.parseAsn1(t)],t.readSequence(),u=t.offset+t.length,f.subjectKey=oi.readPkcs8(void 0,"public",t),t._offset=u,t.peek()===Z(1)&&(t.readSequence(Z(1)),o.extras.issuerUniqueID=e.slice(t.offset,t.offset+t.length),t._offset+=t.length),t.peek()===Z(2)&&(t.readSequence(Z(2)),o.extras.subjectUniqueID=e.slice(t.offset,t.offset+t.length),t._offset+=t.length),t.peek()===Z(3)){t.readSequence(Z(3));var g=t.offset+t.length;for(t.readSequence();t.offset<g;)Cf(f,e,t);Ae.strictEqual(t.offset,g)}Ae.strictEqual(t.offset,i),t.readSequence(),u=t.offset+t.length;var d=t.readOID(),v=ge[d];if(v===void 0)throw new Error("unknown signature algorithm "+d);t._offset=u;var q=t.readString(y.Ber.BitString,!0);q[0]===0&&(q=q.slice(1));var m=v.split("-");return o.signature=Pf.parse(q,m[0],"asn1"),o.signature.hashAlgorithm=m[1],o.algo=v,o.cache=e.slice(a,n),new Ff(f)}function ni(e){if(e.peek()===y.Ber.UTCTime)return xf(e.readString(y.Ber.UTCTime));if(e.peek()===y.Ber.GeneralizedTime)return Kf(e.readString(y.Ber.GeneralizedTime));throw new Error("Unsupported date format")}function si(e,r){r.getUTCFullYear()>=2050||r.getUTCFullYear()<1950?e.writeString(Tf(r),y.Ber.GeneralizedTime):e.writeString(Of(r),y.Ber.UTCTime)}var ie={OtherName:Z(0),RFC822Name:vr(1),DNSName:vr(2),X400Address:Z(3),DirectoryName:Z(4),EDIPartyName:Z(5),URI:vr(6),IPAddress:vr(7),OID:vr(8)},Qr={serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",joyentDocker:"1.3.6.1.4.1.38678.1.4.1",joyentCmon:"1.3.6.1.4.1.38678.1.4.2"},ui={};Object.keys(Qr).forEach(function(e){ui[Qr[e]]=e});var Ut=["signature","identity","keyEncryption","encryption","keyAgreement","ca","crl"];function Cf(e,r,t){t.readSequence();var a=t.offset+t.length,i=t.readOID(),n,s=e.signatures.x509;s.extras.exts||(s.extras.exts=[]);var f;switch(t.peek()===y.Ber.Boolean&&(f=t.readBoolean()),i){case oe.basicConstraints:t.readSequence(y.Ber.OctetString),t.readSequence();var o=t.offset+t.length,u=!1;t.peek()===y.Ber.Boolean&&(u=t.readBoolean()),e.purposes===void 0&&(e.purposes=[]),u===!0&&e.purposes.push("ca");var c={oid:i,critical:f};t.offset<o&&t.peek()===y.Ber.Integer&&(c.pathLen=t.readInt()),s.extras.exts.push(c);break;case oe.extKeyUsage:t.readSequence(y.Ber.OctetString),t.readSequence(),e.purposes===void 0&&(e.purposes=[]);for(var l=t.offset+t.length;t.offset<l;){var g=t.readOID();e.purposes.push(ui[g]||g)}e.purposes.indexOf("serverAuth")!==-1&&e.purposes.indexOf("clientAuth")===-1?e.subjects.forEach(function(w){w.type!=="host"&&(w.type="host",w.hostname=w.uid||w.email||w.components[0].value)}):e.purposes.indexOf("clientAuth")!==-1&&e.purposes.indexOf("serverAuth")===-1&&e.subjects.forEach(function(w){w.type!=="user"&&(w.type="user",w.uid=w.hostname||w.email||w.components[0].value)}),s.extras.exts.push({oid:i,critical:f});break;case oe.keyUsage:t.readSequence(y.Ber.OctetString);var d=t.readString(y.Ber.BitString,!0),v=Hf(d,Ut);v.forEach(function(w){e.purposes===void 0&&(e.purposes=[]),e.purposes.indexOf(w)===-1&&e.purposes.push(w)}),s.extras.exts.push({oid:i,critical:f,bits:d});break;case oe.altName:t.readSequence(y.Ber.OctetString),t.readSequence();for(var q=t.offset+t.length;t.offset<q;)switch(t.peek()){case ie.OtherName:case ie.EDIPartyName:t.readSequence(),t._offset+=t.length;break;case ie.OID:t.readOID(ie.OID);break;case ie.RFC822Name:var m=t.readString(ie.RFC822Name);n=Ir.forEmail(m),e.subjects[0].equals(n)||e.subjects.push(n);break;case ie.DirectoryName:t.readSequence(ie.DirectoryName),n=Ir.parseAsn1(t),e.subjects[0].equals(n)||e.subjects.push(n);break;case ie.DNSName:var Y=t.readString(ie.DNSName);n=Ir.forHost(Y),e.subjects[0].equals(n)||e.subjects.push(n);break;default:t.readString(t.peek());break}s.extras.exts.push({oid:i,critical:f});break;default:s.extras.exts.push({oid:i,critical:f,data:t.readString(y.Ber.OctetString,!0)});break}t._offset=a}var _f=/^([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})?Z$/;function xf(e){var r=e.match(_f);Ae.ok(r,"timestamps must be in UTC");var t=new Date,a=t.getUTCFullYear(),i=Math.floor(a/100)*100,n=parseInt(r[1],10);return a%100<50&&n>=60?n+=i-1:n+=i,t.setUTCFullYear(n,parseInt(r[2],10)-1,parseInt(r[3],10)),t.setUTCHours(parseInt(r[4],10),parseInt(r[5],10)),r[6]&&r[6].length>0&&t.setUTCSeconds(parseInt(r[6],10)),t}var Df=/^([0-9]{4})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})([0-9]{2})?Z$/;function Kf(e){var r=e.match(Df);Ae.ok(r);var t=new Date;return t.setUTCFullYear(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10)),t.setUTCHours(parseInt(r[4],10),parseInt(r[5],10)),r[6]&&r[6].length>0&&t.setUTCSeconds(parseInt(r[6],10)),t}function ue(e,r){r===void 0&&(r=2);for(var t=""+e;t.length<r;)t="0"+t;return t}function Of(e){var r="";return r+=ue(e.getUTCFullYear()%100),r+=ue(e.getUTCMonth()+1),r+=ue(e.getUTCDate()),r+=ue(e.getUTCHours()),r+=ue(e.getUTCMinutes()),r+=ue(e.getUTCSeconds()),r+="Z",r}function Tf(e){var r="";return r+=ue(e.getUTCFullYear(),4),r+=ue(e.getUTCMonth()+1),r+=ue(e.getUTCDate()),r+=ue(e.getUTCHours()),r+=ue(e.getUTCMinutes()),r+=ue(e.getUTCSeconds()),r+="Z",r}function Uf(e,r){e.signatures.x509===void 0&&(e.signatures.x509={});var t=e.signatures.x509;if(t.algo=r.type+"-"+r.defaultHashAlgorithm(),ge[t.algo]===void 0)return!1;var a=new y.BerWriter;Yr(e,a);var i=a.buffer;t.cache=i;var n=r.createSign();return n.write(i),e.signatures.x509.signature=n.sign(),!0}function Nf(e,r,t){e.signatures.x509===void 0&&(e.signatures.x509={});var a=e.signatures.x509,i=new y.BerWriter;Yr(e,i);var n=i.buffer;a.cache=n,r(n,function(s,f){if(s){t(s);return}if(a.algo=f.type+"-"+f.hashAlgorithm,ge[a.algo]===void 0){t(new Error('Invalid signing algorithm "'+a.algo+'"'));return}a.signature=f,t()})}function zf(e,r){var t=e.signatures.x509;Ae.object(t,"x509 signature");var a=new y.BerWriter;a.startSequence(),t.cache?(a._ensure(t.cache.length),t.cache.copy(a._buf,a._offset),a._offset+=t.cache.length):Yr(e,a),a.startSequence(),a.writeOID(ge[t.algo]),t.algo.match(/^rsa-/)&&a.writeNull(),a.endSequence();var i=t.signature.toBuffer("asn1"),n=Nt.alloc(i.length+1);return n[0]=0,i.copy(n,1),a.writeBuffer(n,y.Ber.BitString),a.endSequence(),a.buffer}function Yr(e,r){var t=e.signatures.x509;Ae.object(t,"x509 signature"),r.startSequence(),r.startSequence(Z(0)),r.writeInt(2),r.endSequence(),r.writeBuffer(fi.mpNormalize(e.serial),y.Ber.Integer),r.startSequence(),r.writeOID(ge[t.algo]),t.algo.match(/^rsa-/)&&r.writeNull(),r.endSequence(),e.issuer.toAsn1(r),r.startSequence(),si(r,e.validFrom),si(r,e.validUntil),r.endSequence();var a=e.subjects[0],i=e.subjects.slice(1);if(a.toAsn1(r),oi.writePkcs8(r,e.subjectKey),t.extras&&t.extras.issuerUniqueID&&r.writeBuffer(t.extras.issuerUniqueID,Z(1)),t.extras&&t.extras.subjectUniqueID&&r.writeBuffer(t.extras.subjectUniqueID,Z(2)),i.length>0||a.type==="host"||e.purposes!==void 0&&e.purposes.length>0||t.extras&&t.extras.exts){r.startSequence(Z(3)),r.startSequence();var n=[];e.purposes!==void 0&&e.purposes.length>0&&(n.push({oid:oe.basicConstraints,critical:!0}),n.push({oid:oe.keyUsage,critical:!0}),n.push({oid:oe.extKeyUsage,critical:!0})),n.push({oid:oe.altName}),t.extras&&t.extras.exts&&(n=t.extras.exts);for(var s=0;s<n.length;++s){if(r.startSequence(),r.writeOID(n[s].oid),n[s].critical!==void 0&&r.writeBoolean(n[s].critical),n[s].oid===oe.altName){r.startSequence(y.Ber.OctetString),r.startSequence(),a.type==="host"&&r.writeString(a.hostname,vr(2));for(var f=0;f<i.length;++f)i[f].type==="host"?r.writeString(i[f].hostname,ie.DNSName):i[f].type==="email"?r.writeString(i[f].email,ie.RFC822Name):(r.startSequence(ie.DirectoryName),i[f].toAsn1(r),r.endSequence());r.endSequence(),r.endSequence()}else if(n[s].oid===oe.basicConstraints){r.startSequence(y.Ber.OctetString),r.startSequence();var o=e.purposes.indexOf("ca")!==-1,u=n[s].pathLen;r.writeBoolean(o),u!==void 0&&r.writeInt(u),r.endSequence(),r.endSequence()}else if(n[s].oid===oe.extKeyUsage)r.startSequence(y.Ber.OctetString),r.startSequence(),e.purposes.forEach(function(l){if(l!=="ca"&&Ut.indexOf(l)===-1){var g=l;Qr[l]!==void 0&&(g=Qr[l]),r.writeOID(g)}}),r.endSequence(),r.endSequence();else if(n[s].oid===oe.keyUsage){if(r.startSequence(y.Ber.OctetString),n[s].bits!==void 0)r.writeBuffer(n[s].bits,y.Ber.BitString);else{var c=jf(e.purposes,Ut);r.writeBuffer(c,y.Ber.BitString)}r.endSequence()}else r.writeBuffer(n[s].data,y.Ber.OctetString);r.endSequence()}r.endSequence(),r.endSequence()}r.endSequence()}function Hf(e,r){for(var t=8*(e.length-1)-e[0],a={},i=0;i<t;++i){var n=1+Math.floor(i/8),s=7-i%8,f=1<<s,o=(e[n]&f)!==0,u=r[i];o&&typeof u=="string"&&(a[u]=!0)}return Object.keys(a)}function jf(e,r){var t=r.length,a=Math.ceil(t/8),i=a*8-t,n=Nt.alloc(1+a);n[0]=i;for(var s=0;s<t;++s){var f=1+Math.floor(s/8),o=7-s%8,u=1<<o,c=r[s];if(c!==void 0){var l=e.indexOf(c)!==-1;l&&(n[f]|=u)}}return n}});var li=P((Uu,pi)=>{var Gr=zt();pi.exports={read:Lf,verify:Gr.verify,sign:Gr.sign,write:Rf};var Ht=h("assert-plus"),ku=h("asn1"),hi=h("safer-buffer").Buffer,Iu=R(),Cu=N(),_u=H(),xu=z(),Du=Ce(),Ku=pr(),Ou=Be(),Tu=lr();function Lf(e,r){typeof e!="string"&&(Ht.buffer(e,"buf"),e=e.toString("ascii"));for(var t=e.trim().split(/[\r\n]+/g),a,i=-1;!a&&i<t.length;)a=t[++i].match(/[-]+[ ]*BEGIN CERTIFICATE[ ]*[-]+/);Ht.ok(a,"invalid PEM header");for(var n,s=t.length;!n&&s>0;)n=t[--s].match(/[-]+[ ]*END CERTIFICATE[ ]*[-]+/);Ht.ok(n,"invalid PEM footer"),t=t.slice(i,s+1);for(var f={};t=t.slice(1),a=t[0].match(/^([A-Za-z0-9-]+): (.+)$/),!!a;)f[a[1].toLowerCase()]=a[2];return t=t.slice(0,-1).join(""),e=hi.from(t,"base64"),Gr.read(e,r)}function Rf(e,r){var t=Gr.write(e,r),a="CERTIFICATE",i=t.toString("base64"),n=i.length+i.length/64+18+16+a.length*2+10,s=hi.alloc(n),f=0;f+=s.write("-----BEGIN "+a+`-----
`,f);for(var o=0;o<i.length;){var u=o+64;u>i.length&&(u=i.length),f+=s.write(i.slice(o,u),f),s[f++]=10,o=u}return f+=s.write("-----END "+a+`-----
`,f),s.slice(0,f)}});var lr=P((Hu,gi)=>{gi.exports=C;var b=h("assert-plus"),vi=h("safer-buffer").Buffer,Mf=R(),Qf=h("crypto"),Yf=hr(),Nu=Be(),di=he(),zu=h("util"),re=N(),Vr=H(),Zr=z(),Cr=pr(),me={};me.openssh=ii();me.x509=zt();me.pem=li();var Gf=di.CertificateParseError,Vf=di.InvalidAlgorithmError;function C(e){b.object(e,"options"),b.arrayOfObject(e.subjects,"options.subjects"),re.assertCompatible(e.subjects[0],Cr,[1,0],"options.subjects"),re.assertCompatible(e.subjectKey,Vr,[1,0],"options.subjectKey"),re.assertCompatible(e.issuer,Cr,[1,0],"options.issuer"),e.issuerKey!==void 0&&re.assertCompatible(e.issuerKey,Vr,[1,0],"options.issuerKey"),b.object(e.signatures,"options.signatures"),b.buffer(e.serial,"options.serial"),b.date(e.validFrom,"options.validFrom"),b.date(e.validUntil,"optons.validUntil"),b.optionalArrayOfString(e.purposes,"options.purposes"),this._hashCache={},this.subjects=e.subjects,this.issuer=e.issuer,this.subjectKey=e.subjectKey,this.issuerKey=e.issuerKey,this.signatures=e.signatures,this.serial=e.serial,this.validFrom=e.validFrom,this.validUntil=e.validUntil,this.purposes=e.purposes}C.formats=me;C.prototype.toBuffer=function(e,r){return e===void 0&&(e="x509"),b.string(e,"format"),b.object(me[e],"formats[format]"),b.optionalObject(r,"options"),me[e].write(this,r)};C.prototype.toString=function(e,r){return e===void 0&&(e="pem"),this.toBuffer(e,r).toString()};C.prototype.fingerprint=function(e){e===void 0&&(e="sha256"),b.string(e,"algorithm");var r={type:"certificate",hash:this.hash(e),algorithm:e};return new Yf(r)};C.prototype.hash=function(e){if(b.string(e,"algorithm"),e=e.toLowerCase(),Mf.hashAlgs[e]===void 0)throw new Vf(e);if(this._hashCache[e])return this._hashCache[e];var r=Qf.createHash(e).update(this.toBuffer("x509")).digest();return this._hashCache[e]=r,r};C.prototype.isExpired=function(e){return e===void 0&&(e=new Date),!(e.getTime()>=this.validFrom.getTime()&&e.getTime()<this.validUntil.getTime())};C.prototype.isSignedBy=function(e){return re.assertCompatible(e,C,[1,0],"issuer"),!this.issuer.equals(e.subjects[0])||this.issuer.purposes&&this.issuer.purposes.length>0&&this.issuer.purposes.indexOf("ca")===-1?!1:this.isSignedByKey(e.subjectKey)};C.prototype.getExtension=function(e){b.string(e,"keyOrOid");var r=this.getExtensions().filter(function(t){return t.format==="x509"?t.oid===e:t.format==="openssh"?t.name===e:!1})[0];return r};C.prototype.getExtensions=function(){var e=[],r=this.signatures.x509;r&&r.extras&&r.extras.exts&&r.extras.exts.forEach(function(a){a.format="x509",e.push(a)});var t=this.signatures.openssh;return t&&t.exts&&t.exts.forEach(function(a){a.format="openssh",e.push(a)}),e};C.prototype.isSignedByKey=function(e){if(re.assertCompatible(e,Vr,[1,2],"issuerKey"),this.issuerKey!==void 0)return this.issuerKey.fingerprint("sha512").matches(e);var r=Object.keys(this.signatures)[0],t=me[r].verify(this,e);return t&&(this.issuerKey=e),t};C.prototype.signWith=function(e){re.assertCompatible(e,Zr,[1,2],"key");for(var r=Object.keys(me),t=!1,a=0;a<r.length;++a)if(r[a]!=="pem"){var i=me[r[a]].sign(this,e);i===!0&&(t=!0)}if(!t)throw new Error("Failed to sign the certificate for any available certificate formats")};C.createSelfSigned=function(e,r,t){var a;Array.isArray(e)?a=e:a=[e],b.arrayOfObject(a),a.forEach(function(g){re.assertCompatible(g,Cr,[1,0],"subject")}),re.assertCompatible(r,Zr,[1,2],"private key"),b.optionalObject(t,"options"),t===void 0&&(t={}),b.optionalObject(t.validFrom,"options.validFrom"),b.optionalObject(t.validUntil,"options.validUntil");var i=t.validFrom,n=t.validUntil;if(i===void 0&&(i=new Date),n===void 0){b.optionalNumber(t.lifetime,"options.lifetime");var s=t.lifetime;s===void 0&&(s=10*365*24*3600),n=new Date,n.setTime(n.getTime()+s*1e3)}b.optionalBuffer(t.serial,"options.serial");var f=t.serial;f===void 0&&(f=vi.from("0000000000000001","hex"));var o=t.purposes;if(o===void 0&&(o=[]),o.indexOf("signature")===-1&&o.push("signature"),o.indexOf("ca")===-1&&o.push("ca"),o.indexOf("crl")===-1&&o.push("crl"),o.length<=3){var u=a.filter(function(g){return g.type==="host"}),c=a.filter(function(g){return g.type==="user"});u.length>0&&o.indexOf("serverAuth")===-1&&o.push("serverAuth"),c.length>0&&o.indexOf("clientAuth")===-1&&o.push("clientAuth"),(c.length>0||u.length>0)&&(o.indexOf("keyAgreement")===-1&&o.push("keyAgreement"),r.type==="rsa"&&o.indexOf("encryption")===-1&&o.push("encryption"))}var l=new C({subjects:a,issuer:a[0],subjectKey:r.toPublic(),issuerKey:r.toPublic(),signatures:{},serial:f,validFrom:i,validUntil:n,purposes:o});return l.signWith(r),l};C.create=function(e,r,t,a,i){var n;Array.isArray(e)?n=e:n=[e],b.arrayOfObject(n),n.forEach(function(v){re.assertCompatible(v,Cr,[1,0],"subject")}),re.assertCompatible(r,Vr,[1,0],"key"),Zr.isPrivateKey(r)&&(r=r.toPublic()),re.assertCompatible(t,Cr,[1,0],"issuer"),re.assertCompatible(a,Zr,[1,2],"issuer key"),b.optionalObject(i,"options"),i===void 0&&(i={}),b.optionalObject(i.validFrom,"options.validFrom"),b.optionalObject(i.validUntil,"options.validUntil");var s=i.validFrom,f=i.validUntil;if(s===void 0&&(s=new Date),f===void 0){b.optionalNumber(i.lifetime,"options.lifetime");var o=i.lifetime;o===void 0&&(o=10*365*24*3600),f=new Date,f.setTime(f.getTime()+o*1e3)}b.optionalBuffer(i.serial,"options.serial");var u=i.serial;u===void 0&&(u=vi.from("0000000000000001","hex"));var c=i.purposes;c===void 0&&(c=[]),c.indexOf("signature")===-1&&c.push("signature"),i.ca===!0&&(c.indexOf("ca")===-1&&c.push("ca"),c.indexOf("crl")===-1&&c.push("crl"));var l=n.filter(function(v){return v.type==="host"}),g=n.filter(function(v){return v.type==="user"});l.length>0&&c.indexOf("serverAuth")===-1&&c.push("serverAuth"),g.length>0&&c.indexOf("clientAuth")===-1&&c.push("clientAuth"),(g.length>0||l.length>0)&&(c.indexOf("keyAgreement")===-1&&c.push("keyAgreement"),r.type==="rsa"&&c.indexOf("encryption")===-1&&c.push("encryption"));var d=new C({subjects:n,issuer:t,subjectKey:r,issuerKey:a.toPublic(),signatures:{},serial:u,validFrom:s,validUntil:f,purposes:c});return d.signWith(a),d};C.parse=function(e,r,t){typeof e!="string"&&b.buffer(e,"data"),r===void 0&&(r="auto"),b.string(r,"format"),typeof t=="string"&&(t={filename:t}),b.optionalObject(t,"options"),t===void 0&&(t={}),b.optionalString(t.filename,"options.filename"),t.filename===void 0&&(t.filename="(unnamed)"),b.object(me[r],"formats[format]");try{var a=me[r].read(e,t);return a}catch(i){throw new Gf(t.filename,r,i)}};C.isCertificate=function(e,r){return re.isCompatible(e,C,r)};C.prototype._sshpkApiVersion=[1,1];C._oldVersionDetect=function(e){return[1,0]}});var hr=P((ju,Ei)=>{Ei.exports=Oe;var ce=h("assert-plus"),Wr=h("safer-buffer").Buffer,Bi=R(),mi=h("crypto"),bi=he(),wi=H(),yi=z(),Zf=lr(),_r=N(),Ke=bi.FingerprintFormatError,jt=bi.InvalidAlgorithmError;function Oe(e){if(ce.object(e,"options"),ce.string(e.type,"options.type"),ce.buffer(e.hash,"options.hash"),ce.string(e.algorithm,"options.algorithm"),this.algorithm=e.algorithm.toLowerCase(),Bi.hashAlgs[this.algorithm]!==!0)throw new jt(this.algorithm);this.hash=e.hash,this.type=e.type,this.hashType=e.hashType}Oe.prototype.toString=function(e){switch(e===void 0&&(this.algorithm==="md5"||this.hashType==="spki"?e="hex":e="base64"),ce.string(e),e){case"hex":return this.hashType==="spki"?this.hash.toString("hex"):Wf(this.hash.toString("hex"));case"base64":return this.hashType==="spki"?this.hash.toString("base64"):$f(this.algorithm,this.hash.toString("base64"));default:throw new Ke(void 0,e)}};Oe.prototype.matches=function(e){ce.object(e,"key or certificate"),this.type==="key"&&this.hashType!=="ssh"?(_r.assertCompatible(e,wi,[1,7],"key with spki"),yi.isPrivateKey(e)&&_r.assertCompatible(e,yi,[1,6],"privatekey with spki support")):this.type==="key"?_r.assertCompatible(e,wi,[1,0],"key"):_r.assertCompatible(e,Zf,[1,0],"certificate");var r=e.hash(this.algorithm,this.hashType),t=mi.createHash(this.algorithm).update(r).digest("base64");return this.hash2===void 0&&(this.hash2=mi.createHash(this.algorithm).update(this.hash).digest("base64")),this.hash2===t};var Si=/^[A-Za-z0-9+\/=]+$/,qi=/^[a-fA-F0-9]+$/;Oe.parse=function(e,r){ce.string(e,"fingerprint");var t,a,i;Array.isArray(r)&&(i=r,r={}),ce.optionalObject(r,"options"),r===void 0&&(r={}),r.enAlgs!==void 0&&(i=r.enAlgs),r.algorithms!==void 0&&(i=r.algorithms),ce.optionalArrayOfString(i,"algorithms");var n="ssh";r.hashType!==void 0&&(n=r.hashType),ce.string(n,"options.hashType");var s=e.split(":");if(s.length==2){if(t=s[0].toLowerCase(),!Si.test(s[1]))throw new Ke(e);try{a=Wr.from(s[1],"base64")}catch{throw new Ke(e)}}else if(s.length>2){if(t="md5",s[0].toLowerCase()==="md5"&&(s=s.slice(1)),s=s.map(function(f){for(;f.length<2;)f="0"+f;if(f.length>2)throw new Ke(e);return f}),s=s.join(""),!qi.test(s)||s.length%2!==0)throw new Ke(e);try{a=Wr.from(s,"hex")}catch{throw new Ke(e)}}else{if(qi.test(e))a=Wr.from(e,"hex");else if(Si.test(e))a=Wr.from(e,"base64");else throw new Ke(e);switch(a.length){case 32:t="sha256";break;case 16:t="md5";break;case 20:t="sha1";break;case 64:t="sha512";break;default:throw new Ke(e)}r.hashType===void 0&&(n="spki")}if(t===void 0)throw new Ke(e);if(Bi.hashAlgs[t]===void 0)throw new jt(t);if(i!==void 0&&(i=i.map(function(f){return f.toLowerCase()}),i.indexOf(t)===-1))throw new jt(t);return new Oe({algorithm:t,hash:a,type:r.type||"key",hashType:n})};function Wf(e){return e.replace(/(.{2})(?=.)/g,"$1:")}function Xf(e){return e.replace(/=*$/,"")}function $f(e,r){return e.toUpperCase()+":"+Xf(r)}Oe.isFingerprint=function(e,r){return _r.isCompatible(e,Oe,r)};Oe.prototype._sshpkApiVersion=[1,2];Oe._oldVersionDetect=function(e){return ce.func(e.toString),ce.func(e.matches),[1,0]}});var H=P((Lu,Ii)=>{Ii.exports=W;var T=h("assert-plus"),Lt=R(),Rt=h("crypto"),Jf=hr(),Pi=Be(),eo=Dr().DiffieHellman,Fi=he(),Ai=N(),ro=z(),Mt;try{Mt=vt()}catch{}var ki=Fi.InvalidAlgorithmError,to=Fi.KeyParseError,U={};U.auto=_t();U.pem=Ce();U.pkcs1=Tr();U.pkcs8=ar();U.rfc4253=xe();U.ssh=Pt();U["ssh-private"]=Er();U.openssh=U["ssh-private"];U.dnssec=Hr();U.putty=Lr();U.ppk=U.putty;function W(e){T.object(e,"options"),T.arrayOfObject(e.parts,"options.parts"),T.string(e.type,"options.type"),T.optionalString(e.comment,"options.comment");var r=Lt.info[e.type];if(typeof r!="object")throw new ki(e.type);for(var t={},a=0;a<e.parts.length;++a){var i=e.parts[a];t[i.name]=i}this.type=e.type,this.parts=e.parts,this.part=t,this.comment=void 0,this.source=e.source,this._rfc4253Cache=e._rfc4253Cache,this._hashCache={};var n;if(this.curve=void 0,this.type==="ecdsa"){var s=this.part.curve.data.toString();this.curve=s,n=Lt.curves[s].size}else if(this.type==="ed25519"||this.type==="curve25519")n=256,this.curve="curve25519";else{var f=this.part[r.sizePart];n=f.data.length,n=n*8-Ai.countZeros(f.data)}this.size=n}W.formats=U;W.prototype.toBuffer=function(e,r){return e===void 0&&(e="ssh"),T.string(e,"format"),T.object(U[e],"formats[format]"),T.optionalObject(r,"options"),e==="rfc4253"?(this._rfc4253Cache===void 0&&(this._rfc4253Cache=U.rfc4253.write(this)),this._rfc4253Cache):U[e].write(this,r)};W.prototype.toString=function(e,r){return this.toBuffer(e,r).toString()};W.prototype.hash=function(e,r){if(T.string(e,"algorithm"),T.optionalString(r,"type"),r===void 0&&(r="ssh"),e=e.toLowerCase(),Lt.hashAlgs[e]===void 0)throw new ki(e);var t=e+"||"+r;if(this._hashCache[t])return this._hashCache[t];var a;if(r==="ssh")a=this.toBuffer("rfc4253");else if(r==="spki")a=U.pkcs8.pkcs8ToBuffer(this);else throw new Error("Hash type "+r+" not supported");var i=Rt.createHash(e).update(a).digest();return this._hashCache[t]=i,i};W.prototype.fingerprint=function(e,r){e===void 0&&(e="sha256"),r===void 0&&(r="ssh"),T.string(e,"algorithm"),T.string(r,"type");var t={type:"key",hash:this.hash(e,r),algorithm:e,hashType:r};return new Jf(t)};W.prototype.defaultHashAlgorithm=function(){var e="sha1";return this.type==="rsa"&&(e="sha256"),this.type==="dsa"&&this.size>1024&&(e="sha256"),this.type==="ed25519"&&(e="sha512"),this.type==="ecdsa"&&(this.size<=256?e="sha256":this.size<=384?e="sha384":e="sha512"),e};W.prototype.createVerify=function(e){if(e===void 0&&(e=this.defaultHashAlgorithm()),T.string(e,"hash algorithm"),this.type==="ed25519"&&Mt!==void 0)return new Mt.Verifier(this,e);if(this.type==="curve25519")throw new Error("Curve25519 keys are not suitable for signing or verification");var r,t,a;try{t=e.toUpperCase(),r=Rt.createVerify(t)}catch(o){a=o}(r===void 0||a instanceof Error&&a.message.match(/Unknown message digest/))&&(t="RSA-",t+=e.toUpperCase(),r=Rt.createVerify(t)),T.ok(r,"failed to create verifier");var i=r.verify.bind(r),n=this.toBuffer("pkcs8"),s=this.curve,f=this;return r.verify=function(o,u){if(Pi.isSignature(o,[2,0]))return o.type!==f.type||o.hashAlgorithm&&o.hashAlgorithm!==e||o.curve&&f.type==="ecdsa"&&o.curve!==s?!1:i(n,o.toBuffer("asn1"));if(typeof o=="string"||__Buffer$.isBuffer(o))return i(n,o,u);throw Pi.isSignature(o,[1,0])?new Error("signature was created by too old a version of sshpk and cannot be verified"):new TypeError("signature must be a string, Buffer, or Signature object")},r};W.prototype.createDiffieHellman=function(){if(this.type==="rsa")throw new Error("RSA keys do not support Diffie-Hellman");return new eo(this)};W.prototype.createDH=W.prototype.createDiffieHellman;W.parse=function(e,r,t){typeof e!="string"&&T.buffer(e,"data"),r===void 0&&(r="auto"),T.string(r,"format"),typeof t=="string"&&(t={filename:t}),T.optionalObject(t,"options"),t===void 0&&(t={}),T.optionalString(t.filename,"options.filename"),t.filename===void 0&&(t.filename="(unnamed)"),T.object(U[r],"formats[format]");try{var a=U[r].read(e,t);return a instanceof ro&&(a=a.toPublic()),a.comment||(a.comment=t.filename),a}catch(i){throw i.name==="KeyEncryptedError"?i:new to(t.filename,r,i)}};W.isKey=function(e,r){return Ai.isCompatible(e,W,r)};W.prototype._sshpkApiVersion=[1,7];W._oldVersionDetect=function(e){return T.func(e.toBuffer),T.func(e.fingerprint),e.createDH?[1,4]:e.defaultHashAlgorithm?[1,3]:e.formats.auto?[1,2]:e.formats.pkcs1?[1,1]:[1,0]}});var Yt=P((Ru,Di)=>{var Ci=H(),_i=hr(),xi=Be(),Qt=z(),Xr=lr(),dr=pr(),gr=he();Di.exports={Key:Ci,parseKey:Ci.parse,Fingerprint:_i,parseFingerprint:_i.parse,Signature:xi,parseSignature:xi.parse,PrivateKey:Qt,parsePrivateKey:Qt.parse,generatePrivateKey:Qt.generate,Certificate:Xr,parseCertificate:Xr.parse,createSelfSignedCertificate:Xr.createSelfSigned,createCertificate:Xr.create,Identity:dr,identityFromDN:dr.parseDN,identityForHost:dr.forHost,identityForUser:dr.forUser,identityForEmail:dr.forEmail,identityFromArray:dr.fromArray,FingerprintFormatError:gr.FingerprintFormatError,InvalidAlgorithmError:gr.InvalidAlgorithmError,KeyParseError:gr.KeyParseError,SignatureParseError:gr.SignatureParseError,KeyEncryptedError:gr.KeyEncryptedError,CertificateParseError:gr.CertificateParseError}});var je={};ji(je,{Certificate:()=>po,CertificateParseError:()=>ko,Fingerprint:()=>no,FingerprintFormatError:()=>bo,Identity:()=>mo,InvalidAlgorithmError:()=>Eo,Key:()=>ao,KeyEncryptedError:()=>Ao,KeyParseError:()=>Po,PrivateKey:()=>uo,Signature:()=>fo,SignatureParseError:()=>Fo,createCertificate:()=>go,createSelfSignedCertificate:()=>vo,default:()=>Co,generatePrivateKey:()=>ho,identityForEmail:()=>qo,identityForHost:()=>yo,identityForUser:()=>So,identityFromArray:()=>Bo,identityFromDN:()=>wo,parseCertificate:()=>lo,parseFingerprint:()=>so,parseKey:()=>io,parsePrivateKey:()=>co,parseSignature:()=>oo});var Oi=Vt(Yt());Me(je,Vt(Yt()));var{Key:ao,parseKey:io,Fingerprint:no,parseFingerprint:so,Signature:fo,parseSignature:oo,PrivateKey:uo,parsePrivateKey:co,generatePrivateKey:ho,Certificate:po,parseCertificate:lo,createSelfSignedCertificate:vo,createCertificate:go,Identity:mo,identityFromDN:wo,identityForHost:yo,identityForUser:So,identityForEmail:qo,identityFromArray:Bo,FingerprintFormatError:bo,InvalidAlgorithmError:Eo,KeyParseError:Po,SignatureParseError:Fo,KeyEncryptedError:Ao,CertificateParseError:ko}=Oi,{default:Ki,...Io}=Oi,Co=Ki!==void 0?Ki:Io;export{po as Certificate,ko as CertificateParseError,no as Fingerprint,bo as FingerprintFormatError,mo as Identity,Eo as InvalidAlgorithmError,ao as Key,Ao as KeyEncryptedError,Po as KeyParseError,uo as PrivateKey,fo as Signature,Fo as SignatureParseError,go as createCertificate,vo as createSelfSignedCertificate,Co as default,ho as generatePrivateKey,qo as identityForEmail,yo as identityForHost,So as identityForUser,Bo as identityFromArray,wo as identityFromDN,lo as parseCertificate,so as parseFingerprint,io as parseKey,co as parsePrivateKey,oo as parseSignature};
//# sourceMappingURL=sshpk.mjs.map