/* esm.sh - esbuild bundle(@opentelemetry/sdk-metrics@1.17.0) denonext production */
var __setImmediate$ = (cb, ...args) => setTimeout(cb, 0, ...args);
var S;(function(r){r[r.DELTA=0]="DELTA",r[r.CUMULATIVE=1]="CUMULATIVE"})(S||(S={}));var v;(function(r){r[r.HISTOGRAM=0]="HISTOGRAM",r[r.EXPONENTIAL_HISTOGRAM=1]="EXPONENTIAL_HISTOGRAM",r[r.GAUGE=2]="GAUGE",r[r.SUM=3]="SUM"})(v||(v={}));import*as st from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";var Le=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),St=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(c){try{a(n.next(c))}catch(f){u(f)}}function l(c){try{a(n.throw(c))}catch(f){u(f)}}function a(c){c.done?i(c.value):o(c.value).then(s,l)}a((n=n.apply(r,t||[])).next())})},xt=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Ve=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},Ge=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},Fe=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function $(r){return r!=null}function Mt(r){var t=Object.keys(r);return t.length===0?"":(t=t.sort(),JSON.stringify(t.map(function(e){return[e,r[e]]})))}function At(r){var t,e;return r.name+":"+((t=r.version)!==null&&t!==void 0?t:"")+":"+((e=r.schemaUrl)!==null&&e!==void 0?e:"")}var k=function(r){Le(t,r);function t(e){var n=r.call(this,e)||this;return Object.setPrototypeOf(n,t.prototype),n}return t}(Error);function w(r,t){var e,n=new Promise(function(i,u){e=setTimeout(function(){u(new k("Operation timed out."))},t)});return Promise.race([r,n]).then(function(o){return clearTimeout(e),o},function(o){throw clearTimeout(e),o})}function Tt(r){return St(this,void 0,void 0,function(){var t=this;return xt(this,function(e){return[2,Promise.all(r.map(function(n){return St(t,void 0,void 0,function(){var o,i;return xt(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,n];case 1:return o=u.sent(),[2,{status:"fulfilled",value:o}];case 2:return i=u.sent(),[2,{status:"rejected",reason:i}];case 3:return[2]}})})}))]})})}function Et(r){return r.status==="rejected"}function E(r,t){var e=[];return r.forEach(function(n){e.push.apply(e,Ge([],Ve(t(n)),!1))}),e}function Ot(r,t){var e,n;if(r.size!==t.size)return!1;try{for(var o=Fe(r),i=o.next();!i.done;i=o.next()){var u=i.value;if(!t.has(u))return!1}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return!0}function It(r,t){for(var e=0,n=r.length-1;n-e>1;){var o=Math.trunc((n+e)/2);r[o]<=t?e=o:n=o-1}return r[n]<=t?n:r[e]<=t?e:-1}function Nt(r,t){return r.toLowerCase()===t.toLowerCase()}import*as zt from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";var m;(function(r){r[r.DROP=0]="DROP",r[r.SUM=1]="SUM",r[r.LAST_VALUE=2]="LAST_VALUE",r[r.HISTOGRAM=3]="HISTOGRAM",r[r.EXPONENTIAL_HISTOGRAM=4]="EXPONENTIAL_HISTOGRAM"})(m||(m={}));var Pt=function(){function r(){this.kind=m.DROP}return r.prototype.createAccumulation=function(){},r.prototype.merge=function(t,e){},r.prototype.diff=function(t,e){},r.prototype.toMetricData=function(t,e,n,o){},r}();import{ValueType as He,diag as De}from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";var h;(function(r){r.COUNTER="COUNTER",r.HISTOGRAM="HISTOGRAM",r.UP_DOWN_COUNTER="UP_DOWN_COUNTER",r.OBSERVABLE_COUNTER="OBSERVABLE_COUNTER",r.OBSERVABLE_GAUGE="OBSERVABLE_GAUGE",r.OBSERVABLE_UP_DOWN_COUNTER="OBSERVABLE_UP_DOWN_COUNTER"})(h||(h={}));function _(r,t,e){var n,o,i;return ze(r)||De.warn('Invalid metric name: "'+r+'". The metric name should be a ASCII string with a length no greater than 255 characters.'),{name:r,type:t,description:(n=e?.description)!==null&&n!==void 0?n:"",unit:(o=e?.unit)!==null&&o!==void 0?o:"",valueType:(i=e?.valueType)!==null&&i!==void 0?i:He.DOUBLE}}function Ct(r,t){var e,n;return{name:(e=r.name)!==null&&e!==void 0?e:t.name,description:(n=r.description)!==null&&n!==void 0?n:t.description,type:t.type,unit:t.unit,valueType:t.valueType}}function Rt(r,t){return Nt(r.name,t.name)&&r.unit===t.unit&&r.type===t.type&&r.valueType===t.valueType}var je=/^[a-z][a-z0-9_.-]{0,254}$/i;function ze(r){return r.match(je)!=null}var We=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i};function Xe(r){var t=r.map(function(){return 0});return t.push(0),{buckets:{boundaries:r,counts:t},sum:0,count:0,hasMinMax:!1,min:1/0,max:-1/0}}var J=function(){function r(t,e,n,o){n===void 0&&(n=!0),o===void 0&&(o=Xe(e)),this.startTime=t,this._boundaries=e,this._recordMinMax=n,this._current=o}return r.prototype.record=function(t){this._current.count+=1,this._current.sum+=t,this._recordMinMax&&(this._current.min=Math.min(t,this._current.min),this._current.max=Math.max(t,this._current.max),this._current.hasMinMax=!0);var e=It(this._boundaries,t);this._current.buckets.counts[e+1]+=1},r.prototype.setStartTime=function(t){this.startTime=t},r.prototype.toPointValue=function(){return this._current},r}();var Z=function(){function r(t,e){this._boundaries=t,this._recordMinMax=e,this.kind=m.HISTOGRAM}return r.prototype.createAccumulation=function(t){return new J(t,this._boundaries,this._recordMinMax)},r.prototype.merge=function(t,e){for(var n=t.toPointValue(),o=e.toPointValue(),i=n.buckets.counts,u=o.buckets.counts,s=new Array(i.length),l=0;l<i.length;l++)s[l]=i[l]+u[l];var a=1/0,c=-1/0;return this._recordMinMax&&(n.hasMinMax&&o.hasMinMax?(a=Math.min(n.min,o.min),c=Math.max(n.max,o.max)):n.hasMinMax?(a=n.min,c=n.max):o.hasMinMax&&(a=o.min,c=o.max)),new J(t.startTime,n.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:n.buckets.boundaries,counts:s},count:n.count+o.count,sum:n.sum+o.sum,hasMinMax:this._recordMinMax&&(n.hasMinMax||o.hasMinMax),min:a,max:c})},r.prototype.diff=function(t,e){for(var n=t.toPointValue(),o=e.toPointValue(),i=n.buckets.counts,u=o.buckets.counts,s=new Array(i.length),l=0;l<i.length;l++)s[l]=u[l]-i[l];return new J(e.startTime,n.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:n.buckets.boundaries,counts:s},count:o.count-n.count,sum:o.sum-n.sum,hasMinMax:!1,min:1/0,max:-1/0})},r.prototype.toMetricData=function(t,e,n,o){return{descriptor:t,aggregationTemporality:e,dataPointType:v.HISTOGRAM,dataPoints:n.map(function(i){var u=We(i,2),s=u[0],l=u[1],a=l.toPointValue(),c=t.type===h.UP_DOWN_COUNTER||t.type===h.OBSERVABLE_GAUGE||t.type===h.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:s,startTime:l.startTime,endTime:o,value:{min:a.hasMinMax?a.min:void 0,max:a.hasMinMax?a.max:void 0,sum:c?void 0:a.sum,buckets:a.buckets,count:a.count}}})}},r}();import{diag as Qe}from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";var K=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},Q=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},tt=function(){function r(t,e,n,o){t===void 0&&(t=new qe),e===void 0&&(e=0),n===void 0&&(n=0),o===void 0&&(o=0),this.backing=t,this.indexBase=e,this.indexStart=n,this.indexEnd=o}return Object.defineProperty(r.prototype,"offset",{get:function(){return this.indexStart},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"length",{get:function(){return this.backing.length===0||this.indexEnd===this.indexStart&&this.at(0)===0?0:this.indexEnd-this.indexStart+1},enumerable:!1,configurable:!0}),r.prototype.counts=function(){var t=this;return Array.from({length:this.length},function(e,n){return t.at(n)})},r.prototype.at=function(t){var e=this.indexBase-this.indexStart;return t<e&&(t+=this.backing.length),t-=e,this.backing.countAt(t)},r.prototype.incrementBucket=function(t,e){this.backing.increment(t,e)},r.prototype.decrementBucket=function(t,e){this.backing.decrement(t,e)},r.prototype.trim=function(){for(var t=0;t<this.length;t++)if(this.at(t)!==0){this.indexStart+=t;break}else if(t===this.length-1){this.indexStart=this.indexEnd=this.indexBase=0;return}for(var t=this.length-1;t>=0;t--)if(this.at(t)!==0){this.indexEnd-=this.length-t-1;break}this._rotate()},r.prototype.downscale=function(t){this._rotate();for(var e=1+this.indexEnd-this.indexStart,n=1<<t,o=0,i=0,u=this.indexStart;u<=this.indexEnd;){var s=u%n;s<0&&(s+=n);for(var l=s;l<n&&o<e;l++)this._relocateBucket(i,o),o++,u++;i++}this.indexStart>>=t,this.indexEnd>>=t,this.indexBase=this.indexStart},r.prototype.clone=function(){return new r(this.backing.clone(),this.indexBase,this.indexStart,this.indexEnd)},r.prototype._rotate=function(){var t=this.indexBase-this.indexStart;t!==0&&(t>0?(this.backing.reverse(0,this.backing.length),this.backing.reverse(0,t),this.backing.reverse(t,this.backing.length)):(this.backing.reverse(0,this.backing.length),this.backing.reverse(0,this.backing.length+t)),this.indexBase=this.indexStart)},r.prototype._relocateBucket=function(t,e){t!==e&&this.incrementBucket(t,this.backing.emptyBucket(e))},r}();var qe=function(){function r(t){t===void 0&&(t=[0]),this._counts=t}return Object.defineProperty(r.prototype,"length",{get:function(){return this._counts.length},enumerable:!1,configurable:!0}),r.prototype.countAt=function(t){return this._counts[t]},r.prototype.growTo=function(t,e,n){var o=new Array(t).fill(0);o.splice.apply(o,Q([n,this._counts.length-e],K(this._counts.slice(e)),!1)),o.splice.apply(o,Q([0,e],K(this._counts.slice(0,e)),!1)),this._counts=o},r.prototype.reverse=function(t,e){for(var n=Math.floor((t+e)/2)-t,o=0;o<n;o++){var i=this._counts[t+o];this._counts[t+o]=this._counts[e-o-1],this._counts[e-o-1]=i}},r.prototype.emptyBucket=function(t){var e=this._counts[t];return this._counts[t]=0,e},r.prototype.increment=function(t,e){this._counts[t]+=e},r.prototype.decrement=function(t,e){this._counts[t]>=e?this._counts[t]-=e:this._counts[t]=0},r.prototype.clone=function(){return new r(Q([],K(this._counts),!1))},r}();var kt=52,Ye=2146435072,$e=1048575,et=1023,U=-et+1,B=et,O=Math.pow(2,-1022);function L(r){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,r);var e=t.getUint32(0),n=(e&Ye)>>20;return n-et}function V(r){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,r);var e=t.getUint32(0),n=t.getUint32(4),o=(e&$e)*Math.pow(2,32);return o+n}function I(r,t){return r===0||r===Number.POSITIVE_INFINITY||r===Number.NEGATIVE_INFINITY||Number.isNaN(r)?r:r*Math.pow(2,t)}function Bt(r){return r--,r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16,r++,r}var Je=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),b=function(r){Je(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(Error);var Vt=function(){function r(t){this._shift=-t}return r.prototype.mapToIndex=function(t){if(t<O)return this._minNormalLowerBoundaryIndex();var e=L(t),n=this._rightShift(V(t)-1,kt);return e+n>>this._shift},r.prototype.lowerBoundary=function(t){var e=this._minNormalLowerBoundaryIndex();if(t<e)throw new b("underflow: "+t+" is < minimum lower boundary: "+e);var n=this._maxNormalLowerBoundaryIndex();if(t>n)throw new b("overflow: "+t+" is > maximum lower boundary: "+n);return I(1,t<<this._shift)},Object.defineProperty(r.prototype,"scale",{get:function(){return this._shift===0?0:-this._shift},enumerable:!1,configurable:!0}),r.prototype._minNormalLowerBoundaryIndex=function(){var t=U>>this._shift;return this._shift<2&&t--,t},r.prototype._maxNormalLowerBoundaryIndex=function(){return B>>this._shift},r.prototype._rightShift=function(t,e){return Math.floor(t*Math.pow(2,-e))},r}();var Gt=function(){function r(t){this._scale=t,this._scaleFactor=I(Math.LOG2E,t),this._inverseFactor=I(Math.LN2,-t)}return r.prototype.mapToIndex=function(t){if(t<=O)return this._minNormalLowerBoundaryIndex()-1;if(V(t)===0){var e=L(t);return(e<<this._scale)-1}var n=Math.floor(Math.log(t)*this._scaleFactor),o=this._maxNormalLowerBoundaryIndex();return n>=o?o:n},r.prototype.lowerBoundary=function(t){var e=this._maxNormalLowerBoundaryIndex();if(t>=e){if(t===e)return 2*Math.exp((t-(1<<this._scale))/this._scaleFactor);throw new b("overflow: "+t+" is > maximum lower boundary: "+e)}var n=this._minNormalLowerBoundaryIndex();if(t<=n){if(t===n)return O;if(t===n-1)return Math.exp((t+(1<<this._scale))/this._scaleFactor)/2;throw new b("overflow: "+t+" is < minimum lower boundary: "+n)}return Math.exp(t*this._inverseFactor)},Object.defineProperty(r.prototype,"scale",{get:function(){return this._scale},enumerable:!1,configurable:!0}),r.prototype._minNormalLowerBoundaryIndex=function(){return U<<this._scale},r.prototype._maxNormalLowerBoundaryIndex=function(){return(B+1<<this._scale)-1},r}();var Ft=-10,Ht=20,Ze=Array.from({length:31},function(r,t){return t>10?new Gt(t-10):new Vt(t-10)});function rt(r){if(r>Ht||r<Ft)throw new b("expected scale >= "+Ft+" && <= "+Ht+", got: "+r);return Ze[r+10]}var Ke=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},G=function(){function r(t,e){this.low=t,this.high=e}return r.combine=function(t,e){return new r(Math.min(t.low,e.low),Math.max(t.high,e.high))},r}(),tr=20,er=160,nt=2,rr=function(){function r(t,e,n,o,i,u,s,l,a,c,f){t===void 0&&(t=t),e===void 0&&(e=er),n===void 0&&(n=!0),o===void 0&&(o=0),i===void 0&&(i=0),u===void 0&&(u=0),s===void 0&&(s=Number.POSITIVE_INFINITY),l===void 0&&(l=Number.NEGATIVE_INFINITY),a===void 0&&(a=new tt),c===void 0&&(c=new tt),f===void 0&&(f=rt(tr)),this.startTime=t,this._maxSize=e,this._recordMinMax=n,this._sum=o,this._count=i,this._zeroCount=u,this._min=s,this._max=l,this._positive=a,this._negative=c,this._mapping=f,this._maxSize<nt&&(Qe.warn("Exponential Histogram Max Size set to "+this._maxSize+",                 changing to the minimum size of: "+nt),this._maxSize=nt)}return r.prototype.record=function(t){this.updateByIncrement(t,1)},r.prototype.setStartTime=function(t){this.startTime=t},r.prototype.toPointValue=function(){return{hasMinMax:this._recordMinMax,min:this.min,max:this.max,sum:this.sum,positive:{offset:this.positive.offset,bucketCounts:this.positive.counts()},negative:{offset:this.negative.offset,bucketCounts:this.negative.counts()},count:this.count,scale:this.scale,zeroCount:this.zeroCount}},Object.defineProperty(r.prototype,"sum",{get:function(){return this._sum},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"min",{get:function(){return this._min},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"max",{get:function(){return this._max},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"zeroCount",{get:function(){return this._zeroCount},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"scale",{get:function(){return this._count===this._zeroCount?0:this._mapping.scale},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"positive",{get:function(){return this._positive},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"negative",{get:function(){return this._negative},enumerable:!1,configurable:!0}),r.prototype.updateByIncrement=function(t,e){if(t>this._max&&(this._max=t),t<this._min&&(this._min=t),this._count+=e,t===0){this._zeroCount+=e;return}this._sum+=t*e,t>0?this._updateBuckets(this._positive,t,e):this._updateBuckets(this._negative,-t,e)},r.prototype.merge=function(t){this._count===0?(this._min=t.min,this._max=t.max):t.count!==0&&(t.min<this.min&&(this._min=t.min),t.max>this.max&&(this._max=t.max)),this.startTime=t.startTime,this._sum+=t.sum,this._count+=t.count,this._zeroCount+=t.zeroCount;var e=this._minScale(t);this._downscale(this.scale-e),this._mergeBuckets(this.positive,t,t.positive,e),this._mergeBuckets(this.negative,t,t.negative,e)},r.prototype.diff=function(t){this._min=1/0,this._max=-1/0,this._sum-=t.sum,this._count-=t.count,this._zeroCount-=t.zeroCount;var e=this._minScale(t);this._downscale(this.scale-e),this._diffBuckets(this.positive,t,t.positive,e),this._diffBuckets(this.negative,t,t.negative,e)},r.prototype.clone=function(){return new r(this.startTime,this._maxSize,this._recordMinMax,this._sum,this._count,this._zeroCount,this._min,this._max,this.positive.clone(),this.negative.clone(),this._mapping)},r.prototype._updateBuckets=function(t,e,n){var o=this._mapping.mapToIndex(e),i=!1,u=0,s=0;if(t.length===0?(t.indexStart=o,t.indexEnd=t.indexStart,t.indexBase=t.indexStart):o<t.indexStart&&t.indexEnd-o>=this._maxSize?(i=!0,s=o,u=t.indexEnd):o>t.indexEnd&&o-t.indexStart>=this._maxSize&&(i=!0,s=t.indexStart,u=o),i){var l=this._changeScale(u,s);this._downscale(l),o=this._mapping.mapToIndex(e)}this._incrementIndexBy(t,o,n)},r.prototype._incrementIndexBy=function(t,e,n){if(n!==0){if(e<t.indexStart){var o=t.indexEnd-e;o>=t.backing.length&&this._grow(t,o+1),t.indexStart=e}else if(e>t.indexEnd){var o=e-t.indexStart;o>=t.backing.length&&this._grow(t,o+1),t.indexEnd=e}var i=e-t.indexBase;i<0&&(i+=t.backing.length),t.incrementBucket(i,n)}},r.prototype._grow=function(t,e){var n=t.backing.length,o=t.indexBase-t.indexStart,i=n-o,u=Bt(e);u>this._maxSize&&(u=this._maxSize);var s=u-o;t.backing.growTo(u,i,s)},r.prototype._changeScale=function(t,e){for(var n=0;t-e>=this._maxSize;)t>>=1,e>>=1,n++;return n},r.prototype._downscale=function(t){if(t!==0){if(t<0)throw new Error("impossible change of scale: "+this.scale);var e=this._mapping.scale-t;this._positive.downscale(t),this._negative.downscale(t),this._mapping=rt(e)}},r.prototype._minScale=function(t){var e=Math.min(this.scale,t.scale),n=G.combine(this._highLowAtScale(this.positive,this.scale,e),this._highLowAtScale(t.positive,t.scale,e)),o=G.combine(this._highLowAtScale(this.negative,this.scale,e),this._highLowAtScale(t.negative,t.scale,e));return Math.min(e-this._changeScale(n.high,n.low),e-this._changeScale(o.high,o.low))},r.prototype._highLowAtScale=function(t,e,n){if(t.length===0)return new G(0,-1);var o=e-n;return new G(t.indexStart>>o,t.indexEnd>>o)},r.prototype._mergeBuckets=function(t,e,n,o){for(var i=n.offset,u=e.scale-o,s=0;s<n.length;s++)this._incrementIndexBy(t,i+s>>u,n.at(s))},r.prototype._diffBuckets=function(t,e,n,o){for(var i=n.offset,u=e.scale-o,s=0;s<n.length;s++){var l=i+s>>u,a=l-t.indexBase;a<0&&(a+=t.backing.length),t.decrementBucket(a,n.at(s))}t.trim()},r}();var Dt=function(){function r(t,e){this._maxSize=t,this._recordMinMax=e,this.kind=m.EXPONENTIAL_HISTOGRAM}return r.prototype.createAccumulation=function(t){return new rr(t,this._maxSize,this._recordMinMax)},r.prototype.merge=function(t,e){var n=e.clone();return n.merge(t),n},r.prototype.diff=function(t,e){var n=e.clone();return n.diff(t),n},r.prototype.toMetricData=function(t,e,n,o){return{descriptor:t,aggregationTemporality:e,dataPointType:v.EXPONENTIAL_HISTOGRAM,dataPoints:n.map(function(i){var u=Ke(i,2),s=u[0],l=u[1],a=l.toPointValue(),c=t.type===h.UP_DOWN_COUNTER||t.type===h.OBSERVABLE_GAUGE||t.type===h.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:s,startTime:l.startTime,endTime:o,value:{min:a.hasMinMax?a.min:void 0,max:a.hasMinMax?a.max:void 0,sum:c?void 0:a.sum,positive:{offset:a.positive.offset,bucketCounts:a.positive.bucketCounts},negative:{offset:a.negative.offset,bucketCounts:a.negative.bucketCounts},count:a.count,scale:a.scale,zeroCount:a.zeroCount}}})}},r}();import{millisToHrTime as ir,hrTimeToMicroseconds as F}from"/v135/@opentelemetry/core@1.17.0/denonext/core.mjs";var nr=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},it=function(){function r(t,e,n){e===void 0&&(e=0),n===void 0&&(n=[0,0]),this.startTime=t,this._current=e,this.sampleTime=n}return r.prototype.record=function(t){this._current=t,this.sampleTime=ir(Date.now())},r.prototype.setStartTime=function(t){this.startTime=t},r.prototype.toPointValue=function(){return this._current},r}();var jt=function(){function r(){this.kind=m.LAST_VALUE}return r.prototype.createAccumulation=function(t){return new it(t)},r.prototype.merge=function(t,e){var n=F(e.sampleTime)>=F(t.sampleTime)?e:t;return new it(t.startTime,n.toPointValue(),n.sampleTime)},r.prototype.diff=function(t,e){var n=F(e.sampleTime)>=F(t.sampleTime)?e:t;return new it(e.startTime,n.toPointValue(),n.sampleTime)},r.prototype.toMetricData=function(t,e,n,o){return{descriptor:t,aggregationTemporality:e,dataPointType:v.GAUGE,dataPoints:n.map(function(i){var u=nr(i,2),s=u[0],l=u[1];return{attributes:s,startTime:l.startTime,endTime:o,value:l.toPointValue()}})}},r}();var or=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},N=function(){function r(t,e,n,o){n===void 0&&(n=0),o===void 0&&(o=!1),this.startTime=t,this.monotonic=e,this._current=n,this.reset=o}return r.prototype.record=function(t){this.monotonic&&t<0||(this._current+=t)},r.prototype.setStartTime=function(t){this.startTime=t},r.prototype.toPointValue=function(){return this._current},r}();var ot=function(){function r(t){this.monotonic=t,this.kind=m.SUM}return r.prototype.createAccumulation=function(t){return new N(t,this.monotonic)},r.prototype.merge=function(t,e){var n=t.toPointValue(),o=e.toPointValue();return e.reset?new N(e.startTime,this.monotonic,o,e.reset):new N(t.startTime,this.monotonic,n+o)},r.prototype.diff=function(t,e){var n=t.toPointValue(),o=e.toPointValue();return this.monotonic&&n>o?new N(e.startTime,this.monotonic,o,!0):new N(e.startTime,this.monotonic,o-n)},r.prototype.toMetricData=function(t,e,n,o){return{descriptor:t,aggregationTemporality:e,dataPointType:v.SUM,dataPoints:n.map(function(i){var u=or(i,2),s=u[0],l=u[1];return{attributes:s,startTime:l.startTime,endTime:o,value:l.toPointValue()}}),isMonotonic:this.monotonic}},r}();var x=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),d=function(){function r(){}return r.Drop=function(){return Zt},r.Sum=function(){return Kt},r.LastValue=function(){return Qt},r.Histogram=function(){return te},r.ExponentialHistogram=function(){return ur},r.Default=function(){return sr},r}();var Wt=function(r){x(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.createAggregator=function(e){return t.DEFAULT_INSTANCE},t.DEFAULT_INSTANCE=new Pt,t}(d);var Xt=function(r){x(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.createAggregator=function(e){switch(e.type){case h.COUNTER:case h.OBSERVABLE_COUNTER:case h.HISTOGRAM:return t.MONOTONIC_INSTANCE;default:return t.NON_MONOTONIC_INSTANCE}},t.MONOTONIC_INSTANCE=new ot(!0),t.NON_MONOTONIC_INSTANCE=new ot(!1),t}(d);var qt=function(r){x(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.createAggregator=function(e){return t.DEFAULT_INSTANCE},t.DEFAULT_INSTANCE=new jt,t}(d);var Yt=function(r){x(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.createAggregator=function(e){return t.DEFAULT_INSTANCE},t.DEFAULT_INSTANCE=new Z([0,5,10,25,50,75,100,250,500,750,1e3,2500,5e3,7500,1e4],!0),t}(d);var ar=function(r){x(t,r);function t(e,n){n===void 0&&(n=!0);var o=r.call(this)||this;if(o._recordMinMax=n,e===void 0||e.length===0)throw new Error("HistogramAggregator should be created with boundaries.");e=e.concat(),e=e.sort(function(s,l){return s-l});var i=e.lastIndexOf(-1/0),u=e.indexOf(1/0);return u===-1&&(u=void 0),o._boundaries=e.slice(i+1,u),o}return t.prototype.createAggregator=function(e){return new Z(this._boundaries,this._recordMinMax)},t}(d);var $t=function(r){x(t,r);function t(e,n){e===void 0&&(e=160),n===void 0&&(n=!0);var o=r.call(this)||this;return o._maxSize=e,o._recordMinMax=n,o}return t.prototype.createAggregator=function(e){return new Dt(this._maxSize,this._recordMinMax)},t}(d);var Jt=function(r){x(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype._resolve=function(e){switch(e.type){case h.COUNTER:case h.UP_DOWN_COUNTER:case h.OBSERVABLE_COUNTER:case h.OBSERVABLE_UP_DOWN_COUNTER:return Kt;case h.OBSERVABLE_GAUGE:return Qt;case h.HISTOGRAM:return te}return zt.diag.warn("Unable to recognize instrument type: "+e.type),Zt},t.prototype.createAggregator=function(e){return this._resolve(e).createAggregator(e)},t}(d);var Zt=new Wt,Kt=new Xt,Qt=new qt,te=new Yt,ur=new $t,sr=new Jt;var ee=function(r){return d.Default()},H=function(r){return S.CUMULATIVE};var at=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(c){try{a(n.next(c))}catch(f){u(f)}}function l(c){try{a(n.throw(c))}catch(f){u(f)}}function a(c){c.done?i(c.value):o(c.value).then(s,l)}a((n=n.apply(r,t||[])).next())})},ut=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},re=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},cr=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},ct=function(){function r(t){var e,n,o;this._shutdown=!1,this._aggregationSelector=(e=t?.aggregationSelector)!==null&&e!==void 0?e:ee,this._aggregationTemporalitySelector=(n=t?.aggregationTemporalitySelector)!==null&&n!==void 0?n:H,this._metricProducers=(o=t?.metricProducers)!==null&&o!==void 0?o:[]}return r.prototype.setMetricProducer=function(t){if(this._sdkMetricProducer)throw new Error("MetricReader can not be bound to a MeterProvider again.");this._sdkMetricProducer=t,this.onInitialized()},r.prototype.selectAggregation=function(t){return this._aggregationSelector(t)},r.prototype.selectAggregationTemporality=function(t){return this._aggregationTemporalitySelector(t)},r.prototype.onInitialized=function(){},r.prototype.collect=function(t){return at(this,void 0,void 0,function(){var e,n,o,i,u,s;return ut(this,function(l){switch(l.label){case 0:if(this._sdkMetricProducer===void 0)throw new Error("MetricReader is not bound to a MetricProducer");if(this._shutdown)throw new Error("MetricReader is shutdown");return[4,Promise.all(cr([this._sdkMetricProducer.collect({timeoutMillis:t?.timeoutMillis})],re(this._metricProducers.map(function(a){return a.collect({timeoutMillis:t?.timeoutMillis})})),!1))];case 1:return e=re.apply(void 0,[l.sent()]),n=e[0],o=e.slice(1),i=n.errors.concat(E(o,function(a){return a.errors})),u=n.resourceMetrics.resource,s=n.resourceMetrics.scopeMetrics.concat(E(o,function(a){return a.resourceMetrics.scopeMetrics})),[2,{resourceMetrics:{resource:u,scopeMetrics:s},errors:i}]}})})},r.prototype.shutdown=function(t){return at(this,void 0,void 0,function(){return ut(this,function(e){switch(e.label){case 0:return this._shutdown?(st.diag.error("Cannot call shutdown twice."),[2]):t?.timeoutMillis!=null?[3,2]:[4,this.onShutdown()];case 1:return e.sent(),[3,4];case 2:return[4,w(this.onShutdown(),t.timeoutMillis)];case 3:e.sent(),e.label=4;case 4:return this._shutdown=!0,[2]}})})},r.prototype.forceFlush=function(t){return at(this,void 0,void 0,function(){return ut(this,function(e){switch(e.label){case 0:return this._shutdown?(st.diag.warn("Cannot forceFlush on already shutdown MetricReader."),[2]):t?.timeoutMillis!=null?[3,2]:[4,this.onForceFlush()];case 1:return e.sent(),[2];case 2:return[4,w(this.onForceFlush(),t.timeoutMillis)];case 3:return e.sent(),[2]}})})},r}();import*as lt from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";import{internal as pr,ExportResultCode as mr,globalErrorHandler as dr,unrefTimer as vr}from"/v135/@opentelemetry/core@1.17.0/denonext/core.mjs";import{diag as yr}from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";var lr=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),P=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(c){try{a(n.next(c))}catch(f){u(f)}}function l(c){try{a(n.throw(c))}catch(f){u(f)}}function a(c){c.done?i(c.value):o(c.value).then(s,l)}a((n=n.apply(r,t||[])).next())})},C=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},fr=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},hr=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},gr=function(r){lr(t,r);function t(e){var n,o,i,u,s=r.call(this,{aggregationSelector:(n=e.exporter.selectAggregation)===null||n===void 0?void 0:n.bind(e.exporter),aggregationTemporalitySelector:(o=e.exporter.selectAggregationTemporality)===null||o===void 0?void 0:o.bind(e.exporter),metricProducers:e.metricProducers})||this;if(e.exportIntervalMillis!==void 0&&e.exportIntervalMillis<=0)throw Error("exportIntervalMillis must be greater than 0");if(e.exportTimeoutMillis!==void 0&&e.exportTimeoutMillis<=0)throw Error("exportTimeoutMillis must be greater than 0");if(e.exportTimeoutMillis!==void 0&&e.exportIntervalMillis!==void 0&&e.exportIntervalMillis<e.exportTimeoutMillis)throw Error("exportIntervalMillis must be greater than or equal to exportTimeoutMillis");return s._exportInterval=(i=e.exportIntervalMillis)!==null&&i!==void 0?i:6e4,s._exportTimeout=(u=e.exportTimeoutMillis)!==null&&u!==void 0?u:3e4,s._exporter=e.exporter,s}return t.prototype._runOnce=function(){return P(this,void 0,void 0,function(){var e;return C(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,w(this._doRun(),this._exportTimeout)];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),e instanceof k?(lt.diag.error("Export took longer than %s milliseconds and timed out.",this._exportTimeout),[2]):(dr(e),[3,3]);case 3:return[2]}})})},t.prototype._doRun=function(){var e,n;return P(this,void 0,void 0,function(){var o,i,u,s,l,a=this;return C(this,function(c){switch(c.label){case 0:return[4,this.collect({timeoutMillis:this._exportTimeout})];case 1:return o=c.sent(),i=o.resourceMetrics,u=o.errors,u.length>0&&(l=lt.diag).error.apply(l,hr(["PeriodicExportingMetricReader: metrics collection errors"],fr(u),!1)),s=function(){return P(a,void 0,void 0,function(){var f;return C(this,function(p){switch(p.label){case 0:return[4,pr._export(this._exporter,i)];case 1:if(f=p.sent(),f.code!==mr.SUCCESS)throw new Error("PeriodicExportingMetricReader: metrics export failed (error "+f.error+")");return[2]}})})},i.resource.asyncAttributesPending?((n=(e=i.resource).waitForAsyncAttributes)===null||n===void 0||n.call(e).then(s,function(f){return yr.debug("Error while resolving async portion of resource: ",f)}),[3,4]):[3,2];case 2:return[4,s()];case 3:c.sent(),c.label=4;case 4:return[2]}})})},t.prototype.onInitialized=function(){var e=this;this._interval=setInterval(function(){e._runOnce()},this._exportInterval),vr(this._interval)},t.prototype.onForceFlush=function(){return P(this,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return[4,this._runOnce()];case 1:return e.sent(),[4,this._exporter.forceFlush()];case 2:return e.sent(),[2]}})})},t.prototype.onShutdown=function(){return P(this,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return this._interval&&clearInterval(this._interval),[4,this._exporter.shutdown()];case 1:return e.sent(),[2]}})})},t}(ct);import{ExportResultCode as ne}from"/v135/@opentelemetry/core@1.17.0/denonext/core.mjs";var _r=function(){function r(t){this._shutdown=!1,this._metrics=[],this._aggregationTemporality=t}return r.prototype.export=function(t,e){if(this._shutdown){setTimeout(function(){return e({code:ne.FAILED})},0);return}this._metrics.push(t),setTimeout(function(){return e({code:ne.SUCCESS})},0)},r.prototype.getMetrics=function(){return this._metrics},r.prototype.forceFlush=function(){return Promise.resolve()},r.prototype.reset=function(){this._metrics=[]},r.prototype.selectAggregationTemporality=function(t){return this._aggregationTemporality},r.prototype.shutdown=function(){return this._shutdown=!0,Promise.resolve()},r}();import{ExportResultCode as oe}from"/v135/@opentelemetry/core@1.17.0/denonext/core.mjs";var ie=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},wr=function(){function r(t){var e;this._shutdown=!1,this._temporalitySelector=(e=t?.temporalitySelector)!==null&&e!==void 0?e:H}return r.prototype.export=function(t,e){if(this._shutdown){__setImmediate$(e,{code:oe.FAILED});return}return r._sendMetrics(t,e)},r.prototype.forceFlush=function(){return Promise.resolve()},r.prototype.selectAggregationTemporality=function(t){return this._temporalitySelector(t)},r.prototype.shutdown=function(){return this._shutdown=!0,Promise.resolve()},r._sendMetrics=function(t,e){var n,o,i,u;try{for(var s=ie(t.scopeMetrics),l=s.next();!l.done;l=s.next()){var a=l.value;try{for(var c=(i=void 0,ie(a.metrics)),f=c.next();!f.done;f=c.next()){var p=f.value;console.dir({descriptor:p.descriptor,dataPointType:p.dataPointType,dataPoints:p.dataPoints})}}catch(g){i={error:g}}finally{try{f&&!f.done&&(u=c.return)&&u.call(c)}finally{if(i)throw i.error}}}}catch(g){n={error:g}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}e({code:oe.SUCCESS})},r}();import{diag as wt,createNoopMeter as zr}from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";import{Resource as ke}from"/v135/@opentelemetry/resources@1.17.0/denonext/resources.mjs";var ae=function(){function r(){this._registeredViews=[]}return r.prototype.addView=function(t){this._registeredViews.push(t)},r.prototype.findViews=function(t,e){var n=this,o=this._registeredViews.filter(function(i){return n._matchInstrument(i.instrumentSelector,t)&&n._matchMeter(i.meterSelector,e)});return o},r.prototype._matchInstrument=function(t,e){return(t.getType()===void 0||e.type===t.getType())&&t.getNameFilter().match(e.name)&&t.getUnitFilter().match(e.unit)},r.prototype._matchMeter=function(t,e){return t.getNameFilter().match(e.name)&&(e.version===void 0||t.getVersionFilter().match(e.version))&&(e.schemaUrl===void 0||t.getSchemaUrlFilter().match(e.schemaUrl))},r}();import{context as br,diag as D,ValueType as Sr}from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";import{millisToHrTime as xr}from"/v135/@opentelemetry/core@1.17.0/denonext/core.mjs";var M=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),ft=function(){function r(t,e){this._writableMetricStorage=t,this._descriptor=e}return r.prototype._record=function(t,e,n){if(e===void 0&&(e={}),n===void 0&&(n=br.active()),typeof t!="number"){D.warn("non-number value provided to metric "+this._descriptor.name+": "+t);return}this._descriptor.valueType===Sr.INT&&!Number.isInteger(t)&&(D.warn("INT value type cannot accept a floating-point value for "+this._descriptor.name+", ignoring the fractional digits."),t=Math.trunc(t),!Number.isInteger(t))||this._writableMetricStorage.record(t,e,n,xr(Date.now()))},r}();var ue=function(r){M(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.add=function(e,n,o){this._record(e,n,o)},t}(ft);var se=function(r){M(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.add=function(e,n,o){if(e<0){D.warn("negative value provided to counter "+this._descriptor.name+": "+e);return}this._record(e,n,o)},t}(ft);var ce=function(r){M(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.record=function(e,n,o){if(e<0){D.warn("negative value provided to histogram "+this._descriptor.name+": "+e);return}this._record(e,n,o)},t}(ft);var j=function(){function r(t,e,n){this._observableRegistry=n,this._descriptor=t,this._metricStorages=e}return r.prototype.addCallback=function(t){this._observableRegistry.addCallback(t,this)},r.prototype.removeCallback=function(t){this._observableRegistry.removeCallback(t,this)},r}();var le=function(r){M(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(j);var fe=function(r){M(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(j);var he=function(r){M(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(j);function R(r){return r instanceof j}var pe=function(){function r(t){this._meterSharedState=t}return r.prototype.createHistogram=function(t,e){var n=_(t,h.HISTOGRAM,e),o=this._meterSharedState.registerMetricStorage(n);return new ce(o,n)},r.prototype.createCounter=function(t,e){var n=_(t,h.COUNTER,e),o=this._meterSharedState.registerMetricStorage(n);return new se(o,n)},r.prototype.createUpDownCounter=function(t,e){var n=_(t,h.UP_DOWN_COUNTER,e),o=this._meterSharedState.registerMetricStorage(n);return new ue(o,n)},r.prototype.createObservableGauge=function(t,e){var n=_(t,h.OBSERVABLE_GAUGE,e),o=this._meterSharedState.registerAsyncMetricStorage(n);return new fe(n,o,this._meterSharedState.observableRegistry)},r.prototype.createObservableCounter=function(t,e){var n=_(t,h.OBSERVABLE_COUNTER,e),o=this._meterSharedState.registerAsyncMetricStorage(n);return new le(n,o,this._meterSharedState.observableRegistry)},r.prototype.createObservableUpDownCounter=function(t,e){var n=_(t,h.OBSERVABLE_UP_DOWN_COUNTER,e),o=this._meterSharedState.registerAsyncMetricStorage(n);return new he(n,o,this._meterSharedState.observableRegistry)},r.prototype.addBatchObservableCallback=function(t,e){this._meterSharedState.observableRegistry.addBatchCallback(t,e)},r.prototype.removeBatchObservableCallback=function(t,e){this._meterSharedState.observableRegistry.removeBatchCallback(t,e)},r}();var z=function(){function r(t){this._instrumentDescriptor=t}return r.prototype.getInstrumentDescriptor=function(){return this._instrumentDescriptor},r.prototype.updateDescription=function(t){this._instrumentDescriptor=_(this._instrumentDescriptor.name,this._instrumentDescriptor.type,{description:t,valueType:this._instrumentDescriptor.valueType,unit:this._instrumentDescriptor.unit})},r}();var Mr=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),me=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Ar=function(){function r(t){this._hash=t,this._valueMap=new Map,this._keyMap=new Map}return r.prototype.get=function(t,e){return e??(e=this._hash(t)),this._valueMap.get(e)},r.prototype.getOrDefault=function(t,e){var n=this._hash(t);if(this._valueMap.has(n))return this._valueMap.get(n);var o=e();return this._keyMap.has(n)||this._keyMap.set(n,t),this._valueMap.set(n,o),o},r.prototype.set=function(t,e,n){n??(n=this._hash(t)),this._keyMap.has(n)||this._keyMap.set(n,t),this._valueMap.set(n,e)},r.prototype.has=function(t,e){return e??(e=this._hash(t)),this._valueMap.has(e)},r.prototype.keys=function(){var t,e;return me(this,function(n){switch(n.label){case 0:t=this._keyMap.entries(),e=t.next(),n.label=1;case 1:return e.done===!0?[3,3]:[4,[e.value[1],e.value[0]]];case 2:return n.sent(),e=t.next(),[3,1];case 3:return[2]}})},r.prototype.entries=function(){var t,e;return me(this,function(n){switch(n.label){case 0:t=this._valueMap.entries(),e=t.next(),n.label=1;case 1:return e.done===!0?[3,3]:[4,[this._keyMap.get(e.value[0]),e.value[1],e.value[0]]];case 2:return n.sent(),e=t.next(),[3,1];case 3:return[2]}})},Object.defineProperty(r.prototype,"size",{get:function(){return this._valueMap.size},enumerable:!1,configurable:!0}),r}();var y=function(r){Mr(t,r);function t(){return r.call(this,Mt)||this}return t}(Ar);var Tr=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},W=function(){function r(t){this._aggregator=t,this._activeCollectionStorage=new y,this._cumulativeMemoStorage=new y}return r.prototype.record=function(t,e,n,o){var i=this,u=this._activeCollectionStorage.getOrDefault(e,function(){return i._aggregator.createAccumulation(o)});u?.record(t)},r.prototype.batchCumulate=function(t,e){var n=this;Array.from(t.entries()).forEach(function(o){var i=Tr(o,3),u=i[0],s=i[1],l=i[2],a=n._aggregator.createAccumulation(e);a?.record(s);var c=a;if(n._cumulativeMemoStorage.has(u,l)){var f=n._cumulativeMemoStorage.get(u,l);c=n._aggregator.diff(f,a)}if(n._activeCollectionStorage.has(u,l)){var p=n._activeCollectionStorage.get(u,l);c=n._aggregator.merge(p,c)}n._cumulativeMemoStorage.set(u,a,l),n._activeCollectionStorage.set(u,c,l)})},r.prototype.collect=function(){var t=this._activeCollectionStorage;return this._activeCollectionStorage=new y,t},r}();var de=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ve=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},X=function(){function r(t){this._aggregator=t,this._unreportedAccumulations=new Map,this._reportHistory=new Map}return r.prototype.buildMetrics=function(t,e,n,o,i){this._stashAccumulations(e,o);var u=this._getMergedUnreportedAccumulations(t),s=u,l;if(this._reportHistory.has(t)){var a=this._reportHistory.get(t),c=a.collectionTime;l=a.aggregationTemporality,l===S.CUMULATIVE?s=r.merge(a.accumulations,u,this._aggregator):s=r.calibrateStartTime(a.accumulations,u,c)}else l=t.selectAggregationTemporality(n.type);return this._reportHistory.set(t,{accumulations:s,collectionTime:i,aggregationTemporality:l}),this._aggregator.toMetricData(n,l,Er(s),i)},r.prototype._stashAccumulations=function(t,e){var n=this;t.forEach(function(o){var i=n._unreportedAccumulations.get(o);i===void 0&&(i=[],n._unreportedAccumulations.set(o,i)),i.push(e)})},r.prototype._getMergedUnreportedAccumulations=function(t){var e,n,o=new y,i=this._unreportedAccumulations.get(t);if(this._unreportedAccumulations.set(t,[]),i===void 0)return o;try{for(var u=de(i),s=u.next();!s.done;s=u.next()){var l=s.value;o=r.merge(o,l,this._aggregator)}}catch(a){e={error:a}}finally{try{s&&!s.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return o},r.merge=function(t,e,n){for(var o=t,i=e.entries(),u=i.next();u.done!==!0;){var s=ve(u.value,3),l=s[0],a=s[1],c=s[2];if(t.has(l,c)){var f=t.get(l,c),p=n.merge(f,a);o.set(l,p,c)}else o.set(l,a,c);u=i.next()}return o},r.calibrateStartTime=function(t,e,n){var o,i;try{for(var u=de(t.keys()),s=u.next();!s.done;s=u.next()){var l=ve(s.value,2),a=l[0],c=l[1],f=e.get(a,c);f?.setStartTime(n)}}catch(p){o={error:p}}finally{try{s&&!s.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}return e},r}();function Er(r){return Array.from(r.entries())}var Or=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ir=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},ye=function(r){Or(t,r);function t(e,n,o){var i=r.call(this,e)||this;return i._attributesProcessor=o,i._deltaMetricStorage=new W(n),i._temporalMetricStorage=new X(n),i}return t.prototype.record=function(e,n){var o=this,i=new y;Array.from(e.entries()).forEach(function(u){var s=Ir(u,2),l=s[0],a=s[1];i.set(o._attributesProcessor.process(l),a)}),this._deltaMetricStorage.batchCumulate(i,n)},t.prototype.collect=function(e,n,o){var i=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(e,n,this._instrumentDescriptor,i,o)},t}(z);import*as dt from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";function ht(r,t){var e="";return r.unit!==t.unit&&(e+="	- Unit '"+r.unit+"' does not match '"+t.unit+`'
`),r.type!==t.type&&(e+="	- Type '"+r.type+"' does not match '"+t.type+`'
`),r.valueType!==t.valueType&&(e+="	- Value Type '"+r.valueType+"' does not match '"+t.valueType+`'
`),r.description!==t.description&&(e+="	- Description '"+r.description+"' does not match '"+t.description+`'
`),e}function Nr(r,t){return"	- use valueType '"+r.valueType+"' on instrument creation or use an instrument name other than '"+t.name+"'"}function Pr(r,t){return"	- use unit '"+r.unit+"' on instrument creation or use an instrument name other than '"+t.name+"'"}function Cr(r,t){var e={name:t.name,type:t.type,unit:t.unit},n=JSON.stringify(e);return"	- create a new view with a name other than '"+r.name+"' and InstrumentSelector '"+n+"'"}function Rr(r,t){var e={name:t.name,type:t.type,unit:t.unit},n=JSON.stringify(e);return"	- create a new view with a name other than '"+r.name+"' and InstrumentSelector '"+n+`'
    	- OR - create a new view with the name `+r.name+" and description '"+r.description+"' and InstrumentSelector "+n+`
    	- OR - create a new view with the name `+t.name+" and description '"+r.description+"' and InstrumentSelector "+n}function pt(r,t){return r.valueType!==t.valueType?Nr(r,t):r.unit!==t.unit?Pr(r,t):r.type!==t.type?Cr(r,t):r.description!==t.description?Rr(r,t):""}var mt=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ge=function(){function r(){this._sharedRegistry=new Map,this._perCollectorRegistry=new Map}return r.create=function(){return new r},r.prototype.getStorages=function(t){var e,n,o,i,u=[];try{for(var s=mt(this._sharedRegistry.values()),l=s.next();!l.done;l=s.next()){var a=l.value;u=u.concat(a)}}catch(g){e={error:g}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}var c=this._perCollectorRegistry.get(t);if(c!=null)try{for(var f=mt(c.values()),p=f.next();!p.done;p=f.next()){var a=p.value;u=u.concat(a)}}catch(g){o={error:g}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}return u},r.prototype.register=function(t){this._registerStorage(t,this._sharedRegistry)},r.prototype.registerForCollector=function(t,e){var n=this._perCollectorRegistry.get(t);n==null&&(n=new Map,this._perCollectorRegistry.set(t,n)),this._registerStorage(e,n)},r.prototype.findOrUpdateCompatibleStorage=function(t){var e=this._sharedRegistry.get(t.name);return e===void 0?null:this._findOrUpdateCompatibleStorage(t,e)},r.prototype.findOrUpdateCompatibleCollectorStorage=function(t,e){var n=this._perCollectorRegistry.get(t);if(n===void 0)return null;var o=n.get(e.name);return o===void 0?null:this._findOrUpdateCompatibleStorage(e,o)},r.prototype._registerStorage=function(t,e){var n=t.getInstrumentDescriptor(),o=e.get(n.name);if(o===void 0){e.set(n.name,[t]);return}o.push(t)},r.prototype._findOrUpdateCompatibleStorage=function(t,e){var n,o,i=null;try{for(var u=mt(e),s=u.next();!s.done;s=u.next()){var l=s.value,a=l.getInstrumentDescriptor();Rt(a,t)?(a.description!==t.description&&(t.description.length>a.description.length&&l.updateDescription(t.description),dt.diag.warn("A view or instrument with the name ",t.name,` has already been registered, but has a different description and is incompatible with another registered view.
`,`Details:
`,ht(a,t),`The longer description will be used.
To resolve the conflict:`,pt(a,t))),i=l):dt.diag.warn("A view or instrument with the name ",t.name,` has already been registered and is incompatible with another registered view.
`,`Details:
`,ht(a,t),`To resolve the conflict:
`,pt(a,t))}}catch(c){n={error:c}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return i},r}();var _e=function(){function r(t){this._backingStorages=t}return r.prototype.record=function(t,e,n,o){this._backingStorages.forEach(function(i){i.record(t,e,n,o)})},r}();import{diag as kr}from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";import{diag as q,ValueType as we}from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";var be=function(){function r(t){this._descriptor=t,this._buffer=new y}return r.prototype.observe=function(t,e){if(e===void 0&&(e={}),typeof t!="number"){q.warn("non-number value provided to metric "+this._descriptor.name+": "+t);return}this._descriptor.valueType===we.INT&&!Number.isInteger(t)&&(q.warn("INT value type cannot accept a floating-point value for "+this._descriptor.name+", ignoring the fractional digits."),t=Math.trunc(t),!Number.isInteger(t))||this._buffer.set(e,t)},r}();var Se=function(){function r(){this._buffer=new Map}return r.prototype.observe=function(t,e,n){if(n===void 0&&(n={}),!!R(t)){var o=this._buffer.get(t);if(o==null&&(o=new y,this._buffer.set(t,o)),typeof e!="number"){q.warn("non-number value provided to metric "+t._descriptor.name+": "+e);return}t._descriptor.valueType===we.INT&&!Number.isInteger(e)&&(q.warn("INT value type cannot accept a floating-point value for "+t._descriptor.name+", ignoring the fractional digits."),e=Math.trunc(e),!Number.isInteger(e))||o.set(n,e)}},r}();var vt=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(c){try{a(n.next(c))}catch(f){u(f)}}function l(c){try{a(n.throw(c))}catch(f){u(f)}}function a(c){c.done?i(c.value):o(c.value).then(s,l)}a((n=n.apply(r,t||[])).next())})},yt=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},xe=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},Me=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},Ae=function(){function r(){this._callbacks=[],this._batchCallbacks=[]}return r.prototype.addCallback=function(t,e){var n=this._findCallback(t,e);n>=0||this._callbacks.push({callback:t,instrument:e})},r.prototype.removeCallback=function(t,e){var n=this._findCallback(t,e);n<0||this._callbacks.splice(n,1)},r.prototype.addBatchCallback=function(t,e){var n=new Set(e.filter(R));if(n.size===0){kr.error("BatchObservableCallback is not associated with valid instruments",e);return}var o=this._findBatchCallback(t,n);o>=0||this._batchCallbacks.push({callback:t,instruments:n})},r.prototype.removeBatchCallback=function(t,e){var n=new Set(e.filter(R)),o=this._findBatchCallback(t,n);o<0||this._batchCallbacks.splice(o,1)},r.prototype.observe=function(t,e){return vt(this,void 0,void 0,function(){var n,o,i,u;return yt(this,function(s){switch(s.label){case 0:return n=this._observeCallbacks(t,e),o=this._observeBatchCallbacks(t,e),[4,Tt(Me(Me([],xe(n),!1),xe(o),!1))];case 1:return i=s.sent(),u=i.filter(Et).map(function(l){return l.reason}),[2,u]}})})},r.prototype._observeCallbacks=function(t,e){var n=this;return this._callbacks.map(function(o){var i=o.callback,u=o.instrument;return vt(n,void 0,void 0,function(){var s,l;return yt(this,function(a){switch(a.label){case 0:return s=new be(u._descriptor),l=Promise.resolve(i(s)),e!=null&&(l=w(l,e)),[4,l];case 1:return a.sent(),u._metricStorages.forEach(function(c){c.record(s._buffer,t)}),[2]}})})})},r.prototype._observeBatchCallbacks=function(t,e){var n=this;return this._batchCallbacks.map(function(o){var i=o.callback,u=o.instruments;return vt(n,void 0,void 0,function(){var s,l;return yt(this,function(a){switch(a.label){case 0:return s=new Se,l=Promise.resolve(i(s)),e!=null&&(l=w(l,e)),[4,l];case 1:return a.sent(),u.forEach(function(c){var f=s._buffer.get(c);f!=null&&c._metricStorages.forEach(function(p){p.record(f,t)})}),[2]}})})})},r.prototype._findCallback=function(t,e){return this._callbacks.findIndex(function(n){return n.callback===t&&n.instrument===e})},r.prototype._findBatchCallback=function(t,e){return this._batchCallbacks.findIndex(function(n){return n.callback===t&&Ot(n.instruments,e)})},r}();var Ur=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Te=function(r){Ur(t,r);function t(e,n,o){var i=r.call(this,e)||this;return i._attributesProcessor=o,i._deltaMetricStorage=new W(n),i._temporalMetricStorage=new X(n),i}return t.prototype.record=function(e,n,o,i){n=this._attributesProcessor.process(n,o),this._deltaMetricStorage.record(e,n,o,i)},t.prototype.collect=function(e,n,o){var i=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(e,n,this._instrumentDescriptor,i,o)},t}(z);var Ee=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),A=function(){function r(){}return r.Noop=function(){return Lr},r}();var Br=function(r){Ee(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.process=function(e,n){return e},t}(A);var Oe=function(r){Ee(t,r);function t(e){var n=r.call(this)||this;return n._allowedAttributeNames=e,n}return t.prototype.process=function(e,n){var o=this,i={};return Object.keys(e).filter(function(u){return o._allowedAttributeNames.includes(u)}).forEach(function(u){return i[u]=e[u]}),i},t}(A);var Lr=new Br;var Vr=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(c){try{a(n.next(c))}catch(f){u(f)}}function l(c){try{a(n.throw(c))}catch(f){u(f)}}function a(c){c.done?i(c.value):o(c.value).then(s,l)}a((n=n.apply(r,t||[])).next())})},Gr=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Fr=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},Ie=function(){function r(t,e){this._meterProviderSharedState=t,this._instrumentationScope=e,this.metricStorageRegistry=new ge,this.observableRegistry=new Ae,this.meter=new pe(this)}return r.prototype.registerMetricStorage=function(t){var e=this._registerMetricStorage(t,Te);return e.length===1?e[0]:new _e(e)},r.prototype.registerAsyncMetricStorage=function(t){var e=this._registerMetricStorage(t,ye);return e},r.prototype.collect=function(t,e,n){return Vr(this,void 0,void 0,function(){var o,i,u=this;return Gr(this,function(s){switch(s.label){case 0:return[4,this.observableRegistry.observe(e,n?.timeoutMillis)];case 1:return o=s.sent(),i=Array.from(this.metricStorageRegistry.getStorages(t)).map(function(l){return l.collect(t,u._meterProviderSharedState.metricCollectors,e)}).filter($),[2,{scopeMetrics:{scope:this._instrumentationScope,metrics:i.filter($)},errors:o}]}})})},r.prototype._registerMetricStorage=function(t,e){var n=this,o=this._meterProviderSharedState.viewRegistry.findViews(t,this._instrumentationScope),i=o.map(function(l){var a=Ct(l,t),c=n.metricStorageRegistry.findOrUpdateCompatibleStorage(a);if(c!=null)return c;var f=l.aggregation.createAggregator(a),p=new e(a,f,l.attributesProcessor);return n.metricStorageRegistry.register(p),p});if(i.length===0){var u=this._meterProviderSharedState.selectAggregations(t.type),s=u.map(function(l){var a=Fr(l,2),c=a[0],f=a[1],p=n.metricStorageRegistry.findOrUpdateCompatibleCollectorStorage(c,t);if(p!=null)return p;var g=f.createAggregator(t),bt=new e(t,g,A.Noop());return n.metricStorageRegistry.registerForCollector(c,bt),bt});i=i.concat(s)}return i},r}();var Hr=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ne=function(){function r(t){this.resource=t,this.viewRegistry=new ae,this.metricCollectors=[],this.meterSharedStates=new Map}return r.prototype.getMeterSharedState=function(t){var e=At(t),n=this.meterSharedStates.get(e);return n==null&&(n=new Ie(this,t),this.meterSharedStates.set(e,n)),n},r.prototype.selectAggregations=function(t){var e,n,o=[];try{for(var i=Hr(this.metricCollectors),u=i.next();!u.done;u=i.next()){var s=u.value;o.push([s,s.selectAggregation(t)])}}catch(l){e={error:l}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return o},r}();import{millisToHrTime as Dr}from"/v135/@opentelemetry/core@1.17.0/denonext/core.mjs";var gt=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(c){try{a(n.next(c))}catch(f){u(f)}}function l(c){try{a(n.throw(c))}catch(f){u(f)}}function a(c){c.done?i(c.value):o(c.value).then(s,l)}a((n=n.apply(r,t||[])).next())})},_t=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Pe=function(){function r(t,e){this._sharedState=t,this._metricReader=e}return r.prototype.collect=function(t){return gt(this,void 0,void 0,function(){var e,n,o,i=this;return _t(this,function(u){switch(u.label){case 0:return e=Dr(Date.now()),n=Array.from(this._sharedState.meterSharedStates.values()).map(function(s){return s.collect(i,e,t)}),[4,Promise.all(n)];case 1:return o=u.sent(),[2,{resourceMetrics:{resource:this._sharedState.resource,scopeMetrics:o.map(function(s){return s.scopeMetrics})},errors:E(o,function(s){return s.errors})}]}})})},r.prototype.forceFlush=function(t){return gt(this,void 0,void 0,function(){return _t(this,function(e){switch(e.label){case 0:return[4,this._metricReader.forceFlush(t)];case 1:return e.sent(),[2]}})})},r.prototype.shutdown=function(t){return gt(this,void 0,void 0,function(){return _t(this,function(e){switch(e.label){case 0:return[4,this._metricReader.shutdown(t)];case 1:return e.sent(),[2]}})})},r.prototype.selectAggregationTemporality=function(t){return this._metricReader.selectAggregationTemporality(t)},r.prototype.selectAggregation=function(t){return this._metricReader.selectAggregation(t)},r}();var Ce=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(c){try{a(n.next(c))}catch(f){u(f)}}function l(c){try{a(n.throw(c))}catch(f){u(f)}}function a(c){c.done?i(c.value):o(c.value).then(s,l)}a((n=n.apply(r,t||[])).next())})},Re=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(c){return l([a,c])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(c){a=[6,c],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},jr=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Wr=function(){function r(t){var e,n,o;this._shutdown=!1;var i=ke.default().merge((o=t?.resource)!==null&&o!==void 0?o:ke.empty());if(this._sharedState=new Ne(i),t?.views!=null&&t.views.length>0)try{for(var u=jr(t.views),s=u.next();!s.done;s=u.next()){var l=s.value;this._sharedState.viewRegistry.addView(l)}}catch(a){e={error:a}}finally{try{s&&!s.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}}return r.prototype.getMeter=function(t,e,n){return e===void 0&&(e=""),n===void 0&&(n={}),this._shutdown?(wt.warn("A shutdown MeterProvider cannot provide a Meter"),zr()):this._sharedState.getMeterSharedState({name:t,version:e,schemaUrl:n.schemaUrl}).meter},r.prototype.addMetricReader=function(t){var e=new Pe(this._sharedState,t);t.setMetricProducer(e),this._sharedState.metricCollectors.push(e)},r.prototype.shutdown=function(t){return Ce(this,void 0,void 0,function(){return Re(this,function(e){switch(e.label){case 0:return this._shutdown?(wt.warn("shutdown may only be called once per MeterProvider"),[2]):(this._shutdown=!0,[4,Promise.all(this._sharedState.metricCollectors.map(function(n){return n.shutdown(t)}))]);case 1:return e.sent(),[2]}})})},r.prototype.forceFlush=function(t){return Ce(this,void 0,void 0,function(){return Re(this,function(e){switch(e.label){case 0:return this._shutdown?(wt.warn("invalid attempt to force flush after MeterProvider shutdown"),[2]):[4,Promise.all(this._sharedState.metricCollectors.map(function(n){return n.forceFlush(t)}))];case 1:return e.sent(),[2]}})})},r}();var Xr=/[\^$\\.+?()[\]{}|]/g,Y=function(){function r(t){t==="*"?(this._matchAll=!0,this._regexp=/.*/):(this._matchAll=!1,this._regexp=new RegExp(r.escapePattern(t)))}return r.prototype.match=function(t){return this._matchAll?!0:this._regexp.test(t)},r.escapePattern=function(t){return"^"+t.replace(Xr,"\\$&").replace("*",".*")+"$"},r.hasWildcard=function(t){return t.includes("*")},r}();var T=function(){function r(t){this._matchAll=t===void 0,this._pattern=t}return r.prototype.match=function(t){return!!(this._matchAll||t===this._pattern)},r}();var Ue=function(){function r(t){var e;this._nameFilter=new Y((e=t?.name)!==null&&e!==void 0?e:"*"),this._type=t?.type,this._unitFilter=new T(t?.unit)}return r.prototype.getType=function(){return this._type},r.prototype.getNameFilter=function(){return this._nameFilter},r.prototype.getUnitFilter=function(){return this._unitFilter},r}();var Be=function(){function r(t){this._nameFilter=new T(t?.name),this._versionFilter=new T(t?.version),this._schemaUrlFilter=new T(t?.schemaUrl)}return r.prototype.getNameFilter=function(){return this._nameFilter},r.prototype.getVersionFilter=function(){return this._versionFilter},r.prototype.getSchemaUrlFilter=function(){return this._schemaUrlFilter},r}();function qr(r){return r.instrumentName==null&&r.instrumentType==null&&r.instrumentUnit==null&&r.meterName==null&&r.meterVersion==null&&r.meterSchemaUrl==null}var Yr=function(){function r(t){var e;if(qr(t))throw new Error("Cannot create view with no selector arguments supplied");if(t.name!=null&&(t?.instrumentName==null||Y.hasWildcard(t.instrumentName)))throw new Error("Views with a specified name must be declared with an instrument selector that selects at most one instrument per meter.");t.attributeKeys!=null?this.attributesProcessor=new Oe(t.attributeKeys):this.attributesProcessor=A.Noop(),this.name=t.name,this.description=t.description,this.aggregation=(e=t.aggregation)!==null&&e!==void 0?e:d.Default(),this.instrumentSelector=new Ue({name:t.instrumentName,type:t.instrumentType,unit:t.instrumentUnit}),this.meterSelector=new Be({name:t.meterName,version:t.meterVersion,schemaUrl:t.meterSchemaUrl})}return r}();export{d as Aggregation,S as AggregationTemporality,wr as ConsoleMetricExporter,v as DataPointType,Jt as DefaultAggregation,Wt as DropAggregation,ar as ExplicitBucketHistogramAggregation,$t as ExponentialHistogramAggregation,Yt as HistogramAggregation,_r as InMemoryMetricExporter,h as InstrumentType,qt as LastValueAggregation,Wr as MeterProvider,ct as MetricReader,gr as PeriodicExportingMetricReader,Xt as SumAggregation,k as TimeoutError,Yr as View};
//# sourceMappingURL=sdk-metrics.mjs.map