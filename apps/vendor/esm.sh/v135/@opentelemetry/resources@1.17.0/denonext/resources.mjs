/* esm.sh - esbuild bundle(@opentelemetry/resources@1.17.0) denonext production */
import{diag as R}from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";import{SemanticResourceAttributes as d}from"/v135/@opentelemetry/semantic-conventions@1.17.0/denonext/semantic-conventions.mjs";import{SDK_INFO as E}from"/v135/@opentelemetry/core@1.17.0/denonext/core.mjs";function w(){return"unknown_service"}var I=function(){function n(){}return n.prototype.detect=function(){return new l({})},n}();var m=new I;var L=function(){function n(){}return n.prototype.detect=function(){return Promise.resolve(m.detect())},n}();var h=new L;var Q=h;var et=h;var ot=m;var ct=m;var ft=h;var ht=h;var y=function(){return y=Object.assign||function(n){for(var r,t=1,u=arguments.length;t<u;t++){r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])}return n},y.apply(this,arguments)},M=function(n,r,t,u){function i(e){return e instanceof t?e:new t(function(c){c(e)})}return new(t||(t=Promise))(function(e,c){function s(a){try{o(u.next(a))}catch(v){c(v)}}function f(a){try{o(u.throw(a))}catch(v){c(v)}}function o(a){a.done?e(a.value):i(a.value).then(s,f)}o((u=u.apply(n,r||[])).next())})},P=function(n,r){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,i,e,c;return c={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function s(o){return function(a){return f([o,a])}}function f(o){if(u)throw new TypeError("Generator is already executing.");for(;t;)try{if(u=1,i&&(e=o[0]&2?i.return:o[0]?i.throw||((e=i.return)&&e.call(i),0):i.next)&&!(e=e.call(i,o[1])).done)return e;switch(i=0,e&&(o=[o[0]&2,e.value]),o[0]){case 0:case 1:e=o;break;case 4:return t.label++,{value:o[1],done:!1};case 5:t.label++,i=o[1],o=[0];continue;case 7:o=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(o[0]===6||o[0]===2)){t=0;continue}if(o[0]===3&&(!e||o[1]>e[0]&&o[1]<e[3])){t.label=o[1];break}if(o[0]===6&&t.label<e[1]){t.label=e[1],e=o;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(o);break}e[2]&&t.ops.pop(),t.trys.pop();continue}o=r.call(n,t)}catch(a){o=[6,a],i=0}finally{u=e=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},V=function(n,r){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var u=t.call(n),i,e=[],c;try{for(;(r===void 0||r-- >0)&&!(i=u.next()).done;)e.push(i.value)}catch(s){c={error:s}}finally{try{i&&!i.done&&(t=u.return)&&t.call(u)}finally{if(c)throw c.error}}return e},l=function(){function n(r,t){var u=this,i;this._attributes=r,this.asyncAttributesPending=t!=null,this._syncAttributes=(i=this._attributes)!==null&&i!==void 0?i:{},this._asyncAttributesPromise=t?.then(function(e){return u._attributes=Object.assign({},u._attributes,e),u.asyncAttributesPending=!1,e},function(e){return R.debug("a resource's async attributes promise rejected: %s",e),u.asyncAttributesPending=!1,{}})}return n.empty=function(){return n.EMPTY},n.default=function(){var r;return new n((r={},r[d.SERVICE_NAME]=w(),r[d.TELEMETRY_SDK_LANGUAGE]=E[d.TELEMETRY_SDK_LANGUAGE],r[d.TELEMETRY_SDK_NAME]=E[d.TELEMETRY_SDK_NAME],r[d.TELEMETRY_SDK_VERSION]=E[d.TELEMETRY_SDK_VERSION],r))},Object.defineProperty(n.prototype,"attributes",{get:function(){var r;return this.asyncAttributesPending&&R.error("Accessing resource attributes before async attributes settled"),(r=this._attributes)!==null&&r!==void 0?r:{}},enumerable:!1,configurable:!0}),n.prototype.waitForAsyncAttributes=function(){return M(this,void 0,void 0,function(){return P(this,function(r){switch(r.label){case 0:return this.asyncAttributesPending?[4,this._asyncAttributesPromise]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},n.prototype.merge=function(r){var t=this,u;if(!r)return this;var i=y(y({},this._syncAttributes),(u=r._syncAttributes)!==null&&u!==void 0?u:r.attributes);if(!this._asyncAttributesPromise&&!r._asyncAttributesPromise)return new n(i);var e=Promise.all([this._asyncAttributesPromise,r._asyncAttributesPromise]).then(function(c){var s,f=V(c,2),o=f[0],a=f[1];return y(y(y(y({},t._syncAttributes),o),(s=r._syncAttributes)!==null&&s!==void 0?s:r.attributes),a)});return new n(i,e)},n.EMPTY=new n({}),n}();var C=function(){function n(){}return n.prototype.detect=function(r){return Promise.resolve(x.detect(r))},n}(),St=new C;import{diag as j}from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";import{getEnv as B}from"/v135/@opentelemetry/core@1.17.0/denonext/core.mjs";import{SemanticResourceAttributes as Y}from"/v135/@opentelemetry/semantic-conventions@1.17.0/denonext/semantic-conventions.mjs";var G=function(n){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&n[r],u=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&u>=n.length&&(n=void 0),{value:n&&n[u++],done:!n}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},U=function(n,r){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var u=t.call(n),i,e=[],c;try{for(;(r===void 0||r-- >0)&&!(i=u.next()).done;)e.push(i.value)}catch(s){c={error:s}}finally{try{i&&!i.done&&(t=u.return)&&t.call(u)}finally{if(c)throw c.error}}return e},k=function(){function n(){this._MAX_LENGTH=255,this._COMMA_SEPARATOR=",",this._LABEL_KEY_VALUE_SPLITTER="=",this._ERROR_MESSAGE_INVALID_CHARS="should be a ASCII string with a length greater than 0 and not exceed "+this._MAX_LENGTH+" characters.",this._ERROR_MESSAGE_INVALID_VALUE="should be a ASCII string with a length not exceed "+this._MAX_LENGTH+" characters."}return n.prototype.detect=function(r){var t={},u=B(),i=u.OTEL_RESOURCE_ATTRIBUTES,e=u.OTEL_SERVICE_NAME;if(i)try{var c=this._parseResourceAttributes(i);Object.assign(t,c)}catch(s){j.debug("EnvDetector failed: "+s.message)}return e&&(t[Y.SERVICE_NAME]=e),new l(t)},n.prototype._parseResourceAttributes=function(r){var t,u;if(!r)return{};var i={},e=r.split(this._COMMA_SEPARATOR,-1);try{for(var c=G(e),s=c.next();!s.done;s=c.next()){var f=s.value,o=f.split(this._LABEL_KEY_VALUE_SPLITTER,-1);if(o.length===2){var a=U(o,2),v=a[0],_=a[1];if(v=v.trim(),_=_.trim().split(/^"|"$/).join(""),!this._isValidAndNotEmpty(v))throw new Error("Attribute key "+this._ERROR_MESSAGE_INVALID_CHARS);if(!this._isValid(_))throw new Error("Attribute value "+this._ERROR_MESSAGE_INVALID_VALUE);i[v]=decodeURIComponent(_)}}}catch(O){t={error:O}}finally{try{s&&!s.done&&(u=c.return)&&u.call(c)}finally{if(t)throw t.error}}return i},n.prototype._isValid=function(r){return r.length<=this._MAX_LENGTH&&this._isBaggageOctetString(r)},n.prototype._isBaggageOctetString=function(r){for(var t=0;t<r.length;t++){var u=r.charCodeAt(t);if(u<33||u===44||u===59||u===92||u>126)return!1}return!0},n.prototype._isValidAndNotEmpty=function(r){return r.length>0&&this._isValid(r)},n}(),D=new k;var K=function(){function n(){}return n.prototype.detect=function(r){return Promise.resolve(D.detect(r))},n}(),Nt=new K;import{SemanticResourceAttributes as b}from"/v135/@opentelemetry/semantic-conventions@1.17.0/denonext/semantic-conventions.mjs";import{diag as F}from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";var S=function(){return S=Object.assign||function(n){for(var r,t=1,u=arguments.length;t<u;t++){r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])}return n},S.apply(this,arguments)},H=function(){function n(){}return n.prototype.detect=function(r){var t,u=typeof navigator<"u";if(!u)return l.empty();var i=(t={},t[b.PROCESS_RUNTIME_NAME]="browser",t[b.PROCESS_RUNTIME_DESCRIPTION]="Web Browser",t[b.PROCESS_RUNTIME_VERSION]=navigator.userAgent,t);return this._getResourceAttributes(i,r)},n.prototype._getResourceAttributes=function(r,t){return r[b.PROCESS_RUNTIME_VERSION]===""?(F.debug("BrowserDetector failed: Unable to find required browser resources. "),l.empty()):new l(S({},r))},n}(),x=new H;import{diag as p}from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";var T=function(n){return n!==null&&typeof n=="object"&&typeof n.then=="function"};var A=function(n,r,t,u){function i(e){return e instanceof t?e:new t(function(c){c(e)})}return new(t||(t=Promise))(function(e,c){function s(a){try{o(u.next(a))}catch(v){c(v)}}function f(a){try{o(u.throw(a))}catch(v){c(v)}}function o(a){a.done?e(a.value):i(a.value).then(s,f)}o((u=u.apply(n,r||[])).next())})},g=function(n,r){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,i,e,c;return c={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function s(o){return function(a){return f([o,a])}}function f(o){if(u)throw new TypeError("Generator is already executing.");for(;t;)try{if(u=1,i&&(e=o[0]&2?i.return:o[0]?i.throw||((e=i.return)&&e.call(i),0):i.next)&&!(e=e.call(i,o[1])).done)return e;switch(i=0,e&&(o=[o[0]&2,e.value]),o[0]){case 0:case 1:e=o;break;case 4:return t.label++,{value:o[1],done:!1};case 5:t.label++,i=o[1],o=[0];continue;case 7:o=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(o[0]===6||o[0]===2)){t=0;continue}if(o[0]===3&&(!e||o[1]>e[0]&&o[1]<e[3])){t.label=o[1];break}if(o[0]===6&&t.label<e[1]){t.label=e[1],e=o;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(o);break}e[2]&&t.ops.pop(),t.trys.pop();continue}o=r.call(n,t)}catch(a){o=[6,a],i=0}finally{u=e=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},jt=function(n){return n===void 0&&(n={}),A(void 0,void 0,void 0,function(){var r;return g(this,function(t){switch(t.label){case 0:return[4,Promise.all((n.detectors||[]).map(function(u){return A(void 0,void 0,void 0,function(){var i,e;return g(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,u.detect(n)];case 1:return i=c.sent(),p.debug(u.constructor.name+" found resource.",i),[2,i];case 2:return e=c.sent(),p.debug(u.constructor.name+" failed: "+e.message),[2,l.empty()];case 3:return[2]}})})}))];case 1:return r=t.sent(),N(r),[2,r.reduce(function(u,i){return u.merge(i)},l.empty())]}})})},Bt=function(n){var r;n===void 0&&(n={});var t=((r=n.detectors)!==null&&r!==void 0?r:[]).map(function(i){try{var e=i.detect(n),c;if(T(e)){var s=function(){return A(void 0,void 0,void 0,function(){var f;return g(this,function(o){switch(o.label){case 0:return[4,e];case 1:return f=o.sent(),[2,f.attributes]}})})};c=new l({},s())}else c=e;return c.waitForAsyncAttributes?c.waitForAsyncAttributes().then(function(){return p.debug(i.constructor.name+" found resource.",c)}):p.debug(i.constructor.name+" found resource.",c),c}catch(f){return p.error(i.constructor.name+" failed: "+f.message),l.empty()}}),u=t.reduce(function(i,e){return i.merge(e)},l.empty());return u.waitForAsyncAttributes&&u.waitForAsyncAttributes().then(function(){N(t)}),u},N=function(n){n.forEach(function(r){if(Object.keys(r.attributes).length>0){var t=JSON.stringify(r.attributes,null,4);p.verbose(t)}})};export{l as Resource,St as browserDetector,x as browserDetectorSync,w as defaultServiceName,jt as detectResources,Bt as detectResourcesSync,Nt as envDetector,D as envDetectorSync,Q as hostDetector,ot as hostDetectorSync,et as osDetector,ct as osDetectorSync,ft as processDetector,ht as processDetectorSync};
//# sourceMappingURL=resources.mjs.map