/* esm.sh - esbuild bundle(@opentelemetry/exporter-metrics-otlp-http@0.43.0) denonext production */
import{baggageUtils as C,getEnv as f}from"/v135/@opentelemetry/core@1.17.0/denonext/core.mjs";import{getEnv as x}from"/v135/@opentelemetry/core@1.17.0/denonext/core.mjs";import{AggregationTemporality as T,InstrumentType as u}from"/v135/@opentelemetry/sdk-metrics@1.17.0/denonext/sdk-metrics.mjs";var l;(function(e){e[e.DELTA=0]="DELTA",e[e.CUMULATIVE=1]="CUMULATIVE",e[e.LOWMEMORY=2]="LOWMEMORY"})(l||(l={}));import{diag as d}from"/v135/@opentelemetry/api@1.6.0/denonext/api.mjs";var P=function(e,o,t,i){function a(r){return r instanceof t?r:new t(function(E){E(r)})}return new(t||(t=Promise))(function(r,E){function s(c){try{n(i.next(c))}catch(O){E(O)}}function _(c){try{n(i.throw(c))}catch(O){E(O)}}function n(c){c.done?r(c.value):a(c.value).then(s,_)}n((i=i.apply(e,o||[])).next())})},v=function(e,o){var t={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,a,r,E;return E={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(E[Symbol.iterator]=function(){return this}),E;function s(n){return function(c){return _([n,c])}}function _(n){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,a&&(r=n[0]&2?a.return:n[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,n[1])).done)return r;switch(a=0,r&&(n=[n[0]&2,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return t.label++,{value:n[1],done:!1};case 5:t.label++,a=n[1],n=[0];continue;case 7:n=t.ops.pop(),t.trys.pop();continue;default:if(r=t.trys,!(r=r.length>0&&r[r.length-1])&&(n[0]===6||n[0]===2)){t=0;continue}if(n[0]===3&&(!r||n[1]>r[0]&&n[1]<r[3])){t.label=n[1];break}if(n[0]===6&&t.label<r[1]){t.label=r[1],r=n;break}if(r&&t.label<r[2]){t.label=r[2],t.ops.push(n);break}r[2]&&t.ops.pop(),t.trys.pop();continue}n=o.call(e,t)}catch(c){n=[6,c],a=0}finally{i=r=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}},p=function(){return T.CUMULATIVE},R=function(e){switch(e){case u.COUNTER:case u.OBSERVABLE_COUNTER:case u.HISTOGRAM:case u.OBSERVABLE_GAUGE:return T.DELTA;case u.UP_DOWN_COUNTER:case u.OBSERVABLE_UP_DOWN_COUNTER:return T.CUMULATIVE}},L=function(e){switch(e){case u.COUNTER:case u.HISTOGRAM:return T.DELTA;case u.UP_DOWN_COUNTER:case u.OBSERVABLE_UP_DOWN_COUNTER:case u.OBSERVABLE_COUNTER:case u.OBSERVABLE_GAUGE:return T.CUMULATIVE}};function U(){var e=x(),o=e.OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE.trim().toLowerCase();return o==="cumulative"?p:o==="delta"?R:o==="lowmemory"?L:(d.warn("OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE is set to '"+e.OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE+"', but only 'cumulative' and 'delta' are allowed. Using default ('cumulative') instead."),p)}function w(e){return e!=null?e===l.DELTA?R:e===l.LOWMEMORY?L:p:U()}var h=function(){function e(o,t){this._otlpExporter=o,this._aggregationTemporalitySelector=w(t?.temporalityPreference)}return e.prototype.export=function(o,t){this._otlpExporter.export([o],t)},e.prototype.shutdown=function(){return P(this,void 0,void 0,function(){return v(this,function(o){switch(o.label){case 0:return[4,this._otlpExporter.shutdown()];case 1:return o.sent(),[2]}})})},e.prototype.forceFlush=function(){return Promise.resolve()},e.prototype.selectAggregationTemporality=function(o){return this._aggregationTemporalitySelector(o)},e}();import{OTLPExporterBrowserBase as M,appendResourcePathToUrl as S,appendRootPathToUrlIfNeeded as A}from"/v135/@opentelemetry/otlp-exporter-base@0.43.0/denonext/otlp-exporter-base.mjs";import{createExportMetricsServiceRequest as N}from"/v135/@opentelemetry/otlp-transformer@0.43.0/denonext/otlp-transformer.mjs";var y=function(){var e=function(o,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i[r]=a[r])},e(o,t)};return function(o,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(o,t);function i(){this.constructor=o}o.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),m="v1/metrics",I="http://localhost:4318/"+m,B=function(e){y(o,e);function o(t){var i=e.call(this,t)||this;return i._headers=Object.assign(i._headers,C.parseKeyPairsIntoRecord(f().OTEL_EXPORTER_OTLP_METRICS_HEADERS)),i}return o.prototype.getDefaultUrl=function(t){return typeof t.url=="string"?t.url:f().OTEL_EXPORTER_OTLP_METRICS_ENDPOINT.length>0?A(f().OTEL_EXPORTER_OTLP_METRICS_ENDPOINT):f().OTEL_EXPORTER_OTLP_ENDPOINT.length>0?S(f().OTEL_EXPORTER_OTLP_ENDPOINT,m):I},o.prototype.convert=function(t){return N(t)},o}(M),k=function(e){y(o,e);function o(t){return e.call(this,new B(t),t)||this}return o}(h);export{l as AggregationTemporalityPreference,p as CumulativeTemporalitySelector,R as DeltaTemporalitySelector,L as LowMemoryTemporalitySelector,k as OTLPMetricExporter,h as OTLPMetricExporterBase};
//# sourceMappingURL=exporter-metrics-otlp-http.mjs.map