/* esm.sh - esbuild bundle(request@2.88.2) denonext production */
import __Process$ from "node:process";
var __setImmediate$ = (cb, ...args) => setTimeout(cb, 0, ...args);
import * as __0$ from "/v135/extend@3.0.2/denonext/extend.mjs";
import * as __1$ from "/v135/tough-cookie@2.5.0/denonext/tough-cookie.mjs";
import * as __2$ from "/v135/json-stringify-safe@5.0.1/denonext/json-stringify-safe.mjs";
import * as __3$ from "node:crypto";
import * as __4$ from "/v135/safe-buffer@5.2.1/denonext/safe-buffer.mjs";
import * as __5$ from "node:http";
import * as __6$ from "node:https";
import * as __7$ from "node:url";
import * as __8$ from "node:util";
import * as __9$ from "node:stream";
import * as __a$ from "node:zlib";
import * as __b$ from "/v135/aws-sign2@0.7.0/denonext/aws-sign2.mjs";
import * as __c$ from "/v135/aws4@1.12.0/denonext/aws4.mjs";
import * as __d$ from "/v135/http-signature@1.2.0/denonext/http-signature.mjs";
import * as __e$ from "/v135/mime-types@2.1.35/denonext/mime-types.mjs";
import * as __f$ from "/v135/caseless@0.12.0/denonext/caseless.mjs";
import * as __10$ from "/v135/forever-agent@0.6.1/denonext/forever-agent.mjs";
import * as __11$ from "/v135/form-data@2.3.3/denonext/form-data.mjs";
import * as __12$ from "/v135/extend@3.0.2/denonext/extend.mjs";
import * as __13$ from "/v135/isstream@0.1.2/denonext/isstream.mjs";
import * as __14$ from "/v135/is-typedarray@1.0.0/denonext/is-typedarray.mjs";
import * as __15$ from "/v135/performance-now@2.1.0/denonext/performance-now.mjs";
import * as __16$ from "/v135/safe-buffer@5.2.1/denonext/safe-buffer.mjs";
import * as __17$ from "/v135/qs@6.5.3/denonext/qs.mjs";
import * as __18$ from "node:querystring";
import * as __19$ from "node:crypto";
import * as __1a$ from "node:url";
import * as __1b$ from "node:url";
import * as __1c$ from "node:url";
import * as __1d$ from "/v135/uuid@3.4.0/denonext/v4.js";
import * as __1e$ from "/v135/tunnel-agent@0.6.0/denonext/tunnel-agent.mjs";
import * as __1f$ from "/v135/combined-stream@1.0.8/denonext/combined-stream.mjs";
import * as __20$ from "/v135/caseless@0.12.0/denonext/caseless.mjs";
import * as __21$ from "/v135/qs@6.5.3/denonext/qs.mjs";
import * as __22$ from "/v135/isstream@0.1.2/denonext/isstream.mjs";
import * as __23$ from "/v135/uuid@3.4.0/denonext/v4.js";
import * as __24$ from "/v135/caseless@0.12.0/denonext/caseless.mjs";
import * as __25$ from "/v135/safe-buffer@5.2.1/denonext/safe-buffer.mjs";
import * as __26$ from "/v135/uuid@3.4.0/denonext/v4.js";
import * as __27$ from "/v135/oauth-sign@0.9.0/denonext/oauth-sign.mjs";
import * as __28$ from "node:crypto";
import * as __29$ from "/v135/safe-buffer@5.2.1/denonext/safe-buffer.mjs";
import * as __2a$ from "node:fs";
import * as __2b$ from "node:querystring";
import * as __2c$ from "/v135/har-validator@5.1.5/denonext/har-validator.mjs";
import * as __2d$ from "/v135/extend@3.0.2/denonext/extend.mjs";
var require=n=>{const e=m=>typeof m.default<"u"?m.default:m,c=m=>Object.assign({},m);switch(n){case"extend":return e(__0$);case"tough-cookie":return e(__1$);case"json-stringify-safe":return e(__2$);case"crypto":return e(__3$);case"safe-buffer":return e(__4$);case"http":return e(__5$);case"https":return e(__6$);case"url":return e(__7$);case"util":return e(__8$);case"stream":return e(__9$);case"zlib":return e(__a$);case"aws-sign2":return e(__b$);case"aws4":return e(__c$);case"http-signature":return e(__d$);case"mime-types":return e(__e$);case"caseless":return e(__f$);case"forever-agent":return e(__10$);case"form-data":return e(__11$);case"isstream":return e(__13$);case"is-typedarray":return e(__14$);case"performance-now":return e(__15$);case"qs":return e(__17$);case"querystring":return e(__18$);case"uuid/v4":return e(__1d$);case"tunnel-agent":return e(__1e$);case"combined-stream":return e(__1f$);case"oauth-sign":return e(__27$);case"fs":return e(__2a$);case"har-validator":return e(__2c$);default:throw new Error("module \""+n+"\" not found");}};
var Ke=Object.create;var ee=Object.defineProperty;var $e=Object.getOwnPropertyDescriptor;var Ve=Object.getOwnPropertyNames;var Ze=Object.getPrototypeOf,er=Object.prototype.hasOwnProperty;var u=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var b=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),rr=(r,e)=>{for(var t in e)ee(r,t,{get:e[t],enumerable:!0})},Z=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of Ve(e))!er.call(r,a)&&a!==t&&ee(r,a,{get:()=>e[a],enumerable:!(i=$e(e,a))||i.enumerable});return r},k=(r,e,t)=>(Z(r,e,"default"),t&&Z(t,e,"default")),fe=(r,e,t)=>(t=r!=null?Ke(Ze(r)):{},Z(e||!r||!r.__esModule?ee(t,"default",{value:r,enumerable:!0}):t,r));var te=b(re=>{"use strict";var ce=u("tough-cookie"),tr=ce.Cookie,ir=ce.CookieJar;re.parse=function(r){if(r&&r.uri&&(r=r.uri),typeof r!="string")throw new Error("The cookie function only accepts STRING as param");return tr.parse(r,{loose:!0})};function I(r){var e=this;e._jar=new ir(r,{looseMode:!0})}I.prototype.setCookie=function(r,e,t){var i=this;return i._jar.setCookieSync(r,e,t||{})};I.prototype.getCookieString=function(r){var e=this;return e._jar.getCookieStringSync(r)};I.prototype.getCookies=function(r){var e=this;return e._jar.getCookiesSync(r)};re.jar=function(r){return new I(r)}});var J=b(_=>{"use strict";var ar=u("json-stringify-safe"),or=u("crypto"),nr=u("safe-buffer").Buffer,sr=typeof __setImmediate$>"u"?__Process$.nextTick:__setImmediate$;function ur(r){return r.body||r.requestBodyStream||r.json&&typeof r.json!="boolean"||r.multipart}function fr(r,e){var t;try{t=JSON.stringify(r,e)}catch{t=ar(r,e)}return t}function cr(r){return or.createHash("md5").update(r).digest("hex")}function lr(r){return r.readable&&r.path&&r.mode}function dr(r){return nr.from(r||"","utf8").toString("base64")}function hr(r){var e={};return Object.keys(r).forEach(function(t){e[t]=r[t]}),e}function pr(){var r=__Process$.version.replace("v","").split(".");return{major:parseInt(r[0],10),minor:parseInt(r[1],10),patch:parseInt(r[2],10)}}_.paramsHaveRequestBody=ur;_.safeStringify=fr;_.md5=cr;_.isReadStream=lr;_.toBase64=dr;_.copy=hr;_.version=pr;_.defer=sr});var he=b((Dt,de)=>{"use strict";function le(r){return r.replace(/^\.*/,".").toLowerCase()}function mr(r){r=r.trim().toLowerCase();var e=r.split(":",2),t=le(e[0]),i=e[1],a=r.indexOf(":")>-1;return{hostname:t,port:i,hasPort:a}}function vr(r,e){var t=r.port||(r.protocol==="https:"?"443":"80"),i=le(r.hostname),a=e.split(",");return a.map(mr).some(function(o){var n=i.indexOf(o.hostname),s=n>-1&&n===i.length-o.hostname.length;return o.hasPort?t===o.port&&s:s})}function yr(r){var e=__Process$.env.NO_PROXY||__Process$.env.no_proxy||"";return e==="*"||e!==""&&vr(r,e)?null:r.protocol==="http:"?__Process$.env.HTTP_PROXY||__Process$.env.http_proxy||null:r.protocol==="https:"&&(__Process$.env.HTTPS_PROXY||__Process$.env.https_proxy||__Process$.env.HTTP_PROXY||__Process$.env.http_proxy)||null}de.exports=yr});var ve=b(me=>{"use strict";var gr=u("qs"),pe=u("querystring");function R(r){this.request=r,this.lib=null,this.useQuerystring=null,this.parseOptions=null,this.stringifyOptions=null}R.prototype.init=function(r){this.lib||(this.useQuerystring=r.useQuerystring,this.lib=this.useQuerystring?pe:gr,this.parseOptions=r.qsParseOptions||{},this.stringifyOptions=r.qsStringifyOptions||{})};R.prototype.stringify=function(r){return this.useQuerystring?this.rfc3986(this.lib.stringify(r,this.stringifyOptions.sep||null,this.stringifyOptions.eq||null,this.stringifyOptions)):this.lib.stringify(r,this.stringifyOptions)};R.prototype.parse=function(r){return this.useQuerystring?this.lib.parse(r,this.parseOptions.sep||null,this.parseOptions.eq||null,this.parseOptions):this.lib.parse(r,this.parseOptions)};R.prototype.rfc3986=function(r){return r.replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})};R.prototype.unescape=pe.unescape;me.Querystring=R});var ge=b(ye=>{"use strict";var br=u("fs"),qr=u("querystring"),_r=u("har-validator"),Hr=u("extend");function Q(r){this.request=r}Q.prototype.reducer=function(r,e){if(r[e.name]===void 0)return r[e.name]=e.value,r;var t=[r[e.name],e.value];return r[e.name]=t,r};Q.prototype.prep=function(r){if(r.queryObj={},r.headersObj={},r.postData.jsonObj=!1,r.postData.paramsObj=!1,r.queryString&&r.queryString.length&&(r.queryObj=r.queryString.reduce(this.reducer,{})),r.headers&&r.headers.length&&(r.headersObj=r.headers.reduceRight(function(i,a){return i[a.name]=a.value,i},{})),r.cookies&&r.cookies.length){var e=r.cookies.map(function(i){return i.name+"="+i.value});e.length&&(r.headersObj.cookie=e.join("; "))}function t(i){return i.some(function(a){return r.postData.mimeType.indexOf(a)===0})}if(t(["multipart/mixed","multipart/related","multipart/form-data","multipart/alternative"]))r.postData.mimeType="multipart/form-data";else if(t(["application/x-www-form-urlencoded"]))r.postData.params?(r.postData.paramsObj=r.postData.params.reduce(this.reducer,{}),r.postData.text=qr.stringify(r.postData.paramsObj)):r.postData.text="";else if(t(["text/json","text/x-json","application/json","application/x-json"])&&(r.postData.mimeType="application/json",r.postData.text))try{r.postData.jsonObj=JSON.parse(r.postData.text)}catch(i){this.request.debug(i),r.postData.mimeType="text/plain"}return r};Q.prototype.options=function(r){if(!r.har)return r;var e={};if(Hr(e,r.har),e.log&&e.log.entries&&(e=e.log.entries[0]),e.url=e.url||r.url||r.uri||r.baseUrl||"/",e.httpVersion=e.httpVersion||"HTTP/1.1",e.queryString=e.queryString||[],e.headers=e.headers||[],e.cookies=e.cookies||[],e.postData=e.postData||{},e.postData.mimeType=e.postData.mimeType||"application/octet-stream",e.bodySize=0,e.headersSize=0,e.postData.size=0,!_r.request(e))return r;var t=this.prep(e);t.url&&(r.url=t.url),t.method&&(r.method=t.method),Object.keys(t.queryObj).length&&(r.qs=t.queryObj),Object.keys(t.headersObj).length&&(r.headers=t.headersObj);function i(a){return t.postData.mimeType.indexOf(a)===0}return i("application/x-www-form-urlencoded")?r.form=t.postData.paramsObj:i("application/json")?t.postData.jsonObj&&(r.body=t.postData.jsonObj,r.json=!0):i("multipart/form-data")?(r.formData={},t.postData.params.forEach(function(a){var o={};if(!a.fileName&&!a.contentType){r.formData[a.name]=a.value;return}a.fileName&&!a.value?o.value=br.createReadStream(a.fileName):a.value&&(o.value=a.value),a.fileName&&(o.options={filename:a.fileName,contentType:a.contentType?a.contentType:null}),r.formData[a.name]=o})):t.postData.text&&(r.body=t.postData.text),r};ye.Har=Q});var _e=b(qe=>{"use strict";var wr=u("caseless"),xr=u("uuid/v4"),be=J(),A=be.md5,Or=be.toBase64;function S(r){this.request=r,this.hasAuth=!1,this.sentAuth=!1,this.bearerToken=null,this.user=null,this.pass=null}S.prototype.basic=function(r,e,t){var i=this;(typeof r!="string"||e!==void 0&&typeof e!="string")&&i.request.emit("error",new Error("auth() received invalid user or password")),i.user=r,i.pass=e,i.hasAuth=!0;var a=r+":"+(e||"");if(t||typeof t>"u"){var o="Basic "+Or(a);return i.sentAuth=!0,o}};S.prototype.bearer=function(r,e){var t=this;if(t.bearerToken=r,t.hasAuth=!0,e||typeof e>"u"){typeof r=="function"&&(r=r());var i="Bearer "+(r||"");return t.sentAuth=!0,i}};S.prototype.digest=function(r,e,t){for(var i=this,a={},o=/([a-z0-9_-]+)=(?:"([^"]+)"|([a-z0-9_-]+))/gi;;){var n=o.exec(t);if(!n)break;a[n[1]]=n[2]||n[3]}var s=function(M,N,T,$,V,B){var d=A(N+":"+T+":"+$);return M&&M.toLowerCase()==="md5-sess"?A(d+":"+V+":"+B):d},c=/(^|,)\s*auth\s*($|,)/.test(a.qop)&&"auth",v=c&&"00000001",l=c&&xr().replace(/-/g,""),h=s(a.algorithm,i.user,a.realm,i.pass,a.nonce,l),g=A(r+":"+e),x=A(c?h+":"+a.nonce+":"+v+":"+l+":"+c+":"+g:h+":"+a.nonce+":"+g),O={username:i.user,realm:a.realm,nonce:a.nonce,uri:e,qop:c,response:x,nc:v,cnonce:l,algorithm:a.algorithm,opaque:a.opaque};t=[];for(var q in O)O[q]&&(q==="qop"||q==="nc"||q==="algorithm"?t.push(q+"="+O[q]):t.push(q+'="'+O[q]+'"'));return t="Digest "+t.join(", "),i.sentAuth=!0,t};S.prototype.onRequest=function(r,e,t,i){var a=this,o=a.request,n;i===void 0&&r===void 0?a.request.emit("error",new Error("no auth mechanism defined")):i!==void 0?n=a.bearer(i,t):n=a.basic(r,e,t),n&&o.setHeader("authorization",n)};S.prototype.onResponse=function(r){var e=this,t=e.request;if(!e.hasAuth||e.sentAuth)return null;var i=wr(r.headers),a=i.get("www-authenticate"),o=a&&a.split(" ")[0].toLowerCase();switch(t.debug("reauth",o),o){case"basic":return e.basic(e.user,e.pass,!0);case"bearer":return e.bearer(e.bearerToken,!0);case"digest":return e.digest(t.method,t.path,a)}};qe.Auth=S});var xe=b(we=>{"use strict";var kr=u("url"),Tr=u("qs"),Rr=u("caseless"),Sr=u("uuid/v4"),He=u("oauth-sign"),jr=u("crypto"),Er=u("safe-buffer").Buffer;function C(r){this.request=r,this.params=null}C.prototype.buildParams=function(r,e,t,i,a,o){var n={};for(var s in r)n["oauth_"+s]=r[s];n.oauth_version||(n.oauth_version="1.0"),n.oauth_timestamp||(n.oauth_timestamp=Math.floor(Date.now()/1e3).toString()),n.oauth_nonce||(n.oauth_nonce=Sr().replace(/-/g,"")),n.oauth_signature_method||(n.oauth_signature_method="HMAC-SHA1");var c=n.oauth_consumer_secret||n.oauth_private_key;delete n.oauth_consumer_secret,delete n.oauth_private_key;var v=n.oauth_token_secret;delete n.oauth_token_secret;var l=n.oauth_realm;delete n.oauth_realm,delete n.oauth_transport_method;var h=e.protocol+"//"+e.host+e.pathname,g=o.parse([].concat(i,a,o.stringify(n)).join("&"));return n.oauth_signature=He.sign(n.oauth_signature_method,t,h,g,c,v),l&&(n.realm=l),n};C.prototype.buildBodyHash=function(r,e){["HMAC-SHA1","RSA-SHA1"].indexOf(r.signature_method||"HMAC-SHA1")<0&&this.request.emit("error",new Error("oauth: "+r.signature_method+" signature_method not supported with body_hash signing."));var t=jr.createHash("sha1");t.update(e||"");var i=t.digest("hex");return Er.from(i,"hex").toString("base64")};C.prototype.concatParams=function(r,e,t){t=t||"";var i=Object.keys(r).filter(function(a){return a!=="realm"&&a!=="oauth_signature"}).sort();return r.realm&&i.splice(0,0,"realm"),i.push("oauth_signature"),i.map(function(a){return a+"="+t+He.rfc3986(r[a])+t}).join(e)};C.prototype.onRequest=function(r){var e=this;e.params=r;var t=e.request.uri||{},i=e.request.method||"",a=Rr(e.request.headers),o=e.request.body||"",n=e.request.qsLib||Tr,s,c,v=a.get("content-type")||"",l="application/x-www-form-urlencoded",h=r.transport_method||"header";v.slice(0,l.length)===l&&(v=l,s=o),t.query&&(c=t.query),h==="body"&&(i!=="POST"||v!==l)&&e.request.emit("error",new Error("oauth: transport_method of body requires POST and content-type "+l)),!s&&typeof r.body_hash=="boolean"&&(r.body_hash=e.buildBodyHash(r,e.request.body.toString()));var g=e.buildParams(r,t,i,c,s,n);switch(h){case"header":e.request.setHeader("Authorization","OAuth "+e.concatParams(g,",",'"'));break;case"query":var x=e.request.uri.href+=(c?"&":"?")+e.concatParams(g,"&");e.request.uri=kr.parse(x),e.request.path=e.request.uri.path;break;case"body":e.request.body=(s?s+"&":"")+e.concatParams(g,"&");break;default:e.request.emit("error",new Error("oauth: transport_method invalid"))}};we.OAuth=C});var Oe=b(W=>{"use strict";var ie=u("crypto");function Ar(r){var e=(r+1)*6,t=ie.randomBytes(Math.ceil(e/8)),i=t.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");return i.slice(0,r)}function Cr(r,e,t){var i=ie.createHash(e);return i.update(`hawk.1.payload
`),i.update((t?t.split(";")[0].trim().toLowerCase():"")+`
`),i.update(r||""),i.update(`
`),i.digest("base64")}W.calculateMac=function(r,e){var t=`hawk.1.header
`+e.ts+`
`+e.nonce+`
`+(e.method||"").toUpperCase()+`
`+e.resource+`
`+e.host.toLowerCase()+`
`+e.port+`
`+(e.hash||"")+`
`;e.ext&&(t=t+e.ext.replace("\\","\\\\").replace(`
`,"\\n")),t=t+`
`,e.app&&(t=t+e.app+`
`+(e.dlg||"")+`
`);var i=ie.createHmac(r.algorithm,r.key).update(t),a=i.digest("base64");return a};W.header=function(r,e,t){var i=t.timestamp||Math.floor((Date.now()+(t.localtimeOffsetMsec||0))/1e3),a=t.credentials;if(!a||!a.id||!a.key||!a.algorithm||["sha1","sha256"].indexOf(a.algorithm)===-1)return"";var o={ts:i,nonce:t.nonce||Ar(6),method:e,resource:r.pathname+(r.search||""),host:r.hostname,port:r.port||(r.protocol==="http:"?80:443),hash:t.hash,ext:t.ext,app:t.app,dlg:t.dlg};!o.hash&&(t.payload||t.payload==="")&&(o.hash=Cr(t.payload,a.algorithm,t.contentType));var n=W.calculateMac(a,o),s=o.ext!==null&&o.ext!==void 0&&o.ext!=="",c='Hawk id="'+a.id+'", ts="'+o.ts+'", nonce="'+o.nonce+(o.hash?'", hash="'+o.hash:"")+(s?'", ext="'+o.ext.replace(/\\/g,"\\\\").replace(/"/g,'\\"'):"")+'", mac="'+n+'"';return o.app&&(c=c+', app="'+o.app+(o.dlg?'", dlg="'+o.dlg:"")+'"'),c}});var Te=b(ke=>{"use strict";var Pr=u("uuid/v4"),Dr=u("combined-stream"),Lr=u("isstream"),zr=u("safe-buffer").Buffer;function P(r){this.request=r,this.boundary=Pr(),this.chunked=!1,this.body=null}P.prototype.isChunked=function(r){var e=this,t=!1,i=r.data||r;return i.forEach||e.request.emit("error",new Error("Argument error, options.multipart.")),r.chunked!==void 0&&(t=r.chunked),e.request.getHeader("transfer-encoding")==="chunked"&&(t=!0),t||i.forEach(function(a){typeof a.body>"u"&&e.request.emit("error",new Error("Body attribute missing in multipart.")),Lr(a.body)&&(t=!0)}),t};P.prototype.setHeaders=function(r){var e=this;r&&!e.request.hasHeader("transfer-encoding")&&e.request.setHeader("transfer-encoding","chunked");var t=e.request.getHeader("content-type");!t||t.indexOf("multipart")===-1?e.request.setHeader("content-type","multipart/related; boundary="+e.boundary):t.indexOf("boundary")!==-1?e.boundary=t.replace(/.*boundary=([^\s;]+).*/,"$1"):e.request.setHeader("content-type",t+"; boundary="+e.boundary)};P.prototype.build=function(r,e){var t=this,i=e?new Dr:[];function a(o){return typeof o=="number"&&(o=o.toString()),e?i.append(o):i.push(zr.from(o))}return t.request.preambleCRLF&&a(`\r
`),r.forEach(function(o){var n="--"+t.boundary+`\r
`;Object.keys(o).forEach(function(s){s!=="body"&&(n+=s+": "+o[s]+`\r
`)}),n+=`\r
`,a(n),a(o.body),a(`\r
`)}),a("--"+t.boundary+"--"),t.request.postambleCRLF&&a(`\r
`),i};P.prototype.onRequest=function(r){var e=this,t=e.isChunked(r),i=r.data||r;e.setHeaders(t),e.chunked=t,e.body=e.build(i,t)};ke.Multipart=P});var je=b(Se=>{"use strict";var Re=u("url"),Ur=/^https?:/;function Y(r){this.request=r,this.followRedirect=!0,this.followRedirects=!0,this.followAllRedirects=!1,this.followOriginalHttpMethod=!1,this.allowRedirect=function(){return!0},this.maxRedirects=10,this.redirects=[],this.redirectsFollowed=0,this.removeRefererHeader=!1}Y.prototype.onRequest=function(r){var e=this;r.maxRedirects!==void 0&&(e.maxRedirects=r.maxRedirects),typeof r.followRedirect=="function"&&(e.allowRedirect=r.followRedirect),r.followRedirect!==void 0&&(e.followRedirects=!!r.followRedirect),r.followAllRedirects!==void 0&&(e.followAllRedirects=r.followAllRedirects),(e.followRedirects||e.followAllRedirects)&&(e.redirects=e.redirects||[]),r.removeRefererHeader!==void 0&&(e.removeRefererHeader=r.removeRefererHeader),r.followOriginalHttpMethod!==void 0&&(e.followOriginalHttpMethod=r.followOriginalHttpMethod)};Y.prototype.redirectTo=function(r){var e=this,t=e.request,i=null;if(r.statusCode>=300&&r.statusCode<400&&r.caseless.has("location")){var a=r.caseless.get("location");if(t.debug("redirect",a),e.followAllRedirects)i=a;else if(e.followRedirects)switch(t.method){case"PATCH":case"PUT":case"POST":case"DELETE":break;default:i=a;break}}else if(r.statusCode===401){var o=t._auth.onResponse(r);o&&(t.setHeader("authorization",o),i=t.uri)}return i};Y.prototype.onResponse=function(r){var e=this,t=e.request,i=e.redirectTo(r);if(!i||!e.allowRedirect.call(t,r))return!1;if(t.debug("redirect to",i),r.resume&&r.resume(),e.redirectsFollowed>=e.maxRedirects)return t.emit("error",new Error("Exceeded maxRedirects. Probably stuck in a redirect loop "+t.uri.href)),!1;e.redirectsFollowed+=1,Ur.test(i)||(i=Re.resolve(t.uri.href,i));var a=t.uri;return t.uri=Re.parse(i),t.uri.protocol!==a.protocol&&delete t.agent,e.redirects.push({statusCode:r.statusCode,redirectUri:i}),e.followAllRedirects&&t.method!=="HEAD"&&r.statusCode!==401&&r.statusCode!==307&&(t.method=e.followOriginalHttpMethod?t.method:"GET"),delete t.src,delete t.req,delete t._started,r.statusCode!==401&&r.statusCode!==307&&(delete t.body,delete t._form,t.headers&&(t.removeHeader("host"),t.removeHeader("content-type"),t.removeHeader("content-length"),t.uri.hostname!==t.originalHost.split(":")[0]&&t.removeHeader("authorization"))),e.removeRefererHeader||t.setHeader("referer",a.href),t.emit("redirect"),t.init(),!0};Se.Redirect=Y});var Pe=b(Ce=>{"use strict";var Mr=u("url"),Nr=u("tunnel-agent"),Ee=["accept","accept-charset","accept-encoding","accept-language","accept-ranges","cache-control","content-encoding","content-language","content-location","content-md5","content-range","content-type","connection","date","expect","max-forwards","pragma","referer","te","user-agent","via"],Ae=["proxy-authorization"];function Br(r){var e=r.port,t=r.protocol,i=r.hostname+":";return e?i+=e:t==="https:"?i+="443":i+="80",i}function Fr(r,e){var t=e.reduce(function(i,a){return i[a.toLowerCase()]=!0,i},{});return Object.keys(r).filter(function(i){return t[i.toLowerCase()]}).reduce(function(i,a){return i[a]=r[a],i},{})}function Ir(r,e){var t=r.proxy,i={proxy:{host:t.hostname,port:+t.port,proxyAuth:t.auth,headers:e},headers:r.headers,ca:r.ca,cert:r.cert,key:r.key,passphrase:r.passphrase,pfx:r.pfx,ciphers:r.ciphers,rejectUnauthorized:r.rejectUnauthorized,secureOptions:r.secureOptions,secureProtocol:r.secureProtocol};return i}function Jr(r,e){var t=r.protocol==="https:"?"https":"http",i=e.protocol==="https:"?"Https":"Http";return[t,i].join("Over")}function Qr(r){var e=r.uri,t=r.proxy,i=Jr(e,t);return Nr[i]}function D(r){this.request=r,this.proxyHeaderWhiteList=Ee,this.proxyHeaderExclusiveList=[],typeof r.tunnel<"u"&&(this.tunnelOverride=r.tunnel)}D.prototype.isEnabled=function(){var r=this,e=r.request;return typeof r.tunnelOverride<"u"?r.tunnelOverride:e.uri.protocol==="https:"};D.prototype.setup=function(r){var e=this,t=e.request;if(r=r||{},typeof t.proxy=="string"&&(t.proxy=Mr.parse(t.proxy)),!t.proxy||!t.tunnel)return!1;r.proxyHeaderWhiteList&&(e.proxyHeaderWhiteList=r.proxyHeaderWhiteList),r.proxyHeaderExclusiveList&&(e.proxyHeaderExclusiveList=r.proxyHeaderExclusiveList);var i=e.proxyHeaderExclusiveList.concat(Ae),a=e.proxyHeaderWhiteList.concat(i),o=Fr(t.headers,a);o.host=Br(t.uri),i.forEach(t.removeHeader,t);var n=Qr(t),s=Ir(t,o);return t.agent=n(s),!0};D.defaultProxyHeaderWhiteList=Ee;D.defaultProxyHeaderExclusiveList=Ae;Ce.Tunnel=D});var Qe=b((Jt,Je)=>{"use strict";var Wr=u("http"),Ue=u("https"),L=u("url"),oe=u("util"),X=u("stream"),G=u("zlib"),ae=u("aws-sign2"),Yr=u("aws4"),Gr=u("http-signature"),Xr=u("mime-types"),Me=u("caseless"),De=u("forever-agent"),Kr=u("form-data"),$r=u("extend"),Le=u("isstream"),Vr=u("is-typedarray").strict,E=J(),Zr=te(),et=he(),rt=ve().Querystring,tt=ge().Har,it=_e().Auth,at=xe().OAuth,ot=Oe(),nt=Te().Multipart,st=je().Redirect,ne=Pe().Tunnel,j=u("performance-now"),z=u("safe-buffer").Buffer,ze=E.safeStringify,ut=E.isReadStream,ft=E.toBase64,ct=E.defer,Ne=E.copy,lt=E.version,Be=Zr.jar(),Fe={};function dt(r,e){var t={};for(var i in e){var a=r.indexOf(i)===-1;a&&(t[i]=e[i])}return t}function ht(r,e){var t={};for(var i in e){var a=r.indexOf(i)!==-1,o=typeof e[i]=="function";a&&o||(t[i]=e[i])}return t}function Ie(){var r=this;return{uri:r.uri,method:r.method,headers:r.headers}}function pt(){var r=this;return{statusCode:r.statusCode,body:r.body,headers:r.headers,request:Ie.call(r.request)}}function f(r){var e=this;r.har&&(e._har=new tt(e),r=e._har.options(r)),X.Stream.call(e);var t=Object.keys(f.prototype),i=dt(t,r);$r(e,i),r=ht(t,r),e.readable=!0,e.writable=!0,r.method&&(e.explicitMethod=!0),e._qs=new rt(e),e._auth=new it(e),e._oauth=new at(e),e._multipart=new nt(e),e._redirect=new st(e),e._tunnel=new ne(e),e.init(r)}oe.inherits(f,X.Stream);f.debug=__Process$.env.NODE_DEBUG&&/\brequest\b/.test(__Process$.env.NODE_DEBUG);function m(){f.debug&&console.error("REQUEST %s",oe.format.apply(oe,arguments))}f.prototype.debug=m;f.prototype.init=function(r){var e=this;r||(r={}),e.headers=e.headers?Ne(e.headers):{};for(var t in e.headers)typeof e.headers[t]>"u"&&delete e.headers[t];if(Me.httpify(e,e.headers),e.method||(e.method=r.method||"GET"),e.localAddress||(e.localAddress=r.localAddress),e._qs.init(r),m(r),!e.pool&&e.pool!==!1&&(e.pool=Fe),e.dests=e.dests||[],e.__isRequestRequest=!0,!e._callback&&e.callback&&(e._callback=e.callback,e.callback=function(){e._callbackCalled||(e._callbackCalled=!0,e._callback.apply(e,arguments))},e.on("error",e.callback.bind()),e.on("complete",e.callback.bind(e,null))),!e.uri&&e.url&&(e.uri=e.url,delete e.url),e.baseUrl){if(typeof e.baseUrl!="string")return e.emit("error",new Error("options.baseUrl must be a string"));if(typeof e.uri!="string")return e.emit("error",new Error("options.uri must be a string when using options.baseUrl"));if(e.uri.indexOf("//")===0||e.uri.indexOf("://")!==-1)return e.emit("error",new Error("options.uri must be a path when using options.baseUrl"));var i=e.baseUrl.lastIndexOf("/")===e.baseUrl.length-1,a=e.uri.indexOf("/")===0;i&&a?e.uri=e.baseUrl+e.uri.slice(1):i||a?e.uri=e.baseUrl+e.uri:e.uri===""?e.uri=e.baseUrl:e.uri=e.baseUrl+"/"+e.uri,delete e.baseUrl}if(!e.uri)return e.emit("error",new Error("options.uri is a required argument"));if(typeof e.uri=="string"&&(e.uri=L.parse(e.uri)),e.uri.href||(e.uri.href=L.format(e.uri)),e.uri.protocol==="unix:")return e.emit("error",new Error("`unix://` URL scheme is no longer supported. Please use the format `http://unix:SOCKET:PATH`"));if(e.uri.host==="unix"&&e.enableUnixSocket(),e.strictSSL===!1&&(e.rejectUnauthorized=!1),e.uri.pathname||(e.uri.pathname="/"),!(e.uri.host||e.uri.hostname&&e.uri.port)&&!e.uri.isUnix){var o=L.format(e.uri),n='Invalid URI "'+o+'"';return Object.keys(r).length===0&&(n+=". This can be caused by a crappy redirection."),e.abort(),e.emit("error",new Error(n))}if(e.hasOwnProperty("proxy")||(e.proxy=et(e.uri)),e.tunnel=e._tunnel.isEnabled(),e.proxy&&e._tunnel.setup(r),e._redirect.onRequest(r),e.setHost=!1,!e.hasHeader("host")){var s=e.originalHostHeaderName||"host";e.setHeader(s,e.uri.host),e.uri.port&&(e.uri.port==="80"&&e.uri.protocol==="http:"||e.uri.port==="443"&&e.uri.protocol==="https:")&&e.setHeader(s,e.uri.hostname),e.setHost=!0}if(e.jar(e._jar||r.jar),e.uri.port||(e.uri.protocol==="http:"?e.uri.port=80:e.uri.protocol==="https:"&&(e.uri.port=443)),e.proxy&&!e.tunnel?(e.port=e.proxy.port,e.host=e.proxy.hostname):(e.port=e.uri.port,e.host=e.uri.hostname),r.form&&e.form(r.form),r.formData){var c=r.formData,v=e.form(),l=function(d,y){y&&y.hasOwnProperty("value")&&y.hasOwnProperty("options")?v.append(d,y.value,y.options):v.append(d,y)};for(var h in c)if(c.hasOwnProperty(h)){var g=c[h];if(g instanceof Array)for(var x=0;x<g.length;x++)l(h,g[x]);else l(h,g)}}if(r.qs&&e.qs(r.qs),e.uri.path?e.path=e.uri.path:e.path=e.uri.pathname+(e.uri.search||""),e.path.length===0&&(e.path="/"),r.aws&&e.aws(r.aws),r.hawk&&e.hawk(r.hawk),r.httpSignature&&e.httpSignature(r.httpSignature),r.auth&&(Object.prototype.hasOwnProperty.call(r.auth,"username")&&(r.auth.user=r.auth.username),Object.prototype.hasOwnProperty.call(r.auth,"password")&&(r.auth.pass=r.auth.password),e.auth(r.auth.user,r.auth.pass,r.auth.sendImmediately,r.auth.bearer)),e.gzip&&!e.hasHeader("accept-encoding")&&e.setHeader("accept-encoding","gzip, deflate"),e.uri.auth&&!e.hasHeader("authorization")){var O=e.uri.auth.split(":").map(function(d){return e._qs.unescape(d)});e.auth(O[0],O.slice(1).join(":"),!0)}if(!e.tunnel&&e.proxy&&e.proxy.auth&&!e.hasHeader("proxy-authorization")){var q=e.proxy.auth.split(":").map(function(d){return e._qs.unescape(d)}),M="Basic "+ft(q.join(":"));e.setHeader("proxy-authorization",M)}e.proxy&&!e.tunnel&&(e.path=e.uri.protocol+"//"+e.uri.host+e.path),r.json&&e.json(r.json),r.multipart&&e.multipart(r.multipart),r.time&&(e.timing=!0,e.elapsedTime=e.elapsedTime||0);function N(){if(Vr(e.body)&&(e.body=z.from(e.body)),!e.hasHeader("content-length")){var d;typeof e.body=="string"?d=z.byteLength(e.body):Array.isArray(e.body)?d=e.body.reduce(function(y,F){return y+F.length},0):d=e.body.length,d?e.setHeader("content-length",d):e.emit("error",new Error("Argument error, options.body."))}}e.body&&!Le(e.body)&&N(),r.oauth?e.oauth(r.oauth):e._oauth.params&&e.hasHeader("authorization")&&e.oauth(e._oauth.params);var T=e.proxy&&!e.tunnel?e.proxy.protocol:e.uri.protocol,$={"http:":Wr,"https:":Ue},V=e.httpModules||{};if(e.httpModule=V[T]||$[T],!e.httpModule)return e.emit("error",new Error("Invalid protocol: "+T));if(r.ca&&(e.ca=r.ca),!e.agent)if(r.agentOptions&&(e.agentOptions=r.agentOptions),r.agentClass)e.agentClass=r.agentClass;else if(r.forever){var B=lt();B.major===0&&B.minor<=10?e.agentClass=T==="http:"?De:De.SSL:(e.agentClass=e.httpModule.Agent,e.agentOptions=e.agentOptions||{},e.agentOptions.keepAlive=!0)}else e.agentClass=e.httpModule.Agent;e.pool===!1?e.agent=!1:e.agent=e.agent||e.getNewAgent(),e.on("pipe",function(d){if(e.ntick&&e._started&&e.emit("error",new Error("You cannot pipe to this stream after the outbound request has started.")),e.src=d,ut(d))e.hasHeader("content-type")||e.setHeader("content-type",Xr.lookup(d.path));else{if(d.headers)for(var y in d.headers)e.hasHeader(y)||e.setHeader(y,d.headers[y]);e._json&&!e.hasHeader("content-type")&&e.setHeader("content-type","application/json"),d.method&&!e.explicitMethod&&(e.method=d.method)}}),ct(function(){if(!e._aborted){var d=function(){if(e._form&&(e._auth.hasAuth?e._auth.hasAuth&&e._auth.sentAuth&&e._form.pipe(e):e._form.pipe(e)),e._multipart&&e._multipart.chunked&&e._multipart.body.pipe(e),e.body)Le(e.body)?e.body.pipe(e):(N(),Array.isArray(e.body)?e.body.forEach(function(y){e.write(y)}):e.write(e.body),e.end());else if(e.requestBodyStream)console.warn("options.requestBodyStream is deprecated, please pass the request object to stream.pipe."),e.requestBodyStream.pipe(e);else if(!e.src){if(e._auth.hasAuth&&!e._auth.sentAuth){e.end();return}e.method!=="GET"&&typeof e.method<"u"&&e.setHeader("content-length",0),e.end()}};e._form&&!e.hasHeader("content-length")?(e.setHeader(e._form.getHeaders(),!0),e._form.getLength(function(y,F){!y&&!isNaN(F)&&e.setHeader("content-length",F),d()})):d(),e.ntick=!0}})};f.prototype.getNewAgent=function(){var r=this,e=r.agentClass,t={};if(r.agentOptions)for(var i in r.agentOptions)t[i]=r.agentOptions[i];r.ca&&(t.ca=r.ca),r.ciphers&&(t.ciphers=r.ciphers),r.secureProtocol&&(t.secureProtocol=r.secureProtocol),r.secureOptions&&(t.secureOptions=r.secureOptions),typeof r.rejectUnauthorized<"u"&&(t.rejectUnauthorized=r.rejectUnauthorized),r.cert&&r.key&&(t.key=r.key,t.cert=r.cert),r.pfx&&(t.pfx=r.pfx),r.passphrase&&(t.passphrase=r.passphrase);var a="";e!==r.httpModule.Agent&&(a+=e.name);var o=r.proxy;typeof o=="string"&&(o=L.parse(o));var n=o&&o.protocol==="https:"||this.uri.protocol==="https:";return n&&(t.ca&&(a&&(a+=":"),a+=t.ca),typeof t.rejectUnauthorized<"u"&&(a&&(a+=":"),a+=t.rejectUnauthorized),t.cert&&(a&&(a+=":"),a+=t.cert.toString("ascii")+t.key.toString("ascii")),t.pfx&&(a&&(a+=":"),a+=t.pfx.toString("ascii")),t.ciphers&&(a&&(a+=":"),a+=t.ciphers),t.secureProtocol&&(a&&(a+=":"),a+=t.secureProtocol),t.secureOptions&&(a&&(a+=":"),a+=t.secureOptions)),r.pool===Fe&&!a&&Object.keys(t).length===0&&r.httpModule.globalAgent?r.httpModule.globalAgent:(a=r.uri.protocol+a,r.pool[a]||(r.pool[a]=new e(t),r.pool.maxSockets&&(r.pool[a].maxSockets=r.pool.maxSockets)),r.pool[a])};f.prototype.start=function(){var r=this;if(r.timing)var e=new Date().getTime(),t=j();if(!r._aborted){r._started=!0,r.method=r.method||"GET",r.href=r.uri.href,r.src&&r.src.stat&&r.src.stat.size&&!r.hasHeader("content-length")&&r.setHeader("content-length",r.src.stat.size),r._aws&&r.aws(r._aws,!0);var i=Ne(r);delete i.auth,m("make request",r.uri.href),delete i.timeout;try{r.req=r.httpModule.request(i)}catch(o){r.emit("error",o);return}r.timing&&(r.startTime=e,r.startTimeNow=t,r.timings={});var a;r.timeout&&!r.timeoutTimer&&(r.timeout<0?a=0:typeof r.timeout=="number"&&isFinite(r.timeout)&&(a=r.timeout)),r.req.on("response",r.onRequestResponse.bind(r)),r.req.on("error",r.onRequestError.bind(r)),r.req.on("drain",function(){r.emit("drain")}),r.req.on("socket",function(o){var n=o._connecting||o.connecting;if(r.timing&&(r.timings.socket=j()-r.startTimeNow,n)){var s=function(){r.timings.lookup=j()-r.startTimeNow},c=function(){r.timings.connect=j()-r.startTimeNow};o.once("lookup",s),o.once("connect",c),r.req.once("error",function(){o.removeListener("lookup",s),o.removeListener("connect",c)})}var v=function(){r.req.setTimeout(a,function(){if(r.req){r.abort();var h=new Error("ESOCKETTIMEDOUT");h.code="ESOCKETTIMEDOUT",h.connect=!1,r.emit("error",h)}})};if(a!==void 0)if(n){var l=function(){o.removeListener("connect",l),r.clearTimeout(),v()};o.on("connect",l),r.req.on("error",function(h){o.removeListener("connect",l)}),r.timeoutTimer=setTimeout(function(){o.removeListener("connect",l),r.abort();var h=new Error("ETIMEDOUT");h.code="ETIMEDOUT",h.connect=!0,r.emit("error",h)},a)}else v();r.emit("socket",o)}),r.emit("request",r.req)}};f.prototype.onRequestError=function(r){var e=this;if(!e._aborted){if(e.req&&e.req._reusedSocket&&r.code==="ECONNRESET"&&e.agent.addRequestNoreuse){e.agent={addRequest:e.agent.addRequestNoreuse.bind(e.agent)},e.start(),e.req.end();return}e.clearTimeout(),e.emit("error",r)}};f.prototype.onRequestResponse=function(r){var e=this;if(e.timing&&(e.timings.response=j()-e.startTimeNow),m("onRequestResponse",e.uri.href,r.statusCode,r.headers),r.on("end",function(){e.timing&&(e.timings.end=j()-e.startTimeNow,r.timingStart=e.startTime,e.timings.socket||(e.timings.socket=0),e.timings.lookup||(e.timings.lookup=e.timings.socket),e.timings.connect||(e.timings.connect=e.timings.lookup),e.timings.response||(e.timings.response=e.timings.connect),m("elapsed time",e.timings.end),e.elapsedTime+=Math.round(e.timings.end),r.elapsedTime=e.elapsedTime,r.timings=e.timings,r.timingPhases={wait:e.timings.socket,dns:e.timings.lookup-e.timings.socket,tcp:e.timings.connect-e.timings.lookup,firstByte:e.timings.response-e.timings.connect,download:e.timings.end-e.timings.response,total:e.timings.end}),m("response end",e.uri.href,r.statusCode,r.headers)}),e._aborted){m("aborted",e.uri.href),r.resume();return}if(e.response=r,r.request=e,r.toJSON=pt,e.httpModule===Ue&&e.strictSSL&&(!r.hasOwnProperty("socket")||!r.socket.authorized)){m("strict ssl error",e.uri.href);var t=r.hasOwnProperty("socket")?r.socket.authorizationError:e.uri.href+" does not support SSL";e.emit("error",new Error("SSL Error: "+t));return}e.originalHost=e.getHeader("host"),e.originalHostHeaderName||(e.originalHostHeaderName=e.hasHeader("host")),e.setHost&&e.removeHeader("host"),e.clearTimeout();var i=e._jar&&e._jar.setCookie?e._jar:Be,a=function(l){try{i.setCookie(l,e.uri.href,{ignoreError:!0})}catch(h){e.emit("error",h)}};if(r.caseless=Me(r.headers),r.caseless.has("set-cookie")&&!e._disableCookies){var o=r.caseless.has("set-cookie");Array.isArray(r.headers[o])?r.headers[o].forEach(a):a(r.headers[o])}if(!e._redirect.onResponse(r)){{r.on("close",function(){e._ended||e.response.emit("end")}),r.once("end",function(){e._ended=!0});var n=function(l){return e.method==="HEAD"||l>=100&&l<200||l===204||l===304},s;if(e.gzip&&!n(r.statusCode)){var c=r.headers["content-encoding"]||"identity";c=c.trim().toLowerCase();var v={flush:G.Z_SYNC_FLUSH,finishFlush:G.Z_SYNC_FLUSH};c==="gzip"?(s=G.createGunzip(v),r.pipe(s)):c==="deflate"?(s=G.createInflate(v),r.pipe(s)):(c!=="identity"&&m("ignoring unrecognized Content-Encoding "+c),s=r)}else s=r;e.encoding&&(e.dests.length!==0?console.error("Ignoring encoding parameter as this stream is being piped to another stream which makes the encoding option invalid."):s.setEncoding(e.encoding)),e._paused&&s.pause(),e.responseContent=s,e.emit("response",r),e.dests.forEach(function(l){e.pipeDest(l)}),s.on("data",function(l){e.timing&&!e.responseStarted&&(e.responseStartTime=new Date().getTime(),r.responseStartTime=e.responseStartTime),e._destdata=!0,e.emit("data",l)}),s.once("end",function(l){e.emit("end",l)}),s.on("error",function(l){e.emit("error",l)}),s.on("close",function(){e.emit("close")}),e.callback?e.readResponseBody(r):e.on("end",function(){if(e._aborted){m("aborted",e.uri.href);return}e.emit("complete",r)})}m("finish init function",e.uri.href)}};f.prototype.readResponseBody=function(r){var e=this;m("reading response's body");var t=[],i=0,a=[];e.on("data",function(o){z.isBuffer(o)?o.length&&(i+=o.length,t.push(o)):a.push(o)}),e.on("end",function(){if(m("end event",e.uri.href),e._aborted){m("aborted",e.uri.href),t=[],i=0;return}if(i?(m("has body",e.uri.href,i),r.body=z.concat(t,i),e.encoding!==null&&(r.body=r.body.toString(e.encoding)),t=[],i=0):a.length&&(e.encoding==="utf8"&&a[0].length>0&&a[0][0]==="\uFEFF"&&(a[0]=a[0].substring(1)),r.body=a.join("")),e._json)try{r.body=JSON.parse(r.body,e._jsonReviver)}catch{m("invalid JSON received",e.uri.href)}m("emitting complete",e.uri.href),typeof r.body>"u"&&!e._json&&(r.body=e.encoding===null?z.alloc(0):""),e.emit("complete",r,r.body)})};f.prototype.abort=function(){var r=this;r._aborted=!0,r.req?r.req.abort():r.response&&r.response.destroy(),r.clearTimeout(),r.emit("abort")};f.prototype.pipeDest=function(r){var e=this,t=e.response;if(r.headers&&!r.headersSent){if(t.caseless.has("content-type")){var i=t.caseless.has("content-type");r.setHeader?r.setHeader(i,t.headers[i]):r.headers[i]=t.headers[i]}if(t.caseless.has("content-length")){var a=t.caseless.has("content-length");r.setHeader?r.setHeader(a,t.headers[a]):r.headers[a]=t.headers[a]}}if(r.setHeader&&!r.headersSent){for(var o in t.headers)(!e.gzip||o!=="content-encoding")&&r.setHeader(o,t.headers[o]);r.statusCode=t.statusCode}e.pipefilter&&e.pipefilter(t,r)};f.prototype.qs=function(r,e){var t=this,i;!e&&t.uri.query?i=t._qs.parse(t.uri.query):i={};for(var a in r)i[a]=r[a];var o=t._qs.stringify(i);return o===""||(t.uri=L.parse(t.uri.href.split("?")[0]+"?"+o),t.url=t.uri,t.path=t.uri.path,t.uri.host==="unix"&&t.enableUnixSocket()),t};f.prototype.form=function(r){var e=this;return r?(/^application\/x-www-form-urlencoded\b/.test(e.getHeader("content-type"))||e.setHeader("content-type","application/x-www-form-urlencoded"),e.body=typeof r=="string"?e._qs.rfc3986(r.toString("utf8")):e._qs.stringify(r).toString("utf8"),e):(e._form=new Kr,e._form.on("error",function(t){t.message="form-data: "+t.message,e.emit("error",t),e.abort()}),e._form)};f.prototype.multipart=function(r){var e=this;return e._multipart.onRequest(r),e._multipart.chunked||(e.body=e._multipart.body),e};f.prototype.json=function(r){var e=this;return e.hasHeader("accept")||e.setHeader("accept","application/json"),typeof e.jsonReplacer=="function"&&(e._jsonReplacer=e.jsonReplacer),e._json=!0,typeof r=="boolean"?e.body!==void 0&&(/^application\/x-www-form-urlencoded\b/.test(e.getHeader("content-type"))?e.body=e._qs.rfc3986(e.body):e.body=ze(e.body,e._jsonReplacer),e.hasHeader("content-type")||e.setHeader("content-type","application/json")):(e.body=ze(r,e._jsonReplacer),e.hasHeader("content-type")||e.setHeader("content-type","application/json")),typeof e.jsonReviver=="function"&&(e._jsonReviver=e.jsonReviver),e};f.prototype.getHeader=function(r,e){var t=this,i,a,o;return e||(e=t.headers),Object.keys(e).forEach(function(n){n.length===r.length&&(a=new RegExp(r,"i"),o=n.match(a),o&&(i=e[n]))}),i};f.prototype.enableUnixSocket=function(){var r=this.uri.path.split(":"),e=r[0],t=r[1];this.socketPath=e,this.uri.pathname=t,this.uri.path=t,this.uri.host=e,this.uri.hostname=e,this.uri.isUnix=!0};f.prototype.auth=function(r,e,t,i){var a=this;return a._auth.onRequest(r,e,t,i),a};f.prototype.aws=function(r,e){var t=this;if(!e)return t._aws=r,t;if(r.sign_version===4||r.sign_version==="4"){var i={host:t.uri.host,path:t.uri.path,method:t.method,headers:t.headers,body:t.body};r.service&&(i.service=r.service);var a=Yr.sign(i,{accessKeyId:r.key,secretAccessKey:r.secret,sessionToken:r.session});t.setHeader("authorization",a.headers.Authorization),t.setHeader("x-amz-date",a.headers["X-Amz-Date"]),a.headers["X-Amz-Security-Token"]&&t.setHeader("x-amz-security-token",a.headers["X-Amz-Security-Token"])}else{var o=new Date;t.setHeader("date",o.toUTCString());var n={key:r.key,secret:r.secret,verb:t.method.toUpperCase(),date:o,contentType:t.getHeader("content-type")||"",md5:t.getHeader("content-md5")||"",amazonHeaders:ae.canonicalizeHeaders(t.headers)},s=t.uri.path;r.bucket&&s?n.resource="/"+r.bucket+s:r.bucket&&!s?n.resource="/"+r.bucket:!r.bucket&&s?n.resource=s:!r.bucket&&!s&&(n.resource="/"),n.resource=ae.canonicalizeResource(n.resource),t.setHeader("authorization",ae.authorization(n))}return t};f.prototype.httpSignature=function(r){var e=this;return Gr.signRequest({getHeader:function(t){return e.getHeader(t,e.headers)},setHeader:function(t,i){e.setHeader(t,i)},method:e.method,path:e.path},r),m("httpSignature authorization",e.getHeader("authorization")),e};f.prototype.hawk=function(r){var e=this;e.setHeader("Authorization",ot.header(e.uri,e.method,r))};f.prototype.oauth=function(r){var e=this;return e._oauth.onRequest(r),e};f.prototype.jar=function(r){var e=this,t;if(e._redirect.redirectsFollowed===0&&(e.originalCookieHeader=e.getHeader("cookie")),!r)t=!1,e._disableCookies=!0;else{var i=r.getCookieString?r:Be,a=e.uri.href;i&&(t=i.getCookieString(a))}return t&&t.length&&(e.originalCookieHeader?e.setHeader("cookie",e.originalCookieHeader+"; "+t):e.setHeader("cookie",t)),e._jar=r,e};f.prototype.pipe=function(r,e){var t=this;if(t.response)if(t._destdata)t.emit("error",new Error("You cannot pipe after data has been emitted from the response."));else if(t._ended)t.emit("error",new Error("You cannot pipe after the response has been ended."));else return X.Stream.prototype.pipe.call(t,r,e),t.pipeDest(r),r;else return t.dests.push(r),X.Stream.prototype.pipe.call(t,r,e),r};f.prototype.write=function(){var r=this;if(!r._aborted&&(r._started||r.start(),r.req))return r.req.write.apply(r.req,arguments)};f.prototype.end=function(r){var e=this;e._aborted||(r&&e.write(r),e._started||e.start(),e.req&&e.req.end())};f.prototype.pause=function(){var r=this;r.responseContent?r.responseContent.pause.apply(r.responseContent,arguments):r._paused=!0};f.prototype.resume=function(){var r=this;r.responseContent?r.responseContent.resume.apply(r.responseContent,arguments):r._paused=!1};f.prototype.destroy=function(){var r=this;this.clearTimeout(),r._ended?r.response&&r.response.destroy():r.end()};f.prototype.clearTimeout=function(){this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)};f.defaultProxyHeaderWhiteList=ne.defaultProxyHeaderWhiteList.slice();f.defaultProxyHeaderExclusiveList=ne.defaultProxyHeaderExclusiveList.slice();f.prototype.toJSON=Ie;Je.exports=f});var ue=b((Qt,Ye)=>{"use strict";var U=u("extend"),We=te(),mt=J(),vt=mt.paramsHaveRequestBody;function K(r,e,t){typeof e=="function"&&(t=e);var i={};return e!==null&&typeof e=="object"?U(i,e,{uri:r}):typeof r=="string"?U(i,{uri:r}):U(i,r),i.callback=t||i.callback,i}function p(r,e,t){if(typeof r>"u")throw new Error("undefined is not a valid uri or options object.");var i=K(r,e,t);if(i.method==="HEAD"&&vt(i))throw new Error("HTTP HEAD requests MUST NOT include a request body.");return new p.Request(i)}function H(r){var e=r.toUpperCase();return function(t,i,a){var o=K(t,i,a);return o.method=e,p(o,o.callback)}}p.get=H("get");p.head=H("head");p.options=H("options");p.post=H("post");p.put=H("put");p.patch=H("patch");p.del=H("delete");p.delete=H("delete");p.jar=function(r){return We.jar(r)};p.cookie=function(r){return We.parse(r)};function se(r,e,t,i){return function(a,o,n){var s=K(a,o,n),c={};return U(!0,c,e,s),c.pool=s.pool||e.pool,i&&(c.method=i.toUpperCase()),typeof t=="function"&&(r=t),r(c,c.callback)}}p.defaults=function(r,e){var t=this;r=r||{},typeof r=="function"&&(e=r,r={});var i=se(t,r,e),a=["get","head","post","put","patch","del","delete"];return a.forEach(function(o){i[o]=se(t[o],r,e,o)}),i.cookie=se(t.cookie,r,e),i.jar=t.jar,i.defaults=t.defaults,i};p.forever=function(r,e){var t={};return e&&U(t,e),r&&(t.agentOptions=r),t.forever=!0,p.defaults(t)};Ye.exports=p;p.Request=Qe();p.initParams=K;Object.defineProperty(p,"debug",{enumerable:!0,get:function(){return p.Request.debug},set:function(r){p.Request.debug=r}})});var w={};rr(w,{Request:()=>Rt,cookie:()=>Ot,default:()=>Et,defaults:()=>kt,del:()=>wt,forever:()=>Tt,get:()=>yt,head:()=>gt,initParams:()=>St,jar:()=>xt,options:()=>bt,patch:()=>Ht,post:()=>qt,put:()=>_t});var Xe=fe(ue());k(w,fe(ue()));var{get:yt,head:gt,options:bt,post:qt,put:_t,patch:Ht,del:wt,jar:xt,cookie:Ot,defaults:kt,forever:Tt,Request:Rt,initParams:St}=Xe,{default:Ge,...jt}=Xe,Et=Ge!==void 0?Ge:jt;export{Rt as Request,Ot as cookie,Et as default,kt as defaults,wt as del,Tt as forever,yt as get,gt as head,St as initParams,xt as jar,bt as options,Ht as patch,qt as post,_t as put};
console.warn("[npm] %cdeprecated%c request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142", "color:red", "");
//# sourceMappingURL=request.mjs.map