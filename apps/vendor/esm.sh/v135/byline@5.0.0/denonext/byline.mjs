/* esm.sh - esbuild bundle(byline@5.0.0) denonext production */
import { Buffer as __Buffer$ } from "node:buffer";
import * as __0$ from "node:stream";
import * as __1$ from "node:util";
import * as __2$ from "node:timers";
var require=n=>{const e=m=>typeof m.default<"u"?m.default:m,c=m=>Object.assign({},m);switch(n){case"stream":return e(__0$);case"util":return e(__1$);case"timers":return e(__2$);default:throw new Error("module \""+n+"\" not found");}};
var S=Object.create;var h=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var w=Object.getPrototypeOf,x=Object.prototype.hasOwnProperty;var l=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var L=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),v=(e,t)=>{for(var r in t)h(e,r,{get:t[r],enumerable:!0})},o=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of g(t))!x.call(e,s)&&s!==r&&h(e,s,{get:()=>t[s],enumerable:!(i=b(t,s))||i.enumerable});return e},u=(e,t,r)=>(o(e,t,"default"),r&&o(r,t,"default")),m=(e,t,r)=>(r=e!=null?S(w(e)):{},o(t||!e||!e.__esModule?h(r,"default",{value:e,enumerable:!0}):r,e));var p=L((T,a)=>{var _=l("stream"),y=l("util"),E=l("timers");a.exports=function(e,t){return a.exports.createStream(e,t)};a.exports.createStream=function(e,t){return e?d(e,t):new f(t)};a.exports.createLineStream=function(e){return console.log("WARNING: byline#createLineStream is deprecated and will be removed soon"),d(e)};function d(e,t){if(!e)throw new Error("expected readStream");if(!e.readable)throw new Error("readStream must be readable");var r=new f(t);return e.pipe(r),r}a.exports.LineStream=f;function f(e){_.Transform.call(this,e),e=e||{},this._readableState.objectMode=!0,this._lineBuffer=[],this._keepEmptyLines=e.keepEmptyLines||!1,this._lastChunkEndedWithCR=!1;var t=this;this.on("pipe",function(r){t.encoding||r instanceof _.Readable&&(t.encoding=r._readableState.encoding)})}y.inherits(f,_.Transform);f.prototype._transform=function(e,t,r){t=t||"utf8",__Buffer$.isBuffer(e)&&(t=="buffer"?(e=e.toString(),t="utf8"):e=e.toString(t)),this._chunkEncoding=t;var i=e.split(/\r\n|[\n\v\f\r\x85\u2028\u2029]/g);this._lastChunkEndedWithCR&&e[0]==`
`&&i.shift(),this._lineBuffer.length>0&&(this._lineBuffer[this._lineBuffer.length-1]+=i[0],i.shift()),this._lastChunkEndedWithCR=e[e.length-1]=="\r",this._lineBuffer=this._lineBuffer.concat(i),this._pushBuffer(t,1,r)};f.prototype._pushBuffer=function(e,t,r){for(;this._lineBuffer.length>t;){var i=this._lineBuffer.shift();if((this._keepEmptyLines||i.length>0)&&!this.push(this._reencode(i,e))){var s=this;E.setImmediate(function(){s._pushBuffer(e,t,r)});return}}r()};f.prototype._flush=function(e){this._pushBuffer(this._chunkEncoding,0,e)};f.prototype._reencode=function(e,t){return this.encoding&&this.encoding!=t?new __Buffer$(e,t).toString(this.encoding):this.encoding?e:new __Buffer$(e,t)}});var n={};v(n,{LineStream:()=>W,createLineStream:()=>R,createStream:()=>C,default:()=>I});var B=m(p());u(n,m(p()));var{createStream:C,createLineStream:R,LineStream:W}=B,{default:c,...q}=B,I=c!==void 0?c:q;export{W as LineStream,R as createLineStream,C as createStream,I as default};
//# sourceMappingURL=byline.mjs.map