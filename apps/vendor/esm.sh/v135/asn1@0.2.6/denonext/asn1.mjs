/* esm.sh - esbuild bundle(asn1@0.2.6) denonext production */
import * as __0$ from "node:assert";
import * as __1$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
import * as __2$ from "node:assert";
import * as __3$ from "/v135/safer-buffer@2.1.2/denonext/safer-buffer.mjs";
var require=n=>{const e=m=>typeof m.default<"u"?m.default:m,c=m=>Object.assign({},m);switch(n){case"assert":return e(__0$);case"safer-buffer":return e(__1$);default:throw new Error("module \""+n+"\" not found");}};
var G=Object.create;var q=Object.defineProperty;var V=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var $=Object.getPrototypeOf,H=Object.prototype.hasOwnProperty;var c=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var g=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),J=(e,t)=>{for(var r in t)q(e,r,{get:t[r],enumerable:!0})},E=(e,t,r,f)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of M(t))!H.call(e,i)&&i!==r&&q(e,i,{get:()=>t[i],enumerable:!(f=V(t,i))||f.enumerable});return e},l=(e,t,r)=>(E(e,t,"default"),r&&E(r,t,"default")),P=(e,t,r)=>(r=e!=null?G($(e)):{},E(t||!e||!e.__esModule?q(r,"default",{value:e,enumerable:!0}):r,e));var w=g((ue,A)=>{A.exports={newInvalidAsn1Error:function(e){var t=new Error;return t.name="InvalidAsn1Error",t.message=e||"",t}}});var y=g((he,j)=>{j.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}});var L=g((pe,D)=>{var K=c("assert"),z=c("safer-buffer").Buffer,b=y(),Q=w(),x=Q.newInvalidAsn1Error;function u(e){if(!e||!z.isBuffer(e))throw new TypeError("data must be a node Buffer");this._buf=e,this._size=e.length,this._len=0,this._offset=0}Object.defineProperty(u.prototype,"length",{enumerable:!0,get:function(){return this._len}});Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){return this._offset}});Object.defineProperty(u.prototype,"remain",{get:function(){return this._size-this._offset}});Object.defineProperty(u.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}});u.prototype.readByte=function(e){if(this._size-this._offset<1)return null;var t=this._buf[this._offset]&255;return e||(this._offset+=1),t};u.prototype.peek=function(){return this.readByte(!0)};u.prototype.readLength=function(e){if(e===void 0&&(e=this._offset),e>=this._size)return null;var t=this._buf[e++]&255;if(t===null)return null;if((t&128)===128){if(t&=127,t===0)throw x("Indefinite length not supported");if(t>4)throw x("encoding too long");if(this._size-e<t)return null;this._len=0;for(var r=0;r<t;r++)this._len=(this._len<<8)+(this._buf[e++]&255)}else this._len=t;return e};u.prototype.readSequence=function(e){var t=this.peek();if(t===null)return null;if(e!==void 0&&e!==t)throw x("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);return r===null?null:(this._offset=r,t)};u.prototype.readInt=function(){return this._readTag(b.Integer)};u.prototype.readBoolean=function(){return this._readTag(b.Boolean)!==0};u.prototype.readEnumeration=function(){return this._readTag(b.Enumeration)};u.prototype.readString=function(e,t){e||(e=b.OctetString);var r=this.peek();if(r===null)return null;if(r!==e)throw x("Expected 0x"+e.toString(16)+": got 0x"+r.toString(16));var f=this.readLength(this._offset+1);if(f===null||this.length>this._size-f)return null;if(this._offset=f,this.length===0)return t?z.alloc(0):"";var i=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,t?i:i.toString("utf8")};u.prototype.readOID=function(e){e||(e=b.OID);var t=this.readString(e,!0);if(t===null)return null;for(var r=[],f=0,i=0;i<t.length;i++){var h=t[i]&255;f<<=7,f+=h&127,h&128||(r.push(f),f=0)}return f=r.shift(),r.unshift(f%40),r.unshift(f/40>>0),r.join(".")};u.prototype._readTag=function(e){K.ok(e!==void 0);var t=this.peek();if(t===null)return null;if(t!==e)throw x("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);if(r===null)return null;if(this.length>4)throw x("Integer too long: "+this.length);if(this.length>this._size-r)return null;this._offset=r;for(var f=this._buf[this._offset],i=0,h=0;h<this.length;h++)i<<=8,i|=this._buf[this._offset++]&255;return(f&128)===128&&h!==4&&(i-=1<<h*8),i>>0};D.exports=u});var k=g((ae,N)=>{var p=c("assert"),d=c("safer-buffer").Buffer,a=y(),X=w(),v=X.newInvalidAsn1Error,Y={size:1024,growthFactor:8};function Z(e,t){p.ok(e),p.equal(typeof e,"object"),p.ok(t),p.equal(typeof t,"object");var r=Object.getOwnPropertyNames(e);return r.forEach(function(f){if(!t[f]){var i=Object.getOwnPropertyDescriptor(e,f);Object.defineProperty(t,f,i)}}),t}function o(e){e=Z(Y,e||{}),this._buf=d.alloc(e.size||1024),this._size=this._buf.length,this._offset=0,this._options=e,this._seq=[]}Object.defineProperty(o.prototype,"buffer",{get:function(){if(this._seq.length)throw v(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}});o.prototype.writeByte=function(e){if(typeof e!="number")throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=e};o.prototype.writeInt=function(e,t){if(typeof e!="number")throw new TypeError("argument must be a Number");typeof t!="number"&&(t=a.Integer);for(var r=4;(!(e&4286578688)||(e&4286578688)===-8388608)&&r>1;)r--,e<<=8;if(r>4)throw v("BER ints cannot be > 0xffffffff");for(this._ensure(2+r),this._buf[this._offset++]=t,this._buf[this._offset++]=r;r-- >0;)this._buf[this._offset++]=(e&4278190080)>>>24,e<<=8};o.prototype.writeNull=function(){this.writeByte(a.Null),this.writeByte(0)};o.prototype.writeEnumeration=function(e,t){if(typeof e!="number")throw new TypeError("argument must be a Number");return typeof t!="number"&&(t=a.Enumeration),this.writeInt(e,t)};o.prototype.writeBoolean=function(e,t){if(typeof e!="boolean")throw new TypeError("argument must be a Boolean");typeof t!="number"&&(t=a.Boolean),this._ensure(3),this._buf[this._offset++]=t,this._buf[this._offset++]=1,this._buf[this._offset++]=e?255:0};o.prototype.writeString=function(e,t){if(typeof e!="string")throw new TypeError("argument must be a string (was: "+typeof e+")");typeof t!="number"&&(t=a.OctetString);var r=d.byteLength(e);this.writeByte(t),this.writeLength(r),r&&(this._ensure(r),this._buf.write(e,this._offset),this._offset+=r)};o.prototype.writeBuffer=function(e,t){if(typeof t!="number")throw new TypeError("tag must be a number");if(!d.isBuffer(e))throw new TypeError("argument must be a buffer");this.writeByte(t),this.writeLength(e.length),this._ensure(e.length),e.copy(this._buf,this._offset,0,e.length),this._offset+=e.length};o.prototype.writeStringArray=function(e){if(!e instanceof Array)throw new TypeError("argument must be an Array[String]");var t=this;e.forEach(function(r){t.writeString(r)})};o.prototype.writeOID=function(e,t){if(typeof e!="string")throw new TypeError("argument must be a string");if(typeof t!="number"&&(t=a.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(e))throw new Error("argument is not a valid OID string");function r(n,s){s<128?n.push(s):s<16384?(n.push(s>>>7|128),n.push(s&127)):s<2097152?(n.push(s>>>14|128),n.push((s>>>7|128)&255),n.push(s&127)):s<268435456?(n.push(s>>>21|128),n.push((s>>>14|128)&255),n.push((s>>>7|128)&255),n.push(s&127)):(n.push((s>>>28|128)&255),n.push((s>>>21|128)&255),n.push((s>>>14|128)&255),n.push((s>>>7|128)&255),n.push(s&127))}var f=e.split("."),i=[];i.push(parseInt(f[0],10)*40+parseInt(f[1],10)),f.slice(2).forEach(function(n){r(i,parseInt(n,10))});var h=this;this._ensure(2+i.length),this.writeByte(t),this.writeLength(i.length),i.forEach(function(n){h.writeByte(n)})};o.prototype.writeLength=function(e){if(typeof e!="number")throw new TypeError("argument must be a Number");if(this._ensure(4),e<=127)this._buf[this._offset++]=e;else if(e<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=e;else if(e<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e;else if(e<=16777215)this._buf[this._offset++]=131,this._buf[this._offset++]=e>>16,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e;else throw v("Length too long (> 4 bytes)")};o.prototype.startSequence=function(e){typeof e!="number"&&(e=a.Sequence|a.Constructor),this.writeByte(e),this._seq.push(this._offset),this._ensure(3),this._offset+=3};o.prototype.endSequence=function(){var e=this._seq.pop(),t=e+3,r=this._offset-t;if(r<=127)this._shift(t,r,-2),this._buf[e]=r;else if(r<=255)this._shift(t,r,-1),this._buf[e]=129,this._buf[e+1]=r;else if(r<=65535)this._buf[e]=130,this._buf[e+1]=r>>8,this._buf[e+2]=r;else if(r<=16777215)this._shift(t,r,1),this._buf[e]=131,this._buf[e+1]=r>>16,this._buf[e+2]=r>>8,this._buf[e+3]=r;else throw v("Sequence too long")};o.prototype._shift=function(e,t,r){p.ok(e!==void 0),p.ok(t!==void 0),p.ok(r),this._buf.copy(this._buf,e+r,e,e+t),this._offset+=r};o.prototype._ensure=function(e){if(p.ok(e),this._size-this._offset<e){var t=this._size*this._options.growthFactor;t-this._offset<e&&(t+=e);var r=d.alloc(t);this._buf.copy(r,0,0,this._offset),this._buf=r,this._size=t}};N.exports=o});var R=g((_e,B)=>{var O=w(),I=y(),ee=L(),te=k();B.exports={Reader:ee,Writer:te};for(m in I)I.hasOwnProperty(m)&&(B.exports[m]=I[m]);var m;for(S in O)O.hasOwnProperty(S)&&(B.exports[S]=O[S]);var S});var T=g((le,C)=>{var F=R();C.exports={Ber:F,BerReader:F.Reader,BerWriter:F.Writer}});var _={};J(_,{Ber:()=>re,BerReader:()=>ie,BerWriter:()=>fe,default:()=>se});var U=P(T());l(_,P(T()));var{Ber:re,BerReader:ie,BerWriter:fe}=U,{default:W,...ne}=U,se=W!==void 0?W:ne;export{re as Ber,ie as BerReader,fe as BerWriter,se as default};
//# sourceMappingURL=asn1.mjs.map